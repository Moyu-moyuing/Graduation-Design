{"remainingRequest":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\wuhanligong-java\\music\\vue-admin-template-master\\src\\views\\Editor\\Footer\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\src\\views\\Editor\\Footer\\index.vue","mtime":1652608804506},{"path":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JwpleHBvcnQgZGVmYXVsdCB7CgogIC8qYnVnOgogICog5Zy65pmv5qCR5Zyo5q+P5qyh54K55Ye757yW6L6R5ZCO5Lya5pS55Y+YIOKImgogICog6Lez6L2s6Lev55Sx6Zeu6aKYIOKImgogICog5paw5aKe5oyJ6ZKuIOKImgogICog5Zu+54mH5byC5bi46Zeu6aKYIOKImgogICog5pKt5pS+5Zmo5qC35byPCiAgKiDmjInpkq7moLflvI8KICAqIOaPkOS6pOaKveWxieS8mOWMliDiiJoKICAqIOWKoOi9veWKqOeUuwogICog5YWz6Zet5ryU56S65pe26Z+z5LmQ5YWz6ZetCiAgKiDnmbvlvZUqLwogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBkcmF3ZXI6ZmFsc2UsCiAgICAgICAgICAgIGZpbGVMaXN0OltdLAogICAgICAgICAgbG9hZGluZzpmYWxzZSwKICAgICAgICAgIGlkOm51bGwsCiAgICAgICAgIGZpbGU6bnVsbCwKICAgICAgICAgICAgZm9ybTp7CiAgICAgICAgICAgICAgbmFtZTonJywKICAgICAgICAgICAgICBkYXRlMTonJywKICAgICAgICAgICAgICBkYXRlMjonJywKICAgICAgICAgICAgICBpbWc6JycsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB1c2VyaWQ6bnVsbCwKICAgICAgICAgIHVzZXJuYW1lOm51bGwsCiAgICAgICAgICBpbWdpZDonJwoKICAgICAgICB9CiAgICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBHZXR0ZXJzKFsKICAgICAgJ25hbWUnCiAgICBdKQogIH0sCiAgICBtZXRob2RzOiB7CiAgICAgIFNhdmUoKXsKICAgICAgICB0aGlzLmRyYXdlciA9IHRydWU7CiAgICAgICAgaWYodGhpcy5pZCE9bnVsbCl7CiAgICAgICAgICB0aGlzLnJlcXVlc3QuZ2V0KCJodHRwOi8vbG9jYWxob3N0OjkwOTAvc2NlbmVmaWxlL2dldGJ5aWQiLHsKICAgICAgICAgICAgcGFyYW1zOnsKICAgICAgICAgICAgICBpZDp0aGlzLmlkCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLnRoZW4ocmVzPT57CgogICAgICAgICAgICB0aGlzLmZvcm0ubmFtZT1yZXMuZmlsZS5maWxlbmFtZTsKICAgICAgICAgICAgdGhpcy51c2VyaWQ9cmVzLmZpbGUudXNlcmlkOwogICAgICAgICAgICB0aGlzLnVzZXJuYW1lPXJlcy5maWxlLnVzZXJuYW1lOwogICAgICAgICAgfSkKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG9uU3VibWl0KCl7CiAgICAgICAgdGhpcy4kYnVzLiRlbWl0KCdyZXF1ZXN0c2F2ZScpOwogICAgICAgIHRoaXMuJGJ1cy4kb24oJ3Jlc3BvbnNlc2F2ZScsKGlkKT0+ewoKICAgICAgICAgICAgbGV0IHNjZW5lZmlsZT17CiAgICAgICAgICAgICAgaWQ6dGhpcy5pZCwKICAgICAgICAgICAgICB1c2VyaWQ6dGhpcy51c2VyaWQsCiAgICAgICAgICAgICAgdXNlcm5hbWU6dGhpcy5uYW1lLAogICAgICAgICAgICAgIGZpbGVuYW1lOnRoaXMuZm9ybS5uYW1lLAogICAgICAgICAgICAgIGZpbGU6IGlkLAogICAgICAgICAgICAgIGZpbGVpbWc6IHRoaXMuaW1naWQsCgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuaW1naWQpOwogICAgICAgICAgICB0aGlzLnJlcXVlc3QucG9zdCgiaHR0cDovL2xvY2FsaG9zdDo5MDkwL3NjZW5lZmlsZSIsc2NlbmVmaWxlKQogICAgICAgICAgLnRoZW4ocmVzPT57CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlcyk7CiAgICAgICAgICAgIHRoaXMubG9hZGluZz10cnVlOwogICAgICAgICAgICB0aGlzLmRyYXdlcj1mYWxzZTsKICAgICAgICAgICAgdGhpcy5mb3JtPXsKCiAgICAgICAgICAgICAgbmFtZTonJywKICAgICAgICAgICAgICBkYXRlMTonJywKICAgICAgICAgICAgICBkYXRlMjonJywKICAgICAgICAgICAgICBpbWc6JycKCiAgICAgICAgICAgIH07CgoKICAgICAgICAgIH0pCiAgICAgICAgfSkKICAgICAgfSwKICAgICAgLy8gTG9hZCgpewogICAgICAvLyAvL2NvbnNvbGUubG9nKHRoaXMuZmlsZSk7CiAgICAgIC8vIGxldCBwYXJhbT1uZXcgRm9ybURhdGEoKTsKICAgICAgLy8gcGFyYW0uYXBwZW5kKCdmaWxlJyx0aGlzLmZpbGUpOwogICAgICAvLyBsZXQgY29uZmlnPXtoZWFkZXJzOnsnQ29udGVudC1UeXBlJzonbXVsdGlwYXJ0L2Zvcm0tZGF0YSd9fQogICAgICAvLyAgIHRoaXMucmVxdWVzdC5wb3N0KCJodHRwOi8vbG9jYWxob3N0OjkwOTAvdXBsb2FkIiwKICAgICAgLy8gICAgcGFyYW0sY29uZmlnKS50aGVuKHJlcz0+ewogICAgICAvLyAgICAgLy9jb25zb2xlLmxvZyhyZXMpOwogICAgICAvLyAgICAgdGhpcy5pZD1yZXMuZmlsZWlkOwogICAgICAvLyAgIH0pCiAgICAgIC8vCiAgICAgIC8vIH0sCiAgICAgIC8vIFVwbG9hZChlKXsKICAgICAgLy8gICB0aGlzLmZpbGU9ZS50YXJnZXQuZmlsZXNbMF07CiAgICAgIC8vIH0sCiAgICAgICAgRXhwb3J0KCl7CiAgICAgICAgICAgIHRoaXMuJGJ1cy4kZW1pdCgnZXhwb3J0Jyk7CiAgICAgICAgfSwKICAgICAgICBSZXNldCgpewogICAgICAgICAgICB0aGlzLiRidXMuJGVtaXQoJ3Jlc2V0Jyk7CiAgICAgICAgICAvLyB0aGlzLnJlcXVlc3QuZ2V0KCJodHRwOi8vbG9jYWxob3N0OjkwOTAvZ2V0RmlsZWluZm9CeWlkIix7CiAgICAgICAgICAvLyAgIHBhcmFtczp7CiAgICAgICAgICAvLyAgICAgaWQ6dGhpcy5pZAogICAgICAgICAgLy8gICB9CiAgICAgICAgICAvLyB9KS50aGVuKHJlcz0+ewogICAgICAgICAgLy8gICB0aGlzLiRidXMuJGVtaXQoJ3NlbmRyZXMnLHJlcyk7CiAgICAgICAgICAvLyB9KQogICAgICAgIH0sCiAgICAgIGJlZm9yZVVwbG9hZChmaWxlKSB7CiAgICAgICAgY29uc3QgZmlsZVR5cGUgPSBmaWxlLm5hbWUuc3Vic3RyaW5nKGZpbGUubmFtZS5sYXN0SW5kZXhPZignLicpKQogICAgICAgIGlmIChmaWxlVHlwZS50b0xvd2VyQ2FzZSgpICE9ICcuanBnJyAmJiBmaWxlVHlwZS50b0xvd2VyQ2FzZSgpICE9ICcucG5nJykgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5paH5Lu25b+F6aG75Li6LmpwZ+aIli5wbmfnsbvlnosnKQogICAgICAgICAgdGhpcy5maWxlTGlzdCA9IFtdCiAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICB9CiAgICAgIH0sCiAgICAgIC8vIOimhueblmVsZW1lbnTnmoTpu5jorqTkuIrkvKDmlofku7YKICAgICAgdXBsb2FkSHR0cFJlcXVlc3QoZGF0YSkgewogICAgICAgIGxldCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpCiAgICAgICAgbGV0IHRoYXQgPSB0aGlzCiAgICAgICAgcmVhZGVyLnJlYWRBc1RleHQoZGF0YS5maWxlKQogICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbigpIHsKICAgICAgICAgIHRoYXQuZm9ybS5pbWcgPSB0aGlzLnJlc3VsdDsKICAgICAgICB9CiAgICAgICAgbGV0IHBhcmFtPW5ldyBGb3JtRGF0YSgpOwogICAgICAgIHBhcmFtLmFwcGVuZCgnZmlsZScsZGF0YS5maWxlKTsKICAgICAgICBsZXQgY29uZmlnPXtoZWFkZXJzOnsnQ29udGVudC1UeXBlJzonbXVsdGlwYXJ0L2Zvcm0tZGF0YSd9fQogICAgICAgIHRoaXMucmVxdWVzdC5wb3N0KCJodHRwOi8vbG9jYWxob3N0OjkwOTAvdXBsb2FkIiwKICAgICAgICAgIHBhcmFtLGNvbmZpZykudGhlbihyZXM9PnsKICAgICAgICAgIGNvbnNvbGUubG9nKHJlcy5maWxlaWQpOwogICAgICAgICAgdGhpcy5pbWdpZD1yZXMuZmlsZWlkOwogICAgICAgIH0pCiAgICAgIH0sCiAgICAgIC8vIOmZkOWItuaWh+S7tuS4iuS8oOeahOS4quaVsOWPquacieS4gOS4qu+8jOiOt+WPluS4iuS8oOWIl+ihqOeahOacgOWQjuS4gOS4qgogICAgICBoYW5kbGVVcGxvYWRDaGFuZ2UoZmlsZSwgZmlsZUxpc3QpIHsKICAgICAgICBpZiAoZmlsZUxpc3QubGVuZ3RoID4gMCkgewogICAgICAgICAgdGhpcy5maWxlTGlzdCA9IFtmaWxlTGlzdFtmaWxlTGlzdC5sZW5ndGggLSAxXV0gLy8g6L+Z5LiA5q2l77yM5pivIOWxleekuuacgOWQjuS4gOasoemAieaLqeeahOaWh+S7tgogICAgICAgIH0KICAgICAgfSwKICAgICAgZ2V0ZmlsZWlkKCl7CiAgICAgICAgdGhpcy4kYnVzLiRvbignc2VuZGZpbGVpZCcsKGlkKT0+ewogICAgICAgICAgdGhpcy5pZD1pZDsKICAgICAgICB9KQogICAgICB9LAogICAgICBjYW5jZWwoKXsKICAgICAgICB0aGlzLmxvYWRpbmc9ZmFsc2U7CiAgICAgICAgICB0aGlzLmZvcm09ewoKICAgICAgICAgICAgICBuYW1lOicnLAogICAgICAgICAgICAgIGRhdGUxOicnLAogICAgICAgICAgICAgIGRhdGUyOicnLAogICAgICAgICAgICAgIGltZzonJwoKICAgICAgICAgIH0KICAgICAgfSwKICAgICAgICBoYW5kbGVDbG9zZShkb25lKSB7CiAgICAgICAgdGhpcy4kY29uZmlybSgn56Gu6K6k5YWz6Zet77yfJykKICAgICAgICAgIC50aGVuKF8gPT4gewogICAgICAgICAgICBkb25lKCk7CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKF8gPT4ge30pOwogICAgICB9LAogICAgICBnZXR1c2VyaWQoKXsKICAgICAgICB0aGlzLnJlcXVlc3QuZ2V0KCJodHRwOi8vbG9jYWxob3N0OjkwOTAvdXNlci9nZXRpZCIsIHsKICAgICAgICAgIHBhcmFtczp7CiAgICAgICAgICAgIG5hbWU6dGhpcy5uYW1lCiAgICAgICAgICB9CiAgICAgICAgfSkudGhlbihyZXM9PnsKICAgICAgICAgIHRoaXMudXNlcmlkPXJlcy5pZDsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKCiAgbW91bnRlZCgpIHsKICAgICAgdGhpcy5nZXR1c2VyaWQoKTsKICAgICAgdGhpcy5nZXRmaWxlaWQoKTsKICB9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0DA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/Editor/Footer","sourcesContent":["<template>\n  <div class=\"Footer\">\n    <el-button @click=\"Save\" type=\"primary\" style=\"margin-left: 16px;\">\n        保存\n    </el-button>\n    <el-button @click=\"Reset\" type=\"primary\" style=\"margin-left: 16px;\" >\n        重置\n    </el-button>\n    <el-button @click=\"Export\" type=\"primary\" style=\"margin-left: 16px;\">\n        导出\n    </el-button>\n\n    <el-drawer\n    title=\"文件\"\n    :visible.sync=\"drawer\"\n    :with-header=\"false\"\n    :before-close=\"handleClose\"\n    custom-class=\"demo-drawer\"\n    >\n      <div class=\"demo-drawer__content\">\n        <el-form :model=\"form\" label-width=\"80px\">\n          <el-form-item label=\"文件名\">\n            <el-input v-model=\"form.name\" autocomplete=\"off\"></el-input>\n          </el-form-item>\n\n          <el-form-item label=\"封面\" label-width=\"80px\">\n            <el-upload\n              class=\"upload-demo\"\n              drag\n              action=\"#\"\n              :multiple=\"false\"\n              :show-file-list=\"true\"\n              :http-request=\"uploadHttpRequest\"\n              :file-list=\"fileList\"\n              :on-change=\"handleUploadChange\"\n              :before-upload=\"beforeUpload\"\n              >\n              <i class=\"el-icon-upload\"></i>\n              <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\n              <div class=\"el-upload__tip\" slot=\"tip\">只能上传jpg/png文件，且不超过500kb</div>\n            </el-upload>\n          </el-form-item>\n          <el-form-item>\n              <el-button type=\"primary\" @click=\"onSubmit\" :loading=\"loading\">{{ loading ? '提交中 ...' : '立即保存' }}</el-button>\n              <el-button @click=\"cancel\">取消</el-button>\n          </el-form-item>\n        </el-form>\n<!--        <div class=\"demo-drawer__footer\">-->\n<!--          <el-button @click=\"cancelForm\">取 消</el-button>-->\n<!--          <el-button type=\"primary\" @click=\"$refs.drawer.closeDrawer()\" :loading=\"loading\">{{ loading ? '提交中 ...' : '确 定' }}</el-button>-->\n<!--        </div>-->\n\n      </div>\n    </el-drawer>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex'\nexport default {\n\n  /*bug:\n  * 场景树在每次点击编辑后会改变 √\n  * 跳转路由问题 √\n  * 新增按钮 √\n  * 图片异常问题 √\n  * 播放器样式\n  * 按钮样式\n  * 提交抽屉优化 √\n  * 加载动画\n  * 关闭演示时音乐关闭\n  * 登录*/\n    data() {\n        return {\n            drawer:false,\n            fileList:[],\n          loading:false,\n          id:null,\n         file:null,\n            form:{\n              name:'',\n              date1:'',\n              date2:'',\n              img:'',\n            },\n          userid:null,\n          username:null,\n          imgid:''\n\n        }\n    },\n  computed: {\n    ...mapGetters([\n      'name'\n    ])\n  },\n    methods: {\n      Save(){\n        this.drawer = true;\n        if(this.id!=null){\n          this.request.get(\"http://localhost:9090/scenefile/getbyid\",{\n            params:{\n              id:this.id\n            }\n          }).then(res=>{\n\n            this.form.name=res.file.filename;\n            this.userid=res.file.userid;\n            this.username=res.file.username;\n          })\n        }\n      },\n      onSubmit(){\n        this.$bus.$emit('requestsave');\n        this.$bus.$on('responsesave',(id)=>{\n\n            let scenefile={\n              id:this.id,\n              userid:this.userid,\n              username:this.name,\n              filename:this.form.name,\n              file: id,\n              fileimg: this.imgid,\n\n            }\n            console.log(this.imgid);\n            this.request.post(\"http://localhost:9090/scenefile\",scenefile)\n          .then(res=>{\n            // console.log(res);\n            this.loading=true;\n            this.drawer=false;\n            this.form={\n\n              name:'',\n              date1:'',\n              date2:'',\n              img:''\n\n            };\n\n\n          })\n        })\n      },\n      // Load(){\n      // //console.log(this.file);\n      // let param=new FormData();\n      // param.append('file',this.file);\n      // let config={headers:{'Content-Type':'multipart/form-data'}}\n      //   this.request.post(\"http://localhost:9090/upload\",\n      //    param,config).then(res=>{\n      //     //console.log(res);\n      //     this.id=res.fileid;\n      //   })\n      //\n      // },\n      // Upload(e){\n      //   this.file=e.target.files[0];\n      // },\n        Export(){\n            this.$bus.$emit('export');\n        },\n        Reset(){\n            this.$bus.$emit('reset');\n          // this.request.get(\"http://localhost:9090/getFileinfoByid\",{\n          //   params:{\n          //     id:this.id\n          //   }\n          // }).then(res=>{\n          //   this.$bus.$emit('sendres',res);\n          // })\n        },\n      beforeUpload(file) {\n        const fileType = file.name.substring(file.name.lastIndexOf('.'))\n        if (fileType.toLowerCase() != '.jpg' && fileType.toLowerCase() != '.png') {\n          this.$message.error('文件必须为.jpg或.png类型')\n          this.fileList = []\n          return false\n        }\n      },\n      // 覆盖element的默认上传文件\n      uploadHttpRequest(data) {\n        let reader = new FileReader()\n        let that = this\n        reader.readAsText(data.file)\n        reader.onload = function() {\n          that.form.img = this.result;\n        }\n        let param=new FormData();\n        param.append('file',data.file);\n        let config={headers:{'Content-Type':'multipart/form-data'}}\n        this.request.post(\"http://localhost:9090/upload\",\n          param,config).then(res=>{\n          console.log(res.fileid);\n          this.imgid=res.fileid;\n        })\n      },\n      // 限制文件上传的个数只有一个，获取上传列表的最后一个\n      handleUploadChange(file, fileList) {\n        if (fileList.length > 0) {\n          this.fileList = [fileList[fileList.length - 1]] // 这一步，是 展示最后一次选择的文件\n        }\n      },\n      getfileid(){\n        this.$bus.$on('sendfileid',(id)=>{\n          this.id=id;\n        })\n      },\n      cancel(){\n        this.loading=false;\n          this.form={\n\n              name:'',\n              date1:'',\n              date2:'',\n              img:''\n\n          }\n      },\n        handleClose(done) {\n        this.$confirm('确认关闭？')\n          .then(_ => {\n            done();\n          })\n          .catch(_ => {});\n      },\n      getuserid(){\n        this.request.get(\"http://localhost:9090/user/getid\", {\n          params:{\n            name:this.name\n          }\n        }).then(res=>{\n          this.userid=res.id;\n        });\n      }\n    },\n\n  mounted() {\n      this.getuserid();\n      this.getfileid();\n  }\n}\n</script>\n\n<style>\n\n</style>\n"]}]}