{"remainingRequest":"E:\\vue\\vue-admin-template-master\\node_modules\\babel-loader\\lib\\index.js!E:\\vue\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\vue\\vue-admin-template-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\vue\\vue-admin-template-master\\src\\views\\scene\\Scene.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\vue\\vue-admin-template-master\\src\\views\\scene\\Scene.vue","mtime":1651999233292},{"path":"E:\\vue\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vue\\vue-admin-template-master\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\vue\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vue\\vue-admin-template-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\vue\\vue-admin-template-master\\babel.config.js","mtime":1637248914000},{"path":"E:\\vue\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vue\\vue-admin-template-master\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\vue\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vue\\vue-admin-template-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnVybC1zZWFyY2gtcGFyYW1zLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS1idWZmZXIuc2xpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS51aW50OC1hcnJheS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmNvcHktd2l0aGluLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZXZlcnkuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maWxsLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZpbmQtaW5kZXguanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuaW5kZXgtb2YuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmpvaW4uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5sYXN0LWluZGV4LW9mLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmVkdWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmVkdWNlLXJpZ2h0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmV2ZXJzZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNldC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc29tZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNvcnQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zdWJhcnJheS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnRvLWxvY2FsZS1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgKiBhcyBUSFJFRSBmcm9tICd0aHJlZS9idWlsZC90aHJlZS5tb2R1bGUuanMnOwppbXBvcnQgU3RhdHMgZnJvbSAnLi4vLi4vc3RvcmUvU3RhdHMvc3RhdHMubWluLmpzJzsKaW1wb3J0IHsgT3JiaXRDb250cm9scyB9IGZyb20gIi4uLy4uL2xpYi9PcmJpdENvbnRyb2xzLmpzIjsKaW1wb3J0IGluZGV4LCB7IEdVSSB9IGZyb20gIi4uLy4uL2xpYi9kYXQuZ3VpLm1vZHVsZS5qcyI7IC8v6L6J5YWJCgppbXBvcnQgeyBFZmZlY3RDb21wb3NlciB9IGZyb20gInRocmVlL2V4YW1wbGVzL2pzbS9wb3N0cHJvY2Vzc2luZy9FZmZlY3RDb21wb3Nlci5qcyI7CmltcG9ydCB7IFJlbmRlclBhc3MgfSBmcm9tICJ0aHJlZS9leGFtcGxlcy9qc20vcG9zdHByb2Nlc3NpbmcvUmVuZGVyUGFzcy5qcyI7CmltcG9ydCB7IEdsaXRjaFBhc3MgfSBmcm9tICd0aHJlZS9leGFtcGxlcy9qc20vcG9zdHByb2Nlc3NpbmcvR2xpdGNoUGFzcy5qcyc7CmltcG9ydCB7IFVucmVhbEJsb29tUGFzcyB9IGZyb20gInRocmVlL2V4YW1wbGVzL2pzbS9wb3N0cHJvY2Vzc2luZy9VbnJlYWxCbG9vbVBhc3MuanMiOwppbXBvcnQgeyBTaGFkZXJQYXNzIH0gZnJvbSAidGhyZWUvZXhhbXBsZXMvanNtL3Bvc3Rwcm9jZXNzaW5nL1NoYWRlclBhc3MuanMiOwppbXBvcnQgeyBDb3B5U2hhZGVyIH0gZnJvbSAidGhyZWUvZXhhbXBsZXMvanNtL3NoYWRlcnMvQ29weVNoYWRlci5qcyI7CmltcG9ydCB7IHJhbmdlIH0gZnJvbSAiLi4vLi4vY29tcG9uZW50cy9tb2RlL3JhbmdlIjsKaW1wb3J0IHsgbm9kZSB9IGZyb20gIi4uLy4uL2NvbXBvbmVudHMvbW9kZS9ub2RlIjsKaW1wb3J0IEF1ZGlvUGxheWVyIGZyb20gIi4uL3NjZW5lL1BsYXllci9QbGF5ZXIudnVlIjsKaW1wb3J0IHsgcmFuZG9tUmFuZ2UgfSBmcm9tICIuLi8uLi9jb21wb25lbnRzL21vZGUvcmFuZG9tUmFuZ2UiOwppbXBvcnQgeyBUcmlhbmdsZSB9IGZyb20gIi4uLy4uL2NvbXBvbmVudHMvbW9kZS9UcmlhbmdsZSI7CmltcG9ydCB7IExvYWRlciB9IGZyb20gJy4uLy4uL2xpYi90aHJlZS5tb2R1bGUuanMnOwp2YXIgcmVuZGVyZXIsIGNhbWVyYSwgc2NlbmUsIGdlb21ldHJ5LCBtYXRlcmlhbCwgbWVzaCwgc3RhdHMsIGNvbnRyb2xzOyAvLyAgbGV0IGNvbnRhaW5lcj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2ViZ2wnKTsKCnZhciBndWkgPSB7CiAgUjogMjAsCiAgRzogOTAsCiAgQjogMjI1LAogIFRyaWFuZ2xlc0JnQ29sb3I6IDB4MDNhOWY0LAogIFRyaWFuZ2xlc0xpbmVDb2xvcjogMHgwM2E5ZjQsCiAgbGluZUNvbG9yOiAweDAwZmZmZiwKICByb3RhdGU6IGZhbHNlCn07CnZhciBhdWRpbywgYW5hbHlzZXI7IC8vIOmfs+mikQoKdmFyIEJhck5vZGVzOyAvLyDnur8KCnZhciBjb21wb3NlcjsgLy/lkIjmiJDlmagKCnZhciBUcmlhbmdsZXMgPSBbXSwKICAgIFRyaWFuZ2xlR3JvdXA7CnZhciBMaW5lR3JvdXBzID0gW107CnZhciBCYXJHcm91cHMgPSBbXTsKdmFyIEdlb21ldHJ5R3JvdXBzID0gW107CnZhciBtYXAgPSBbXTsKdmFyIENvbG9yTWFwID0gW107CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnU2NlbmUnLAogIGNvbXBvbmVudHM6IHsKICAgIEF1ZGlvUGxheWVyOiBBdWRpb1BsYXllcgogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGNsb2NrOiBuZXcgVEhSRUUuQ2xvY2soKSwKICAgICAgc2NhbGU6IDEsCiAgICAgIEFuYWx5c2VyOiBudWxsLAogICAgICBpc1BsYXlpbmc6IGZhbHNlLAogICAgICBpc0xvYWRlZDogZmFsc2UKICAgIH07CiAgfSwKICB3YXRjaDogewogICAgaXNMb2FkZWQ6IHsKICAgICAgaGFuZGxlcjogZnVuY3Rpb24gaGFuZGxlcigpIHsKICAgICAgICBpZiAodGhpcy5pc0xvYWRlZCA9PSB0cnVlKSB7CiAgICAgICAgICB0aGlzLmluaXRMaWdodCgpOwogICAgICAgICAgdGhpcy5BbmFseXNpc0xpbmUoKTsKICAgICAgICAgIHRoaXMuaW5pdEJhcnMoKTsKICAgICAgICAgIHRoaXMuaW5pdEVmZmVjdENvbXBvc2VyKCk7IC8vdGhhdC5pbml0U3RhdHMoKTsKICAgICAgICAgIC8vIGluaXREYXRHVUkoKTsKCiAgICAgICAgICB0aGlzLmFuaW1hdGUoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIEltcG9ydDogZnVuY3Rpb24gSW1wb3J0KCkgewogICAgICB0aGlzLmlzTG9hZGVkID0gZmFsc2U7IC8v5q+P5qyh5a+85YWl5pS55Y+Y5YC854S25ZCO6YeN5paw5riy5p+TCgogICAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICAgIHZhciBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7CiAgICAgIGlucHV0LnR5cGUgPSAiZmlsZSI7CiAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsIGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgZmlsZSA9IGlucHV0LmZpbGVzWzBdOwoKICAgICAgICBpZiAoZmlsZS50eXBlLmluZGV4T2YoImpzb24iKSA+PSAwKSB7CiAgICAgICAgICB2YXIgdXJsID0gbnVsbDsKCiAgICAgICAgICBpZiAod2luZG93LmNyZWF0ZU9iamVjdFVSTCAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgLy8gYmFzaWMKICAgICAgICAgICAgdXJsID0gd2luZG93LmNyZWF0ZU9iamVjdFVSTChmaWxlKTsKICAgICAgICAgIH0gZWxzZSBpZiAod2luZG93LlVSTCAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgLy8gbW96aWxsYShmaXJlZm94KQogICAgICAgICAgICB1cmwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlKTsKICAgICAgICAgIH0gZWxzZSBpZiAod2luZG93LndlYmtpdFVSTCAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgLy8gd2Via2l0IG9yIGNocm9tZQogICAgICAgICAgICB1cmwgPSB3aW5kb3cud2Via2l0VVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlKTsKICAgICAgICAgIH0gLy/moLnmja51cmzov5vooYzliqDovb3lm57osIPvvIzlj6/ku6XpmLLmraIKICAgICAgICAgIC8vICAgICBsZXQgcmVhZGVyPW5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgICAvLyAgICAgLy9yZWFkZXIucmVhZEFzVGV4dChmaWxlKTsKICAgICAgICAgIC8vICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsKICAgICAgICAgIC8vIHJlYWRlci5vbmxvYWRlbmQgPSBmdW5jdGlvbihlKSB7CiAgICAgICAgICAvLyAgIF90aGF0LmF1ZGlvTG9hZChlLnRhcmdldC5yZXN1bHQpOwogICAgICAgICAgLy8gfTsKCgogICAgICAgICAgdmFyIGxvYWRlciA9IG5ldyBUSFJFRS5PYmplY3RMb2FkZXIoKTsKICAgICAgICAgIGxvYWRlci5sb2FkKHVybCwgZnVuY3Rpb24gKG9iaikgewogICAgICAgICAgICAvL+WKoOi9veWujOaIkOWQjui/m+ihjAogICAgICAgICAgICBzY2VuZSA9IG9iajsKICAgICAgICAgICAgdGhhdC5pc0xvYWRlZCA9IHRydWU7CiAgICAgICAgICB9LCAvLyBvblByb2dyZXNzIGNhbGxiYWNrCiAgICAgICAgICBmdW5jdGlvbiAoeGhyKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHhoci5sb2FkZWQgLyB4aHIudG90YWwgKiAxMDAgKyAnJSBsb2FkZWQnKTsKICAgICAgICAgIH0sIC8vIG9uRXJyb3IgY2FsbGJhY2sKICAgICAgICAgIGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcignQW4gZXJyb3IgaGFwcGVuZWQnICsgZXJyKTsKICAgICAgICAgIH0pOyAvLyBsZXQgcmVhZGVyPW5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgICAvLyByZWFkZXIucmVhZEFzVGV4dChmaWxlKTsKICAgICAgICAgIC8vIHJlYWRlci5vbmxvYWRlbmQ9ZnVuY3Rpb24oKXsKICAgICAgICAgIC8vICAgbGV0IGxvYWRlcj1uZXcgVEhSRUUuT2JqZWN0TG9hZGVyKCk7CiAgICAgICAgICAvLyAgIGxvYWRlci5wYXJzZShKU09OLnBhcnNlKHRoaXMucmVzdWx0KSwKICAgICAgICAgIC8vICAgICBmdW5jdGlvbihvYmopewogICAgICAgICAgLy8gICAgICAgc2NlbmU9b2JqOwogICAgICAgICAgLy8gICAgIH0KICAgICAgICAgIC8vICAgKTsKICAgICAgICAgIC8vc2NlbmU9bmV3c2NlbmU7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgaW5wdXQuY2xpY2soKTsKICAgIH0sCiAgICAvLyDpgInmi6npn7PpopEKICAgIC8vIGdldEF1ZGlvKCkgewogICAgLy8gICBsZXQgX3RoYXQgPSB0aGlzOwogICAgLy8gICBsZXQgb2JqRmlsZSA9IHRoaXMuJHJlZnMuZmlsZUlkOwogICAgLy8gICBpZiAob2JqRmlsZS52YWx1ZSA9PT0gIiIpIHsKICAgIC8vICAgICByZXR1cm4gZmFsc2U7CiAgICAvLyAgIH0KICAgIC8vICAgaWYgKHdpbmRvdy5GaWxlUmVhZGVyKSB7CiAgICAvLyAgICAgbGV0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAvLyAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwob2JqRmlsZS5maWxlc1swXSk7CiAgICAvLyAgICAgcmVhZGVyLm9ubG9hZGVuZCA9IGZ1bmN0aW9uKGUpIHsKICAgIC8vICAgICAgIF90aGF0LmF1ZGlvTG9hZChlLnRhcmdldC5yZXN1bHQpOwogICAgLy8gICAgIH07CiAgICAvLyAgIH0KICAgIC8vIH0sCiAgICAvLyAg6Z+z6aKR5Yqg6L295pKt5pS+CiAgICAvLyBhdWRpb0xvYWQodXJsKSB7CiAgICAvLyAgIC8vIGxldCBfdGhhdCA9IHRoaXM7CiAgICAvLyAgIGxldCBhdWRpb0xvYWRlciA9IG5ldyBUSFJFRS5BdWRpb0xvYWRlcigpOyAvLyDpn7PpopHliqDovb3lmagKICAgIC8vICAgYXVkaW9Mb2FkZXIubG9hZCh1cmwsIGZ1bmN0aW9uKEF1ZGlvQnVmZmVyKSB7CiAgICAvLyAgICAgaWYgKGF1ZGlvLmlzUGxheWluZykgewogICAgLy8gICAgICAgYXVkaW8uc3RvcCgpOwogICAgLy8gICAgICAgYXVkaW8uc2V0QnVmZmVyKCk7CiAgICAvLyAgICAgfQogICAgLy8gICAgIGF1ZGlvLnNldEJ1ZmZlcihBdWRpb0J1ZmZlcik7IC8vIOmfs+mikee8k+WGsuWMuuWvueixoeWFs+iBlOWIsOmfs+mikeWvueixoWF1ZGlvCiAgICAvLyAgICAgYXVkaW8uc2V0TG9vcCh0cnVlKTsgLy/mmK/lkKblvqrnjq8KICAgIC8vICAgICBhdWRpby5zZXRWb2x1bWUoMSk7IC8v6Z+z6YePCiAgICAvLyAgICAgYXVkaW8ucGxheSgpOyAvL+aSreaUvgogICAgLy8gICAgIC8vIOmfs+mikeWIhuaekOWZqOWSjOmfs+mikee7keWumu+8jOWPr+S7peWunuaXtumHh+mbhumfs+mikeaXtuWfn+aVsOaNrui/m+ihjOW/q+mAn+WChemHjOWPtuWPmOaNogogICAgLy8gICAgIGFuYWx5c2VyID0gbmV3IFRIUkVFLkF1ZGlvQW5hbHlzZXIoYXVkaW8sIDI1NiAqIDIpOwogICAgLy8gICB9KTsKICAgIC8vIH0sCiAgICBHZXRTdGF0ZTogZnVuY3Rpb24gR2V0U3RhdGUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB0aGlzLiRidXMuJG9uKCdQbGF5U3RhdGUnLCBmdW5jdGlvbiAoaXNQbGF5aW5nKSB7CiAgICAgICAgX3RoaXMuaXNQbGF5aW5nID0gaXNQbGF5aW5nOwogICAgICB9KTsKICAgIH0sCiAgICBHZXRBdWRpb0RhdGE6IGZ1bmN0aW9uIEdldEF1ZGlvRGF0YSgpIHsKICAgICAgdmFyIHRoYXQgPSB0aGlzOwogICAgICB0aGlzLiRidXMuJG9uKCdCaW5kaW5nQW5hbHlzZXInLCBmdW5jdGlvbiAoYW5hbHlzZXIpIHsKICAgICAgICB0aGF0LkFuYWx5c2VyID0gYW5hbHlzZXI7CiAgICAgIH0pOwogICAgfSwKICAgIGluaXRBdWRpbzogZnVuY3Rpb24gaW5pdEF1ZGlvKCkgewogICAgICB2YXIgbGlzdGVuZXIgPSBuZXcgVEhSRUUuQXVkaW9MaXN0ZW5lcigpOwogICAgICBhdWRpbyA9IG5ldyBUSFJFRS5BdWRpbyhsaXN0ZW5lcik7CiAgICB9LAogICAgQW5hbHlzaXNMaW5lOiBmdW5jdGlvbiBBbmFseXNpc0xpbmUoKSB7CiAgICAgIC8v6I635Y+W5Y+Y5YyW57q/5q61CiAgICAgIHNjZW5lLnRyYXZlcnNlKGZ1bmN0aW9uIChvYmopIHsKICAgICAgICBpZiAob2JqLm5hbWUuaW5kZXhPZigi6Z+z6aKR57q/IikgIT0gLTEpIHsKICAgICAgICAgIExpbmVHcm91cHMucHVzaChvYmopOwogICAgICAgICAgbWFwLnB1c2goewogICAgICAgICAgICB1dWlkOiBvYmoudXVpZCwKICAgICAgICAgICAgeDogb2JqLnNjYWxlLngsCiAgICAgICAgICAgIHk6IG9iai5zY2FsZS55LAogICAgICAgICAgICB6OiBvYmouc2NhbGUuegogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIGlmIChvYmoubmFtZS5pbmRleE9mKCLpn7PpopHosLEiKSAhPSAtMSkgewogICAgICAgICAgQmFyR3JvdXBzLnB1c2gob2JqKTsKICAgICAgICAgIG1hcC5wdXNoKHsKICAgICAgICAgICAgdXVpZDogb2JqLnV1aWQsCiAgICAgICAgICAgIHg6IG9iai5zY2FsZS54LAogICAgICAgICAgICB5OiBvYmouc2NhbGUueSwKICAgICAgICAgICAgejogb2JqLnNjYWxlLnoKICAgICAgICAgIH0pOyAvLyBjb25zb2xlLmxvZyhvYmouY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0pOwoKICAgICAgICAgIENvbG9yTWFwLnB1c2goewogICAgICAgICAgICB1dWlkOiBvYmoudXVpZCwKICAgICAgICAgICAgcjogb2JqLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzBdLm1hdGVyaWFsLmNvbG9yLnIsCiAgICAgICAgICAgIGc6IG9iai5jaGlsZHJlblswXS5jaGlsZHJlblswXS5tYXRlcmlhbC5jb2xvci5nLAogICAgICAgICAgICBiOiBvYmouY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0ubWF0ZXJpYWwuY29sb3IuYgogICAgICAgICAgfSk7CiAgICAgICAgICBjb25zb2xlLmxvZyhvYmouY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0ubWF0ZXJpYWwuY29sb3IpOwogICAgICAgICAgY29uc29sZS5sb2coQ29sb3JNYXApOwogICAgICAgIH0gZWxzZSBpZiAob2JqLnR5cGUuaW5kZXhPZignTWVzaCcpICE9IC0xICYmIG9iai5wYXJlbnQgPT0gc2NlbmUpIHsKICAgICAgICAgIC8v5Yeg5L2V5L2TCiAgICAgICAgICBHZW9tZXRyeUdyb3Vwcy5wdXNoKG9iaik7CiAgICAgICAgICBtYXAucHVzaCh7CiAgICAgICAgICAgIHV1aWQ6IG9iai51dWlkLAogICAgICAgICAgICB4OiBvYmouc2NhbGUueCwKICAgICAgICAgICAgeTogb2JqLnNjYWxlLnksCiAgICAgICAgICAgIHo6IG9iai5zY2FsZS56CiAgICAgICAgICB9KTsKICAgICAgICAgIGNvbnNvbGUubG9nKEdlb21ldHJ5R3JvdXBzKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHVwZGF0ZUNpcmNsZTogZnVuY3Rpb24gdXBkYXRlQ2lyY2xlKGxpbmVzR3JvdXAsIHgsIHksIHopIHsKICAgICAgaWYgKEJhck5vZGVzKSB7CiAgICAgICAgbGluZXNHcm91cC5zY2FsZS5zZXQodGhpcy5zY2FsZSAqIHgsIHRoaXMuc2NhbGUgKiB5LCB0aGlzLnNjYWxlICogeik7CiAgICAgICAgdmFyIGdlb21ldHJ5QSA9IGxpbmVzR3JvdXAuY2hpbGRyZW5bMF0uZ2VvbWV0cnk7IC8vb3V0bGluZQoKICAgICAgICB2YXIgQXR0cmlidXRlQSA9IGdlb21ldHJ5QS5nZXRBdHRyaWJ1dGUoInBvc2l0aW9uIik7CiAgICAgICAgdmFyIGdlb21ldHJ5QiA9IGxpbmVzR3JvdXAuY2hpbGRyZW5bMV0uZ2VvbWV0cnk7IC8vaW5saW5lCgogICAgICAgIHZhciBBdHRyaWJ1dGVCID0gZ2VvbWV0cnlCLmdldEF0dHJpYnV0ZSgicG9zaXRpb24iKTsKICAgICAgICB2YXIgcG9zaXRpb25zID0gQmFyTm9kZXMubWFwKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgICAgcmV0dXJuIFt2YWx1ZS5wb3NpdGlvbkEoKSwgdmFsdWUucG9zaXRpb25CKCldOwogICAgICAgIH0pOwogICAgICAgIHBvc2l0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChwb3NpdGlvbiwgaW5kZXgpIHsKICAgICAgICAgIEF0dHJpYnV0ZUEuc2V0KFtwb3NpdGlvblswXS54LCBwb3NpdGlvblswXS55XSwgaW5kZXggKiAzKTsKICAgICAgICAgIEF0dHJpYnV0ZUIuc2V0KFtwb3NpdGlvblsxXS54LCBwb3NpdGlvblsxXS55XSwgaW5kZXggKiAzKTsgLy/liY3kuKTnur/mmK9vdXRsaW5l5ZKMaW5saW5lCgogICAgICAgICAgdmFyIGdlb21ldHJ5ID0gbGluZXNHcm91cC5jaGlsZHJlbltpbmRleCArIDJdLmdlb21ldHJ5OwogICAgICAgICAgdmFyIEF0dHJpYnV0ZSA9IGdlb21ldHJ5LmdldEF0dHJpYnV0ZSgicG9zaXRpb24iKTsKICAgICAgICAgIEF0dHJpYnV0ZS5zZXQoW3Bvc2l0aW9uWzBdLngsIHBvc2l0aW9uWzBdLnksIDAsIHBvc2l0aW9uWzFdLngsIHBvc2l0aW9uWzFdLnksIDBdLCAwKTsKICAgICAgICAgIEF0dHJpYnV0ZS5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgICAgfSk7CiAgICAgICAgQXR0cmlidXRlQS5zZXQoW0F0dHJpYnV0ZUEuYXJyYXlbMF0sIEF0dHJpYnV0ZUEuYXJyYXlbMV1dLCBwb3NpdGlvbnMubGVuZ3RoICogMyk7CiAgICAgICAgQXR0cmlidXRlQi5zZXQoW0F0dHJpYnV0ZUIuYXJyYXlbMF0sIEF0dHJpYnV0ZUIuYXJyYXlbMV1dLCBwb3NpdGlvbnMubGVuZ3RoICogMyk7CiAgICAgICAgQXR0cmlidXRlQS5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgICAgQXR0cmlidXRlQi5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgIH0KICAgIH0sCiAgICBpbml0OiBmdW5jdGlvbiBpbml0KCkgewogICAgICB0aGlzLmluaXRSZW5kZXJlcigpOwogICAgICB0aGlzLmluaXRTY2VuZSgpOwogICAgICB0aGlzLmluaXRDYW1lcmEoKTsKICAgICAgdGhpcy5pbml0Q29udHJvbHMoKTsKICAgICAgdGhpcy5pbml0QXVkaW8oKTsgLy90aGlzLmluaXRFZmZlY3RDb21wb3NlcigpOwoKICAgICAgdGhpcy5pbml0U3RhdHMoKTsgLy8gaW5pdERhdEdVSSgpOwogICAgICAvL3RoaXMuYW5pbWF0ZSgpOwogICAgfSwKICAgIGluaXRDb250cm9sczogZnVuY3Rpb24gaW5pdENvbnRyb2xzKCkgewogICAgICBjb250cm9scyA9IG5ldyBPcmJpdENvbnRyb2xzKGNhbWVyYSwgcmVuZGVyZXIuZG9tRWxlbWVudCk7IC8vIOWmguaenOS9v+eUqGFuaW1hdGXmlrnms5Xml7bvvIzlsIbmraTlh73mlbDliKDpmaQKICAgICAgLy9jb250cm9scy5hZGRFdmVudExpc3RlbmVyKCAnY2hhbmdlJywgcmVuZGVyICk7CiAgICAgIC8vIOS9v+WKqOeUu+W+queOr+S9v+eUqOaXtumYu+WwvOaIluiHqui9rCDmhI/mgJ3mmK/lkKbmnInmg6/mgKcKCiAgICAgIGNvbnRyb2xzLmVuYWJsZURhbXBpbmcgPSB0cnVlOyAvL+WKqOaAgemYu+WwvOezu+aVsCDlsLHmmK/pvKDmoIfmi5bmi73ml4vovazngbXmlY/luqYKICAgICAgLy9jb250cm9scy5kYW1waW5nRmFjdG9yID0gMC4yNTsKICAgICAgLy/mmK/lkKblj6/ku6XnvKnmlL4KCiAgICAgIGNvbnRyb2xzLmVuYWJsZVpvb20gPSBmYWxzZTsgLy/mmK/lkKboh6rliqjml4vovawKCiAgICAgIGNvbnRyb2xzLmF1dG9Sb3RhdGUgPSBndWkucm90YXRlOyAvL+iuvue9ruebuOacuui3neemu+WOn+eCueeahOacgOi/nOi3neemuwoKICAgICAgY29udHJvbHMubWluRGlzdGFuY2UgPSAxOyAvL+iuvue9ruebuOacuui3neemu+WOn+eCueeahOacgOi/nOi3neemuwoKICAgICAgY29udHJvbHMubWF4RGlzdGFuY2UgPSAyMDA7IC8v5piv5ZCm5byA5ZCv5Y+z6ZSu5ouW5ou9CgogICAgICBjb250cm9scy5lbmFibGVQYW4gPSBmYWxzZTsKICAgIH0sCiAgICBpbml0TGlnaHQ6IGZ1bmN0aW9uIGluaXRMaWdodCgpIHsKICAgICAgc2NlbmUuYWRkKG5ldyBUSFJFRS5BbWJpZW50TGlnaHQoMHg0NDQ0NDQpKTsKICAgICAgdmFyIGxpZ2h0ID0gbmV3IFRIUkVFLlBvaW50TGlnaHQoMHhmZmZmZmYpOwogICAgICBsaWdodC5wb3NpdGlvbi5zZXQoODAsIDEwMCwgNTApOyAvL+WRiuivieW5s+ihjOWFiemcgOimgeW8gOWQr+mYtOW9seaKleWwhAoKICAgICAgbGlnaHQuY2FzdFNoYWRvdyA9IHRydWU7CiAgICAgIHNjZW5lLmFkZChsaWdodCk7CiAgICB9LAogICAgaW5pdFN0YXRzOiBmdW5jdGlvbiBpbml0U3RhdHMoKSB7CiAgICAgIHN0YXRzID0gbmV3IFN0YXRzKCk7CiAgICAgIHN0YXRzLmRvbUVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnOyAvL+e7neWvueWdkOaghyAgCgogICAgICBzdGF0cy5kb21FbGVtZW50LnN0eWxlLmxlZnQgPSAnMHB4JzsgLy8gKDAsMClweCzlt6bkuIrop5IgIAoKICAgICAgc3RhdHMuZG9tRWxlbWVudC5zdHlsZS50b3AgPSAnMHB4JzsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dlYmdsJykuYXBwZW5kQ2hpbGQoc3RhdHMuZG9tRWxlbWVudCk7CiAgICB9LAogICAgLy8gdXBkYXRlUG9zaXRpb24oKXsKICAgIC8vICAgICBtZXNoLnBvc2l0aW9uLnNldChjb250cm9scy5wb3NpdGlvblgsY29udHJvbHMucG9zaXRpb25ZLGNvbnRyb2xzLnBvc2l0aW9uWik7CiAgICAvLyB9LAogICAgLy/liJ3lp4vljJbmuLLmn5PlmagKICAgIGluaXRSZW5kZXJlcjogZnVuY3Rpb24gaW5pdFJlbmRlcmVyKCkgewogICAgICByZW5kZXJlciA9IG5ldyBUSFJFRS5XZWJHTFJlbmRlcmVyKHsKICAgICAgICBhbnRpYWxpYXM6IHRydWUKICAgICAgfSk7IC8v5a6e5L6L5YyW5riy5p+T5ZmoCgogICAgICByZW5kZXJlci5zZXRTaXplKHdpbmRvdy5pbm5lcldpZHRoICogMC44NSwgd2luZG93LmlubmVySGVpZ2h0ICogMC44NSk7IC8v6K6+572u5a696auYCgogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2ViZ2wnKS5hcHBlbmRDaGlsZChyZW5kZXJlci5kb21FbGVtZW50KTsgLy/mt7vliqDliLBkb20KICAgIH0sCiAgICAvL+WIneWni+WMluWcuuaZrwogICAgaW5pdFNjZW5lOiBmdW5jdGlvbiBpbml0U2NlbmUoKSB7CiAgICAgIHNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7IC8v5a6e5L6L5YyW5Zy65pmvCiAgICAgIC8vICAgICBzY2VuZS5iYWNrZ3JvdW5kID0gbmV3IFRIUkVFLkN1YmVUZXh0dXJlTG9hZGVyKCkubG9hZChbCiAgICAgIC8vICAgcmVxdWlyZSgnQC9hc3NldHMvc2t5Ym94L3JpZ2h0LmpwZycpLAogICAgICAvLyAgIHJlcXVpcmUoJ0AvYXNzZXRzL3NreWJveC9sZWZ0LmpwZycpLAogICAgICAvLyAgIHJlcXVpcmUoJ0AvYXNzZXRzL3NreWJveC90b3AuanBnJyksCiAgICAgIC8vICAgcmVxdWlyZSgnQC9hc3NldHMvc2t5Ym94L2JvdHRvbS5qcGcnKSwKICAgICAgLy8gICByZXF1aXJlKCdAL2Fzc2V0cy9za3lib3gvZnJvbnQuanBnJyksCiAgICAgIC8vICAgcmVxdWlyZSgnQC9hc3NldHMvc2t5Ym94L2JhY2suanBnJykKICAgICAgLy8gXSk7CiAgICB9LAogICAgLy/liJ3lp4vljJbnm7jmnLoKICAgIGluaXRDYW1lcmE6IGZ1bmN0aW9uIGluaXRDYW1lcmEoKSB7CiAgICAgIGNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSg0NSwgd2luZG93LmlubmVyV2lkdGggLyB3aW5kb3cuaW5uZXJIZWlnaHQsIDAuMSwgMjAwKTsgLy/lrp7kvovljJbnm7jmnLrjgJEKCiAgICAgIGNhbWVyYS5wb3NpdGlvbi5zZXQoMCwgMCwgMTUwKTsKICAgIH0sCiAgICAvL+WIm+W7uuaooeWeiwogICAgLy/ov5DooYzliqjnlLsKICAgIGFuaW1hdGU6IGZ1bmN0aW9uIGFuaW1hdGUoKSB7CiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLmFuaW1hdGUpOyAvL+W+queOr+iwg+eUqOWHveaVsAogICAgICAvLyBtZXNoLnJvdGF0aW9uLngrPTAuMDE7CiAgICAgIC8vIC8vIC8v5q+P5bin572R5qC85qih5Z6L5rK/eOi9tOaXi+i9rDAuMDHlvKfluqYKICAgICAgLy8gbWVzaC5yb3RhdGlvbi55Kz0wLjAyOwogICAgICAvLyAvL+avj+W4p+e9keagvOaooeWei+ayv3novbTml4vovawwLjAy5byn5bqmCiAgICAgIC8vIC8vc3RhdHMudXBkYXRlKCk7Ly/mm7TmlrDmgKfog73mo4DmtYvmoYYKCiAgICAgIHN0YXRzLnVwZGF0ZSgpOwogICAgICBjb250cm9scy51cGRhdGUoKTsKCiAgICAgIGlmICh0aGlzLkFuYWx5c2VyICYmIHRoaXMuaXNQbGF5aW5nKSB7CiAgICAgICAgdmFyIGJ1ZmZlckxlbmd0aCA9IHRoaXMuQW5hbHlzZXIuZnJlcXVlbmN5QmluQ291bnQ7CiAgICAgICAgdmFyIGFyciA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlckxlbmd0aCk7CiAgICAgICAgdGhpcy5BbmFseXNlci5nZXRCeXRlRnJlcXVlbmN5RGF0YShhcnIpOyAvL2xldCBhcnI9YW5hbHlzZXIuZ2V0RnJlcXVlbmN5RGF0YSgpOwoKICAgICAgICB2YXIgRGVsdGEgPSB0aGlzLmNsb2NrLmdldERlbHRhKCk7CiAgICAgICAgQmFyTm9kZXMuZm9yRWFjaChmdW5jdGlvbiAobm9kZSwgaW5kZXgsIGFycmF5KSB7CiAgICAgICAgICBub2RlLnN0cmVuZ3RoKGFycltpbmRleCAlIGFycmF5Lmxlbmd0aF0gKiAwLjEpOwogICAgICAgICAgbm9kZS50cmFuc2l0aW9uKERlbHRhKTsKICAgICAgICB9KTsgLy/kuovlrp7kuIphcnLlgLzmnIDlpKcyNTXvvJ/vvJ/vvJ/vvJ/vvJ/vvJ8KCiAgICAgICAgdmFyIHRoYXQgPSB0aGlzOwogICAgICAgIHRoaXMuc2NhbGUgPSAxICsgYXJyW01hdGguY2VpbChhcnIubGVuZ3RoICogMC4wNSldIC8gNTAwOwoKICAgICAgICBpZiAoTGluZUdyb3Vwcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICBMaW5lR3JvdXBzLmZvckVhY2goZnVuY3Rpb24gKG9iaikgewogICAgICAgICAgICB2YXIgc2NhbGVkYXRhID0gbWFwLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgIHJldHVybiBpdGVtLnV1aWQgPT0gb2JqLnV1aWQ7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGF0LnVwZGF0ZUNpcmNsZShvYmosIHNjYWxlZGF0YVswXS54LCBzY2FsZWRhdGFbMF0ueSwgc2NhbGVkYXRhWzBdLnopOwogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoQmFyR3JvdXBzLmxlbmd0aCA+IDApIHsKICAgICAgICAgIEJhckdyb3Vwcy5mb3JFYWNoKGZ1bmN0aW9uIChvYmopIHsKICAgICAgICAgICAgdmFyIHNjYWxlZGF0YSA9IG1hcC5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICByZXR1cm4gaXRlbS51dWlkID09IG9iai51dWlkOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdmFyIEJhckNvbG9yID0gQ29sb3JNYXAuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0udXVpZCA9PSBvYmoudXVpZDsKICAgICAgICAgICAgfSk7IC8vIGNvbnNvbGUubG9nKEJhckNvbG9yWzBdLnIpOwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhCYXJDb2xvclswXS5nKTsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coQmFyQ29sb3JbMF0uYik7CgogICAgICAgICAgICB0aGF0LnVwZGF0ZUJhcnMoYXJyLCBvYmosIHNjYWxlZGF0YVswXS54LCBzY2FsZWRhdGFbMF0ueSwgc2NhbGVkYXRhWzBdLnosIEJhckNvbG9yWzBdLnIsIEJhckNvbG9yWzBdLmcsIEJhckNvbG9yWzBdLmIpOwogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICA7CgogICAgICAgIGlmIChHZW9tZXRyeUdyb3Vwcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICBHZW9tZXRyeUdyb3Vwcy5mb3JFYWNoKGZ1bmN0aW9uIChvYmopIHsKICAgICAgICAgICAgdmFyIHNjYWxlZGF0YSA9IG1hcC5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICByZXR1cm4gaXRlbS51dWlkID09IG9iai51dWlkOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhhdC51cGRhdGVHZW9tZXRyeShvYmosIHNjYWxlZGF0YVswXS54LCBzY2FsZWRhdGFbMF0ueSwgc2NhbGVkYXRhWzBdLnopOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBjb21wb3Nlci5yZW5kZXIoKTsgLy/kvb/nlKjlkI7mnJ/lpITnkIbpgJrpgZPmuLLmn5MKICAgIH0sCiAgICB1cGRhdGVHZW9tZXRyeTogZnVuY3Rpb24gdXBkYXRlR2VvbWV0cnkoR2VvbWV0cnksIHgsIHksIHopIHsKICAgICAgR2VvbWV0cnkuc2NhbGUuc2V0KHRoaXMuc2NhbGUgKiB4LCB0aGlzLnNjYWxlICogeSwgdGhpcy5zY2FsZSAqIHopOwogICAgfSwKICAgIHVwZGF0ZUJhcnM6IGZ1bmN0aW9uIHVwZGF0ZUJhcnMoYXJyLCBiYXJHcm91cCwgeCwgeSwgeiwgciwgZywgYikgewogICAgICBpZiAoYmFyR3JvdXApIHsKICAgICAgICBiYXJHcm91cC5yb3RhdGlvbi56ICs9IDAuMDAyOwogICAgICAgIGJhckdyb3VwLnNjYWxlLnNldCh0aGlzLnNjYWxlICogeCwgdGhpcy5zY2FsZSAqIHksIHRoaXMuc2NhbGUgKiB6KTsKICAgICAgICBiYXJHcm91cC5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtLCBpbmRleCkgewogICAgICAgICAgLy/orrDlvZXnmoTljp9yZ2LlgLzmmK8wLTHnmoTmta7ngrnlgLzvvIzpnIDopoHmoLnmja7popHnjofmlbDlgLzovazmjaIKICAgICAgICAgIGlmIChyID4gMCkgewogICAgICAgICAgICBlbGVtLmNoaWxkcmVuWzBdLm1hdGVyaWFsLmNvbG9yLnIgPSBhcnJbaW5kZXhdICogciAvIDI1NTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZyA+IDApIHsKICAgICAgICAgICAgZWxlbS5jaGlsZHJlblswXS5tYXRlcmlhbC5jb2xvci5nID0gYXJyW2luZGV4XSAqIGcgLyAyNTU7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGIgPiAwKSB7CiAgICAgICAgICAgIGVsZW0uY2hpbGRyZW5bMF0ubWF0ZXJpYWwuY29sb3IuYiA9IGFycltpbmRleF0gKiBiIC8gMjU1OwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChhcnJbaW5kZXhdID09PSAwKSB7CiAgICAgICAgICAgIGVsZW0uc2NhbGUuc2V0KDEsIDEsIDEpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdmFyIG0gPSBhcnJbaW5kZXhdIC8gMjA7CiAgICAgICAgICAgIHZhciB0YXJnZXRSYW5nZSA9IE1hdGgubWF4KGFycltpbmRleF0gLyAyMCAtIGFycltpbmRleCAtIDFdIC8gMjAsIDApOwoKICAgICAgICAgICAgaWYgKG0gPCB0YXJnZXRSYW5nZSkgewogICAgICAgICAgICAgIG0gPSB0YXJnZXRSYW5nZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZWxlbS5zY2FsZS5zZXQoMSwgbSwgMSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBpbml0QmFyczogZnVuY3Rpb24gaW5pdEJhcnMoKSB7CiAgICAgIEJhck5vZGVzID0gcmFuZ2UoMCwgMjU2KS5tYXAoZnVuY3Rpb24gKGluZGV4KSB7CiAgICAgICAgcmV0dXJuIG5ldyBub2RlKDIwLCAoaW5kZXggLyAyNTYgKiAzNjAgKyA0NSkgJSAzNjAsIG5ldyBUSFJFRS5WZWN0b3IyKDAsIDApKTsKICAgICAgfSk7CiAgICB9LAogICAgLy/lkI7mnJ/lpITnkIYKICAgIGluaXRFZmZlY3RDb21wb3NlcjogZnVuY3Rpb24gaW5pdEVmZmVjdENvbXBvc2VyKCkgewogICAgICBjb21wb3NlciA9IG5ldyBFZmZlY3RDb21wb3NlcihyZW5kZXJlcik7CiAgICAgIHZhciByZW5kZXJQYXNzID0gbmV3IFJlbmRlclBhc3Moc2NlbmUsIGNhbWVyYSk7CiAgICAgIGNvbXBvc2VyLmFkZFBhc3MocmVuZGVyUGFzcyk7IC8vUmVuZGVyUGFzc+mAmuW4uOS9jeS6jui/h+eoi+mTvueahOW8gOWni++8jOS7peS+v+Wwhua4suafk+WlveeahOWcuuaZr+S9nOS4uui+k+WFpeadpeaPkOS+m+e7meS4i+S4gOS4quWQjuacn+WkhOeQhuatpemqpOOAggogICAgICAvL0NvcHlTaGFkZXLmmK/kuLrkuobog73lsIbnu5PmnpzovpPlh7rvvIzmma7pgJrnmoTpgJrpgZPkuIDoiKzpg73mmK/kuI3og73ovpPlh7rnmoTvvIzopoHpnaBDb3B5U2hhZGVy6L+b6KGM6L6T5Ye6CgogICAgICB2YXIgY29weVNoYWRlciA9IG5ldyBTaGFkZXJQYXNzKENvcHlTaGFkZXIpOwogICAgICBjb3B5U2hhZGVyLnJlbmRlclRvU2NyZWVuID0gdHJ1ZTsgLy/ov5nkuKrlj4LmlbDnmoTnm67nmoTmmK/pqazkuIrlsIblvZPliY3nmoTlhoXlrrnovpPlh7oKCiAgICAgIHRoaXMuaW5pdEJsb29tUGFzcygpOwogICAgICBjb21wb3Nlci5hZGRQYXNzKGNvcHlTaGFkZXIpOwogICAgfSwKICAgIGluaXRCbG9vbVBhc3M6IGZ1bmN0aW9uIGluaXRCbG9vbVBhc3MoKSB7CiAgICAgIHZhciBwYXJhbXMgPSB7CiAgICAgICAgZXhwb3N1cmU6IDAuNSwKICAgICAgICBibG9vbVN0cmVuZ3RoOiAxLAogICAgICAgIGJsb29tVGhyZXNob2xkOiAwLAogICAgICAgIGJsb29tUmFkaXVzOiAwLjgKICAgICAgfTsKICAgICAgdmFyIGJsb29tUGFzcyA9IG5ldyBVbnJlYWxCbG9vbVBhc3MobmV3IFRIUkVFLlZlY3RvcjIod2luZG93LmlubmVyV2lkdGggKiAwLjg1LCB3aW5kb3cuaW5uZXJIZWlnaHQgKiAwLjg1KSwgMS41LCAwLjIsIDApOwogICAgICBibG9vbVBhc3MudGhyZXNob2xkID0gcGFyYW1zLmJsb29tVGhyZXNob2xkOwogICAgICBibG9vbVBhc3Muc3RyZW5ndGggPSBwYXJhbXMuYmxvb21TdHJlbmd0aDsKICAgICAgYmxvb21QYXNzLnJhZGl1cyA9IHBhcmFtcy5ibG9vbVJhZGl1czsKICAgICAgY29tcG9zZXIuYWRkUGFzcyhibG9vbVBhc3MpOwogICAgfQogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHRoaXMuaW5pdCgpOwogICAgdGhpcy5HZXRBdWRpb0RhdGEoKTsKICAgIHRoaXMuR2V0U3RhdGUoKTsKICB9Cn07"},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiBA;AACA;AACA;AACA,yD,CACA;;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uE,CACA;;AACA;AACAA,OADA;AAEAC,OAFA;AAGAC,QAHA;AAIAC,4BAJA;AAKAC,8BALA;AAMAC,qBANA;AAOAC;AAPA;AASA,oB,CAAA;;AACA,a,CAAA;;AACA,a,CAAA;;AACA;AAAA,IACAC,aADA;AAEA;AACA;AACA;AACA;AACA;AACA;AACAC,eADA;AAEAC;AACAC;AADA,GAFA;AAKAC,MALA,kBAKA;AACA;AACAC,8BADA;AAEAC,cAFA;AAGAC,oBAHA;AAIAC,sBAJA;AAKAC;AALA;AAOA,GAbA;AAcAC;AACAD;AACAE,aADA,qBACA;AACA;AACA;AACA;AACA;AACA,oCAJA,CAKA;AACA;;AACA;AACA;AACA;AAXA;AADA,GAdA;AA6BAC;AACAC,UADA,oBACA;AACA,4BADA,CAEA;;AACA;AACA;AACAC;AACAA;AACA;;AACA;AACA;;AACA;AAAA;AACAC;AACA,WAFA,MAEA;AAAA;AACAA;AACA,WAFA,MAEA;AAAA;AACAA;AACA,WARA,CASA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACAC,2BACA;AACA;AACAC;AACAC;AAEA,WANA,EAOA;AACA;AACAC;AACA,WAVA,EAYA;AACA;AACAA;AACA,WAfA,EAnBA,CAoCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAjDA;AAkDAL;AACA,KA1DA;AA2DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAM,YA5FA,sBA4FA;AAAA;;AACA;AACA;AACA,OAFA;AAGA,KAhGA;AAiGAC,gBAjGA,0BAiGA;AACA;AACA;AACAH;AAEA,OAHA;AAIA,KAvGA;AAwGAI,aAxGA,uBAwGA;AACA;AACAC;AACA,KA3GA;AA4GAC,gBA5GA,0BA4GA;AAGA;AACAP;AACA;AACAQ;AACAC;AACAC,0BADA;AAEAC,0BAFA;AAGAC,0BAHA;AAIAC;AAJA;AAOA,SATA,MASA;AACAC;AACAL;AACAC,0BADA;AAEAC,0BAFA;AAGAC,0BAHA;AAIAC;AAJA,aAFA,CAQA;;AACAE;AACAL,0BADA;AAEAM,2DAFA;AAGAC,2DAHA;AAIAC;AAJA;AAMAhB;AACAA;AAEA,SAlBA,MAkBA;AACA;AACAiB;AACAV;AACAC,0BADA;AAEAC,0BAFA;AAGAC,0BAHA;AAIAC;AAJA;AAOAX;AAEA;AACA,OAzCA;AA0CA,KA1JA;AA2JAkB,gBA3JA,wBA2JAC,UA3JA,EA2JAV,CA3JA,EA2JAC,CA3JA,EA2JAC,CA3JA,EA2JA;AACA;AAEAQ;AAEA,wDAJA,CAKA;;AACA;AACA,wDAPA,CAQA;;AACA;AAEA;AACA;AACA,SAFA;AAGAC;AACAC;AACAC,oEAFA,CAGA;;AACA;AACA;AACAC,wBACA,kEADA,EAEA,CAFA;AAIAA;AACA,SAXA;AAYAF,uBACA,0CADA,EAEAD,oBAFA;AAIAE,uBACA,0CADA,EAEAF,oBAFA;AAIAC;AACAC;AACA;AACA,KAjMA;AAmMAE,QAnMA,kBAmMA;AACA;AACA;AACA;AACA;AAEA,uBANA,CAOA;;AACA,uBARA,CASA;AACA;AAEA,KA/MA;AAgNAC,gBAhNA,0BAgNA;AACAC,gEADA,CAEA;AACA;AACA;;AACAA,oCALA,CAMA;AACA;AACA;;AACAA,kCATA,CAUA;;AACAA,uCAXA,CAYA;;AACAA,+BAbA,CAcA;;AACAA,iCAfA,CAgBA;;AACAA;AACA,KAlOA;AAmOAC,aAnOA,uBAmOA;AACA7B;AACA;AACA8B,sCAHA,CAIA;;AACAA;AACA9B;AACA,KA1OA;AA2OA+B,aA3OA,uBA2OA;AACAC;AACAA,mDAFA,CAEA;;AACAA,0CAHA,CAGA;;AACAA;AACAC;AAEA,KAlPA;AAmPA;AACA;AACA;AACA;AACAC,gBAvPA,0BAuPA;AAGAC;AAAAC;AAAA,SAHA,CAGA;;AACAD,4EAJA,CAIA;;AACAF,wEALA,CAKA;AACA,KA7PA;AA8PA;AACAI,aA/PA,uBA+PA;AAEArC,gCAFA,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,KA3QA;AA4QA;AACAsC,cA7QA,wBA6QA;AACAC,iGADA,CAEA;;AACAA;AACA,KAjRA;AAkRA;AAGA;AACAC,WAtRA,qBAsRA;AACAC,0CADA,CACA;AAEA;AACA;AACA;AACA;AACA;;AAEAT;AACAJ;;AACA;AACA;AACA;AACA,gDAHA,CAIA;;AACA;AACAc;AACAC;AACAA;AAEA,SAJA,EANA,CAWA;;AACA;AACA;;AACA;AACAnC;AACA;AAAA;AAAA;AAEAP;AACA,WAJA;AAKA;;AACA;AACAa;AAEA;AAAA;AAAA;AACA;AAAA;AAAA,eAHA,CAIA;AACA;AACA;;AACAb,sFACA2C,aADA,EACAA,aADA,EACAA,aADA;AAEA,WATA;AAUA;;AAAA;;AACA;AACAzB;AACA;AAAA;AAAA;AACAlB;AAEA,WAJA;AAKA;AAGA;;AACA4C,wBAtDA,CAsDA;AACA,KA7UA;AA8UAC,kBA9UA,0BA8UAC,QA9UA,EA8UApC,CA9UA,EA8UAC,CA9UA,EA8UAC,CA9UA,EA8UA;AACAkC;AACA,KAhVA;AAiVAC,cAjVA,sBAiVAC,GAjVA,EAiVAC,QAjVA,EAiVAvC,CAjVA,EAiVAC,CAjVA,EAiVAC,CAjVA,EAiVAG,CAjVA,EAiVAC,CAjVA,EAiVAC,CAjVA,EAiVA;AACA;AACAgC;AACAA;AACAA;AACA;AACA;AACAC;AAEA;;AACA;AACAA;AACA;;AAEA;AACAA;AACA;;AAEA;AACAA;AACA,WAFA,MAEA;AACA;AACA,uCACAF,qCADA,EACA,CADA;;AAEA;AACAG;AACA;;AAEAD;AACA;AAEA,SA3BA;AA4BA;AACA,KAlXA;AAmXAE,YAnXA,sBAmXA;AACAX;AACA,wBACA,EADA,EAEA,8BAFA,EAGA,uBAHA;AAKA,OANA;AAOA,KA3XA;AA4XA;AACAY,sBA7XA,gCA6XA;AACAT;AACA;AACAA,mCAHA,CAIA;AACA;;AACA;AACAU,uCAPA,CAQA;;AACA;AACAV;AACA,KAxYA;AAyYAW,iBAzYA,2BAyYA;AACA;AACAC,qBADA;AAEAC,wBAFA;AAGAC,yBAHA;AAIAC;AAJA;AAMA,0CACA,sEADA,EAEA,GAFA,EAGA,GAHA,EAIA,CAJA;AAMAC;AACAA;AACAA;AACAhB;AAEA;AA3ZA,GA7BA;AA2bAiB,SA3bA,qBA2bA;AACA;AACA;AACA;AAEA;AAhcA","names":["R","G","B","TrianglesBgColor","TrianglesLineColor","lineColor","rotate","TriangleGroup","name","components","AudioPlayer","data","clock","scale","Analyser","isPlaying","isLoaded","watch","handler","methods","Import","input","url","loader","scene","that","console","GetState","GetAudioData","initAudio","audio","AnalysisLine","LineGroups","map","uuid","x","y","z","BarGroups","ColorMap","r","g","b","GeometryGroups","updateCircle","linesGroup","positions","AttributeA","AttributeB","Attribute","init","initControls","controls","initLight","light","initStats","stats","document","initRenderer","renderer","antialias","initScene","initCamera","camera","animate","requestAnimationFrame","BarNodes","node","BarColor","composer","updateGeometry","Geometry","updateBars","arr","barGroup","elem","m","initBars","initEffectComposer","copyShader","initBloomPass","exposure","bloomStrength","bloomThreshold","bloomRadius","bloomPass","mounted"],"sourceRoot":"src/views/scene","sources":["Scene.vue"],"sourcesContent":["<template>\r\n   <div class=\"app-container-play\">\r\n\r\n     <el-button @click=\"Import\" type=\"primary\" style=\"margin-left: 16px;\">\r\n        导入\r\n    </el-button>\r\n    <AudioPlayer/>\r\n     <!-- <div class=\"file-select-btn\" @click=\"$refs.fileId.click()\">\r\n      选择音乐\r\n      <input ref=\"fileId\" type=\"file\" class=\"file-input\" @change=\"getAudio\" />\r\n     </div> -->\r\n     <div id=\"webgl\" style=\"position:relative\"></div>\r\n     \r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as THREE from 'three/build/three.module.js'\r\nimport Stats from '../../store/Stats/stats.min.js'\r\nimport { OrbitControls } from \"../../lib/OrbitControls.js\";\r\nimport index, { GUI } from \"../../lib/dat.gui.module.js\";\r\n//辉光\r\nimport { EffectComposer } from \"three/examples/jsm/postprocessing/EffectComposer.js\";\r\nimport { RenderPass } from \"three/examples/jsm/postprocessing/RenderPass.js\";\r\nimport { GlitchPass } from 'three/examples/jsm/postprocessing/GlitchPass.js';\r\nimport { UnrealBloomPass } from \"three/examples/jsm/postprocessing/UnrealBloomPass.js\";\r\n\r\nimport { ShaderPass } from \"three/examples/jsm/postprocessing/ShaderPass.js\";\r\nimport { CopyShader } from \"three/examples/jsm/shaders/CopyShader.js\";\r\nimport { range } from \"../../components/mode/range\";\r\nimport { node } from \"../../components/mode/node\";\r\nimport AudioPlayer from \"../scene/Player/Player.vue\"\r\nimport { randomRange } from \"../../components/mode/randomRange\";\r\nimport { Triangle } from \"../../components/mode/Triangle\";\r\nimport { Loader } from '../../lib/three.module.js';\r\nlet renderer,camera,scene,geometry,material,mesh,stats,controls;\r\n//  let container=document.getElementById('webgl');\r\nlet gui = {\r\n  R: 20,\r\n  G: 90,\r\n  B: 225,\r\n  TrianglesBgColor: 0x03a9f4,\r\n  TrianglesLineColor: 0x03a9f4,\r\n  lineColor: 0x00ffff,\r\n  rotate: false\r\n};\r\nlet audio, analyser; // 音频\r\nlet BarNodes; // 线\r\nlet composer;//合成器\r\nlet Triangles = [],\r\n  TriangleGroup;\r\nlet LineGroups=[];\r\nlet BarGroups=[];\r\nlet GeometryGroups=[];\r\nlet map=[];\r\nlet ColorMap=[];\r\nexport default {\r\n    name: 'Scene',\r\n    components:{\r\n      AudioPlayer\r\n    },\r\n    data() {\r\n      return {\r\n        clock:new THREE.Clock(),\r\n        scale:1,\r\n        Analyser:null,\r\n        isPlaying:false,\r\n        isLoaded:false,\r\n      }\r\n    },\r\n    watch:{\r\n      isLoaded:{\r\n        handler(){\r\n          if(this.isLoaded==true){\r\n             this.initLight();\r\n              this.AnalysisLine();\r\n              this.initBars();\r\n              this.initEffectComposer();\r\n              //that.initStats();\r\n            // initDatGUI();\r\n            this.animate();\r\n          }\r\n        }\r\n      }\r\n    },\r\n    methods: {\r\n      Import(){\r\n        this.isLoaded=false;\r\n        //每次导入改变值然后重新渲染\r\n        let that=this;\r\n        let input=document.createElement('input');\r\n        input.type=\"file\";\r\n        input.addEventListener(\"change\",function(){\r\n          let file=input.files[0];\r\n          if(file.type.indexOf(\"json\")>=0){\r\n            let url = null ;\r\n            if (window.createObjectURL!=undefined) { // basic\r\n                url = window.createObjectURL(file) ;\r\n            } else if (window.URL!=undefined) { // mozilla(firefox)\r\n                url = window.URL.createObjectURL(file) ;\r\n            } else if (window.webkitURL!=undefined) { // webkit or chrome\r\n                url = window.webkitURL.createObjectURL(file) ;\r\n            }\r\n            //根据url进行加载回调，可以防止\r\n        //     let reader=new FileReader();\r\n        //     //reader.readAsText(file);\r\n        //     reader.readAsDataURL(file);\r\n        // reader.onloadend = function(e) {\r\n        //   _that.audioLoad(e.target.result);\r\n        // };\r\n            \r\n\r\n             let loader=new THREE.ObjectLoader();\r\n             loader.load(url,\r\n              function(obj){\r\n                //加载完成后进行\r\n                scene=obj;\r\n                that.isLoaded=true;\r\n             \r\n              },\r\n              // onProgress callback\r\n\t            function ( xhr ) {\r\n\t\t          console.log( (xhr.loaded / xhr.total * 100) + '% loaded' );\r\n\t            },\r\n\r\n\t          // onError callback\r\n\t            function ( err ) {\r\n\t\t              console.error( 'An error happened'+err );\r\n              });\r\n\r\n            // let reader=new FileReader();\r\n            // reader.readAsText(file);\r\n            // reader.onloadend=function(){\r\n            //   let loader=new THREE.ObjectLoader();\r\n            //   loader.parse(JSON.parse(this.result),\r\n            //     function(obj){\r\n            //       scene=obj;\r\n            //     }\r\n            //   );\r\n              //scene=newscene;\r\n          }\r\n        });\r\n        input.click();\r\n      },\r\n      // 选择音频\r\n    // getAudio() {\r\n    //   let _that = this;\r\n    //   let objFile = this.$refs.fileId;\r\n    //   if (objFile.value === \"\") {\r\n    //     return false;\r\n    //   }\r\n    //   if (window.FileReader) {\r\n    //     let reader = new FileReader();\r\n    //     reader.readAsDataURL(objFile.files[0]);\r\n    //     reader.onloadend = function(e) {\r\n    //       _that.audioLoad(e.target.result);\r\n    //     };\r\n    //   }\r\n    // },\r\n    //  音频加载播放\r\n    // audioLoad(url) {\r\n    //   // let _that = this;\r\n\r\n    //   let audioLoader = new THREE.AudioLoader(); // 音频加载器\r\n    //   audioLoader.load(url, function(AudioBuffer) {\r\n    //     if (audio.isPlaying) {\r\n    //       audio.stop();\r\n    //       audio.setBuffer();\r\n    //     }\r\n    //     audio.setBuffer(AudioBuffer); // 音频缓冲区对象关联到音频对象audio\r\n    //     audio.setLoop(true); //是否循环\r\n    //     audio.setVolume(1); //音量\r\n    //     audio.play(); //播放\r\n    //     // 音频分析器和音频绑定，可以实时采集音频时域数据进行快速傅里叶变换\r\n    //     analyser = new THREE.AudioAnalyser(audio, 256 * 2);\r\n    //   });\r\n    // },\r\n    GetState(){\r\n      this.$bus.$on('PlayState',(isPlaying)=>{\r\n          this.isPlaying=isPlaying;\r\n      })\r\n    },\r\n    GetAudioData(){\r\n      let that=this;\r\n        this.$bus.$on('BindingAnalyser',(analyser)=>{\r\n          that.Analyser=analyser;\r\n        \r\n        })\r\n    },\r\n    initAudio(){\r\n      let listener=new THREE.AudioListener();\r\n      audio=new THREE.Audio(listener);\r\n    },\r\n      AnalysisLine(){\r\n       \r\n        \r\n        //获取变化线段\r\n        scene.traverse(function(obj){\r\n          if(obj.name.indexOf(\"音频线\")!=-1){\r\n            LineGroups.push(obj);\r\n            map.push({\r\n              uuid:obj.uuid,\r\n              x:obj.scale.x,\r\n              y:obj.scale.y,\r\n              z:obj.scale.z\r\n            });\r\n\r\n          }else if(obj.name.indexOf(\"音频谱\")!=-1){\r\n            BarGroups.push(obj);\r\n            map.push({\r\n              uuid:obj.uuid,\r\n              x:obj.scale.x,\r\n              y:obj.scale.y,\r\n              z:obj.scale.z\r\n            });\r\n           // console.log(obj.children[0].children[0]);\r\n            ColorMap.push({\r\n              uuid:obj.uuid,\r\n              r:obj.children[0].children[0].material.color.r,\r\n              g:obj.children[0].children[0].material.color.g,\r\n              b:obj.children[0].children[0].material.color.b,\r\n            });\r\n            console.log(obj.children[0].children[0].material.color);\r\n            console.log(ColorMap);\r\n\r\n          }else if(obj.type.indexOf('Mesh')!=-1&&obj.parent==scene){\r\n            //几何体\r\n            GeometryGroups.push(obj);\r\n            map.push({\r\n              uuid:obj.uuid,\r\n              x:obj.scale.x,\r\n              y:obj.scale.y,\r\n              z:obj.scale.z\r\n\r\n            });\r\n            console.log(GeometryGroups);\r\n\r\n          }\r\n        });\r\n      },\r\n       updateCircle(linesGroup,x,y,z) {\r\n      if (BarNodes) {\r\n        \r\n        linesGroup.scale.set(this.scale*x,this.scale*y,this.scale*z);\r\n        \r\n        const geometryA = linesGroup.children[0].geometry;\r\n        //outline\r\n        const AttributeA = geometryA.getAttribute(\"position\");\r\n        const geometryB = linesGroup.children[1].geometry;\r\n        //inline\r\n        const AttributeB = geometryB.getAttribute(\"position\");\r\n\r\n        const positions = BarNodes.map(value => {\r\n          return [value.positionA(), value.positionB()];\r\n        });\r\n        positions.forEach((position, index) => {\r\n          AttributeA.set([position[0].x, position[0].y], index * 3);\r\n          AttributeB.set([position[1].x, position[1].y], index * 3);\r\n          //前两线是outline和inline\r\n          const geometry = linesGroup.children[index+2].geometry;\r\n          const Attribute = geometry.getAttribute(\"position\");\r\n          Attribute.set(\r\n            [position[0].x, position[0].y, 0, position[1].x, position[1].y, 0],\r\n            0\r\n          );\r\n          Attribute.needsUpdate = true;\r\n        });\r\n        AttributeA.set(\r\n          [AttributeA.array[0], AttributeA.array[1]],\r\n          positions.length * 3\r\n        );\r\n        AttributeB.set(\r\n          [AttributeB.array[0], AttributeB.array[1]],\r\n          positions.length * 3\r\n        );\r\n        AttributeA.needsUpdate = true;\r\n        AttributeB.needsUpdate = true;\r\n      }\r\n    },\r\n\r\n        init(){\r\n            this.initRenderer();\r\n            this.initScene();\r\n            this.initCamera();\r\n            this.initControls();\r\n            \r\n            this.initAudio();\r\n            //this.initEffectComposer();\r\n            this.initStats();\r\n            // initDatGUI();\r\n            //this.animate();\r\n            \r\n        },\r\n        initControls() {\r\n          controls = new OrbitControls(camera, renderer.domElement);\r\n         // 如果使用animate方法时，将此函数删除\r\n         //controls.addEventListener( 'change', render );\r\n          // 使动画循环使用时阻尼或自转 意思是否有惯性\r\n          controls.enableDamping = true;\r\n          //动态阻尼系数 就是鼠标拖拽旋转灵敏度\r\n         //controls.dampingFactor = 0.25;\r\n          //是否可以缩放\r\n          controls.enableZoom = false;\r\n          //是否自动旋转\r\n          controls.autoRotate = gui.rotate;\r\n          //设置相机距离原点的最远距离\r\n          controls.minDistance = 1;\r\n          //设置相机距离原点的最远距离\r\n          controls.maxDistance = 200;\r\n          //是否开启右键拖拽\r\n          controls.enablePan = false;\r\n        },\r\n        initLight() {\r\n          scene.add(new THREE.AmbientLight(0x444444));\r\n          let light = new THREE.PointLight(0xffffff);\r\n          light.position.set(80, 100, 50);\r\n          //告诉平行光需要开启阴影投射\r\n          light.castShadow = true;\r\n          scene.add(light);\r\n        },\r\n        initStats(){\r\n             stats = new Stats();\r\n             stats.domElement.style.position = 'absolute'; //绝对坐标  \r\n             stats.domElement.style.left = '0px';// (0,0)px,左上角  \r\n             stats.domElement.style.top = '0px';  \r\n            document.getElementById('webgl').appendChild(stats.domElement);\r\n\r\n        },\r\n        // updatePosition(){\r\n        //     mesh.position.set(controls.positionX,controls.positionY,controls.positionZ);\r\n        // },\r\n        //初始化渲染器\r\n        initRenderer(){\r\n            \r\n            \r\n            renderer=new THREE.WebGLRenderer({ antialias: true });//实例化渲染器\r\n            renderer.setSize(window.innerWidth*0.85,window.innerHeight*0.85);//设置宽高\r\n            document.getElementById('webgl').appendChild(renderer.domElement);//添加到dom\r\n        },\r\n        //初始化场景\r\n        initScene(){\r\n            \r\n            scene=new THREE.Scene();//实例化场景\r\n        //     scene.background = new THREE.CubeTextureLoader().load([\r\n        //   require('@/assets/skybox/right.jpg'),\r\n        //   require('@/assets/skybox/left.jpg'),\r\n        //   require('@/assets/skybox/top.jpg'),\r\n        //   require('@/assets/skybox/bottom.jpg'),\r\n        //   require('@/assets/skybox/front.jpg'),\r\n        //   require('@/assets/skybox/back.jpg')\r\n        // ]);\r\n\r\n        },\r\n        //初始化相机\r\n        initCamera(){\r\n            camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,0.1,200)\r\n            //实例化相机】\r\n            camera.position.set(0,0,150);\r\n        },\r\n        //创建模型\r\n\r\n\r\n        //运行动画\r\n        animate(){\r\n            requestAnimationFrame(this.animate);//循环调用函数\r\n\r\n            // mesh.rotation.x+=0.01;\r\n            // // //每帧网格模型沿x轴旋转0.01弧度\r\n            // mesh.rotation.y+=0.02;\r\n            // //每帧网格模型沿y轴旋转0.02弧度\r\n            // //stats.update();//更新性能检测框\r\n\r\n            stats.update();\r\n            controls.update();\r\n            if(this.Analyser&&this.isPlaying){\r\n              let bufferLength=this.Analyser.frequencyBinCount;\r\n              let arr=new Uint8Array(bufferLength);\r\n              this.Analyser.getByteFrequencyData(arr);\r\n              //let arr=analyser.getFrequencyData();\r\n              const Delta=this.clock.getDelta();\r\n              BarNodes.forEach((node,index,array)=>{\r\n                node.strength(arr[index % array.length]*0.1);\r\n                node.transition(Delta);\r\n               \r\n              });\r\n              //事实上arr值最大255？？？？？？\r\n              let that=this;\r\n               this.scale=1+arr[Math.ceil(arr.length*0.05)]/500;\r\n               if(LineGroups.length>0){\r\n                  LineGroups.forEach(function(obj){\r\n                    const scaledata=map.filter((item)=>item.uuid==obj.uuid);\r\n                   \r\n                    that.updateCircle(obj,scaledata[0].x,scaledata[0].y,scaledata[0].z);\r\n                });\r\n               }\r\n               if(BarGroups.length>0){\r\n                 BarGroups.forEach(function(obj){\r\n                  \r\n                    const scaledata=map.filter((item)=>item.uuid==obj.uuid);\r\n                    const BarColor=ColorMap.filter((item)=>item.uuid==obj.uuid);\r\n                    // console.log(BarColor[0].r);\r\n                    // console.log(BarColor[0].g);\r\n                    // console.log(BarColor[0].b);\r\n                    that.updateBars(arr,obj,scaledata[0].x,scaledata[0].y,scaledata[0].z,\r\n                                   BarColor[0].r,BarColor[0].g,BarColor[0].b);\r\n                 });\r\n               };\r\n               if(GeometryGroups.length>0){\r\n                 GeometryGroups.forEach(function (obj){\r\n                   const scaledata=map.filter((item)=>item.uuid==obj.uuid);\r\n                   that.updateGeometry(obj,scaledata[0].x,scaledata[0].y,scaledata[0].z);\r\n\r\n                 });\r\n               }\r\n               \r\n\r\n            }\r\n            composer.render();//使用后期处理通道渲染\r\n        },\r\n        updateGeometry(Geometry,x,y,z){\r\n            Geometry.scale.set(this.scale*x,this.scale*y,this.scale*z);\r\n        },\r\n        updateBars(arr,barGroup,x,y,z,r,g,b){\r\n           if(barGroup){\r\n              barGroup.rotation.z += 0.002;\r\n              barGroup.scale.set(this.scale*x, this.scale*y, this.scale*z);\r\n              barGroup.children.forEach((elem,index)=>{\r\n                //记录的原rgb值是0-1的浮点值，需要根据频率数值转换\r\n                if(r>0){\r\n                   elem.children[0].material.color.r= arr[index] *r/ 255;\r\n\r\n                }\r\n               if(g>0){\r\n                  elem.children[0].material.color.g=arr[index]*g/255;\r\n               }\r\n                \r\n                if(b>0){\r\n                  elem.children[0].material.color.b=arr[index]*b/255;\r\n                }\r\n               \r\n                if(arr[index]===0){\r\n                  elem.scale.set(1,1,1);\r\n                }else{\r\n                   let m = arr[index] / 20;\r\n                   let targetRange = Math.max(\r\n                  arr[index] / 20 - arr[index - 1] / 20,0);\r\n              if (m < targetRange) {\r\n                m = targetRange;\r\n              }\r\n\r\n              elem.scale.set(1, m, 1);\r\n                }\r\n\r\n              });\r\n           }\r\n        },\r\n        initBars(){\r\n          BarNodes=range(0, 256).map(index => {\r\n            return new node(\r\n              20,\r\n              ((index / 256) * 360 + 45) % 360,\r\n              new THREE.Vector2(0, 0)\r\n            );\r\n          });\r\n        },\r\n        //后期处理\r\n        initEffectComposer(){\r\n            composer=new EffectComposer(renderer);\r\n            var renderPass=new RenderPass(scene,camera);\r\n            composer.addPass(renderPass);\r\n            //RenderPass通常位于过程链的开始，以便将渲染好的场景作为输入来提供给下一个后期处理步骤。\r\n            //CopyShader是为了能将结果输出，普通的通道一般都是不能输出的，要靠CopyShader进行输出\r\n             const copyShader = new ShaderPass(CopyShader);\r\n            copyShader.renderToScreen = true;\r\n            //这个参数的目的是马上将当前的内容输出\r\n            this.initBloomPass();\r\n            composer.addPass(copyShader);\r\n        },\r\n        initBloomPass(){\r\n          let params = {\r\n            exposure: 0.5,\r\n            bloomStrength: 1,\r\n             bloomThreshold: 0,\r\n            bloomRadius: 0.8\r\n          };\r\n          let bloomPass=new UnrealBloomPass(\r\n            new THREE.Vector2(window.innerWidth*0.85,window.innerHeight*0.85),\r\n              1.5,\r\n              0.2,\r\n              0\r\n          );\r\n          bloomPass.threshold = params.bloomThreshold;\r\n          bloomPass.strength = params.bloomStrength;\r\n          bloomPass.radius = params.bloomRadius;\r\n          composer.addPass(bloomPass);\r\n\r\n        }\r\n\r\n    },\r\n    mounted() {\r\n        this.init();\r\n        this.GetAudioData();\r\n        this.GetState();\r\n        \r\n    },\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>"]}]}