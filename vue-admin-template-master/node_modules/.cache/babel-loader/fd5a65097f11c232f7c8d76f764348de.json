{"remainingRequest":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\node_modules\\babel-loader\\lib\\index.js!E:\\wuhanligong-java\\music\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\wuhanligong-java\\music\\vue-admin-template-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\wuhanligong-java\\music\\vue-admin-template-master\\src\\views\\scene\\Scene.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\src\\views\\scene\\Scene.vue","mtime":1654964129751},{"path":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\babel.config.js","mtime":1637248914000},{"path":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnVybC1zZWFyY2gtcGFyYW1zLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS1idWZmZXIuc2xpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS51aW50OC1hcnJheS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmNvcHktd2l0aGluLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZXZlcnkuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maWxsLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZpbmQtaW5kZXguanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuaW5kZXgtb2YuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmpvaW4uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5sYXN0LWluZGV4LW9mLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmVkdWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmVkdWNlLXJpZ2h0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmV2ZXJzZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNldC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc29tZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNvcnQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zdWJhcnJheS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnRvLWxvY2FsZS1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5qc29uLnN0cmluZ2lmeS5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCAqIGFzIFRIUkVFIGZyb20gJ3RocmVlL2J1aWxkL3RocmVlLm1vZHVsZS5qcyc7CmltcG9ydCBTdGF0cyBmcm9tICcuLi8uLi9zdG9yZS9TdGF0cy9zdGF0cy5taW4uanMnOwppbXBvcnQgeyBPcmJpdENvbnRyb2xzIH0gZnJvbSAiLi4vLi4vbGliL09yYml0Q29udHJvbHMuanMiOwppbXBvcnQgaW5kZXgsIHsgR1VJIH0gZnJvbSAiLi4vLi4vbGliL2RhdC5ndWkubW9kdWxlLmpzIjsgLy/ovonlhYkKCmltcG9ydCB7IEVmZmVjdENvbXBvc2VyIH0gZnJvbSAidGhyZWUvZXhhbXBsZXMvanNtL3Bvc3Rwcm9jZXNzaW5nL0VmZmVjdENvbXBvc2VyLmpzIjsKaW1wb3J0IHsgUmVuZGVyUGFzcyB9IGZyb20gInRocmVlL2V4YW1wbGVzL2pzbS9wb3N0cHJvY2Vzc2luZy9SZW5kZXJQYXNzLmpzIjsKaW1wb3J0IHsgR2xpdGNoUGFzcyB9IGZyb20gJ3RocmVlL2V4YW1wbGVzL2pzbS9wb3N0cHJvY2Vzc2luZy9HbGl0Y2hQYXNzLmpzJzsKaW1wb3J0IHsgVW5yZWFsQmxvb21QYXNzIH0gZnJvbSAidGhyZWUvZXhhbXBsZXMvanNtL3Bvc3Rwcm9jZXNzaW5nL1VucmVhbEJsb29tUGFzcy5qcyI7CmltcG9ydCB7IFNoYWRlclBhc3MgfSBmcm9tICJ0aHJlZS9leGFtcGxlcy9qc20vcG9zdHByb2Nlc3NpbmcvU2hhZGVyUGFzcy5qcyI7CmltcG9ydCB7IENvcHlTaGFkZXIgfSBmcm9tICJ0aHJlZS9leGFtcGxlcy9qc20vc2hhZGVycy9Db3B5U2hhZGVyLmpzIjsKaW1wb3J0IHsgcmFuZ2UgfSBmcm9tICIuLi8uLi9jb21wb25lbnRzL21vZGUvcmFuZ2UiOwppbXBvcnQgeyBub2RlIH0gZnJvbSAiLi4vLi4vY29tcG9uZW50cy9tb2RlL25vZGUiOwppbXBvcnQgQXVkaW9QbGF5ZXIgZnJvbSAiLi4vc2NlbmUvUGxheWVyL1BsYXllci52dWUiOwppbXBvcnQgeyByYW5kb21SYW5nZSB9IGZyb20gIi4uLy4uL2NvbXBvbmVudHMvbW9kZS9yYW5kb21SYW5nZSI7CmltcG9ydCB7IFRyaWFuZ2xlIH0gZnJvbSAiLi4vLi4vY29tcG9uZW50cy9tb2RlL1RyaWFuZ2xlIjsKaW1wb3J0IHsgTG9hZGVyIH0gZnJvbSAnLi4vLi4vbGliL3RocmVlLm1vZHVsZS5qcyc7CnZhciByZW5kZXJlciwgY2FtZXJhLCBzY2VuZSwgZ2VvbWV0cnksIG1hdGVyaWFsLCBtZXNoLCBzdGF0cywgY29udHJvbHM7IC8vICBsZXQgY29udGFpbmVyPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3ZWJnbCcpOwoKdmFyIGd1aSA9IHsKICBSOiAyMCwKICBHOiA5MCwKICBCOiAyMjUsCiAgVHJpYW5nbGVzQmdDb2xvcjogMHgwM2E5ZjQsCiAgVHJpYW5nbGVzTGluZUNvbG9yOiAweDAzYTlmNCwKICBsaW5lQ29sb3I6IDB4MDBmZmZmLAogIHJvdGF0ZTogZmFsc2UKfTsKdmFyIGF1ZGlvLCBhbmFseXNlcjsgLy8g6Z+z6aKRCgp2YXIgQmFyTm9kZXM7IC8vIOe6vwoKdmFyIGNvbXBvc2VyOyAvL+WQiOaIkOWZqAoKdmFyIFRyaWFuZ2xlcyA9IFtdLAogICAgVHJpYW5nbGVHcm91cDsKdmFyIExpbmVHcm91cHMgPSBbXTsKdmFyIEJhckdyb3VwcyA9IFtdOwp2YXIgR2VvbWV0cnlHcm91cHMgPSBbXTsKdmFyIG1hcCA9IFtdOwp2YXIgQ29sb3JNYXAgPSBbXTsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdTY2VuZScsCiAgY29tcG9uZW50czogewogICAgQXVkaW9QbGF5ZXI6IEF1ZGlvUGxheWVyCiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY2xvY2s6IG5ldyBUSFJFRS5DbG9jaygpLAogICAgICBzY2FsZTogMSwKICAgICAgQW5hbHlzZXI6IG51bGwsCiAgICAgIGlzUGxheWluZzogZmFsc2UsCiAgICAgIGlzTG9hZGVkOiBmYWxzZQogICAgfTsKICB9LAogIHdhdGNoOiB7CiAgICBpc0xvYWRlZDogewogICAgICBoYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGVyKCkgewogICAgICAgIGlmICh0aGlzLmlzTG9hZGVkID09IHRydWUpIHsKICAgICAgICAgIHRoaXMuaW5pdExpZ2h0KCk7CiAgICAgICAgICB0aGlzLkFuYWx5c2lzTGluZSgpOwogICAgICAgICAgdGhpcy5pbml0QmFycygpOwogICAgICAgICAgdGhpcy5pbml0RWZmZWN0Q29tcG9zZXIoKTsgLy90aGF0LmluaXRTdGF0cygpOwogICAgICAgICAgLy8gaW5pdERhdEdVSSgpOwoKICAgICAgICAgIHRoaXMuYW5pbWF0ZSgpOwogICAgICAgIH0KICAgICAgfQogICAgfSAvLyAkcm91dGU6ewogICAgLy8gICBoYW5kbGVyKCl7CiAgICAvLyAgICAgdGhpcy4KICAgIC8vICAgfQogICAgLy8gfQoKICB9LAogIG1ldGhvZHM6IHsKICAgIEltcG9ydDogZnVuY3Rpb24gSW1wb3J0KCkgewogICAgICB0aGlzLmlzTG9hZGVkID0gZmFsc2U7IC8v5q+P5qyh5a+85YWl5pS55Y+Y5YC854S25ZCO6YeN5paw5riy5p+TCgogICAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICAgIHZhciBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7CiAgICAgIGlucHV0LnR5cGUgPSAiZmlsZSI7CiAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsIGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgZmlsZSA9IGlucHV0LmZpbGVzWzBdOwogICAgICAgIGNvbnNvbGUubG9nKGZpbGUpOwoKICAgICAgICBpZiAoZmlsZS50eXBlLmluZGV4T2YoImpzb24iKSA+PSAwKSB7CiAgICAgICAgICB2YXIgdXJsID0gbnVsbDsKCiAgICAgICAgICBpZiAod2luZG93LmNyZWF0ZU9iamVjdFVSTCAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgLy8gYmFzaWMKICAgICAgICAgICAgdXJsID0gd2luZG93LmNyZWF0ZU9iamVjdFVSTChmaWxlKTsKICAgICAgICAgIH0gZWxzZSBpZiAod2luZG93LlVSTCAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgLy8gbW96aWxsYShmaXJlZm94KQogICAgICAgICAgICB1cmwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlKTsKICAgICAgICAgIH0gZWxzZSBpZiAod2luZG93LndlYmtpdFVSTCAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgLy8gd2Via2l0IG9yIGNocm9tZQogICAgICAgICAgICB1cmwgPSB3aW5kb3cud2Via2l0VVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlKTsKICAgICAgICAgIH0gLy/moLnmja51cmzov5vooYzliqDovb3lm57osIPvvIzlj6/ku6XpmLLmraIKICAgICAgICAgIC8vICAgICBsZXQgcmVhZGVyPW5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgICAvLyAgICAgLy9yZWFkZXIucmVhZEFzVGV4dChmaWxlKTsKICAgICAgICAgIC8vICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsKICAgICAgICAgIC8vIHJlYWRlci5vbmxvYWRlbmQgPSBmdW5jdGlvbihlKSB7CiAgICAgICAgICAvLyAgIF90aGF0LmF1ZGlvTG9hZChlLnRhcmdldC5yZXN1bHQpOwogICAgICAgICAgLy8gfTsKCgogICAgICAgICAgdmFyIGxvYWRlciA9IG5ldyBUSFJFRS5PYmplY3RMb2FkZXIoKTsKICAgICAgICAgIGxvYWRlci5sb2FkKHVybCwgZnVuY3Rpb24gKG9iaikgewogICAgICAgICAgICAvL+WKoOi9veWujOaIkOWQjui/m+ihjAogICAgICAgICAgICBzY2VuZSA9IG9iajsKICAgICAgICAgICAgdGhhdC5pc0xvYWRlZCA9IHRydWU7CiAgICAgICAgICB9LCAvLyBvblByb2dyZXNzIGNhbGxiYWNrCiAgICAgICAgICBmdW5jdGlvbiAoeGhyKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHhoci5sb2FkZWQgLyB4aHIudG90YWwgKiAxMDAgKyAnJSBsb2FkZWQnKTsKICAgICAgICAgIH0sIC8vIG9uRXJyb3IgY2FsbGJhY2sKICAgICAgICAgIGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcignQW4gZXJyb3IgaGFwcGVuZWQnICsgZXJyKTsKICAgICAgICAgIH0pOyAvLyBsZXQgcmVhZGVyPW5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgICAvLyByZWFkZXIucmVhZEFzVGV4dChmaWxlKTsKICAgICAgICAgIC8vIHJlYWRlci5vbmxvYWRlbmQ9ZnVuY3Rpb24oKXsKICAgICAgICAgIC8vICAgbGV0IGxvYWRlcj1uZXcgVEhSRUUuT2JqZWN0TG9hZGVyKCk7CiAgICAgICAgICAvLyAgIGxvYWRlci5wYXJzZShKU09OLnBhcnNlKHRoaXMucmVzdWx0KSwKICAgICAgICAgIC8vICAgICBmdW5jdGlvbihvYmopewogICAgICAgICAgLy8gICAgICAgc2NlbmU9b2JqOwogICAgICAgICAgLy8gICAgIH0KICAgICAgICAgIC8vICAgKTsKICAgICAgICAgIC8vc2NlbmU9bmV3c2NlbmU7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgaW5wdXQuY2xpY2soKTsKICAgIH0sCiAgICAvLyDpgInmi6npn7PpopEKICAgIC8vIGdldEF1ZGlvKCkgewogICAgLy8gICBsZXQgX3RoYXQgPSB0aGlzOwogICAgLy8gICBsZXQgb2JqRmlsZSA9IHRoaXMuJHJlZnMuZmlsZUlkOwogICAgLy8gICBpZiAob2JqRmlsZS52YWx1ZSA9PT0gIiIpIHsKICAgIC8vICAgICByZXR1cm4gZmFsc2U7CiAgICAvLyAgIH0KICAgIC8vICAgaWYgKHdpbmRvdy5GaWxlUmVhZGVyKSB7CiAgICAvLyAgICAgbGV0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAvLyAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwob2JqRmlsZS5maWxlc1swXSk7CiAgICAvLyAgICAgcmVhZGVyLm9ubG9hZGVuZCA9IGZ1bmN0aW9uKGUpIHsKICAgIC8vICAgICAgIF90aGF0LmF1ZGlvTG9hZChlLnRhcmdldC5yZXN1bHQpOwogICAgLy8gICAgIH07CiAgICAvLyAgIH0KICAgIC8vIH0sCiAgICAvLyAg6Z+z6aKR5Yqg6L295pKt5pS+CiAgICAvLyBhdWRpb0xvYWQodXJsKSB7CiAgICAvLyAgIC8vIGxldCBfdGhhdCA9IHRoaXM7CiAgICAvLyAgIGxldCBhdWRpb0xvYWRlciA9IG5ldyBUSFJFRS5BdWRpb0xvYWRlcigpOyAvLyDpn7PpopHliqDovb3lmagKICAgIC8vICAgYXVkaW9Mb2FkZXIubG9hZCh1cmwsIGZ1bmN0aW9uKEF1ZGlvQnVmZmVyKSB7CiAgICAvLyAgICAgaWYgKGF1ZGlvLmlzUGxheWluZykgewogICAgLy8gICAgICAgYXVkaW8uc3RvcCgpOwogICAgLy8gICAgICAgYXVkaW8uc2V0QnVmZmVyKCk7CiAgICAvLyAgICAgfQogICAgLy8gICAgIGF1ZGlvLnNldEJ1ZmZlcihBdWRpb0J1ZmZlcik7IC8vIOmfs+mikee8k+WGsuWMuuWvueixoeWFs+iBlOWIsOmfs+mikeWvueixoWF1ZGlvCiAgICAvLyAgICAgYXVkaW8uc2V0TG9vcCh0cnVlKTsgLy/mmK/lkKblvqrnjq8KICAgIC8vICAgICBhdWRpby5zZXRWb2x1bWUoMSk7IC8v6Z+z6YePCiAgICAvLyAgICAgYXVkaW8ucGxheSgpOyAvL+aSreaUvgogICAgLy8gICAgIC8vIOmfs+mikeWIhuaekOWZqOWSjOmfs+mikee7keWumu+8jOWPr+S7peWunuaXtumHh+mbhumfs+mikeaXtuWfn+aVsOaNrui/m+ihjOW/q+mAn+WChemHjOWPtuWPmOaNogogICAgLy8gICAgIGFuYWx5c2VyID0gbmV3IFRIUkVFLkF1ZGlvQW5hbHlzZXIoYXVkaW8sIDI1NiAqIDIpOwogICAgLy8gICB9KTsKICAgIC8vIH0sCiAgICBHZXRTdGF0ZTogZnVuY3Rpb24gR2V0U3RhdGUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB0aGlzLiRidXMuJG9uKCdQbGF5U3RhdGUnLCBmdW5jdGlvbiAoaXNQbGF5aW5nKSB7CiAgICAgICAgX3RoaXMuaXNQbGF5aW5nID0gaXNQbGF5aW5nOwogICAgICB9KTsKICAgIH0sCiAgICBHZXRBdWRpb0RhdGE6IGZ1bmN0aW9uIEdldEF1ZGlvRGF0YSgpIHsKICAgICAgdmFyIHRoYXQgPSB0aGlzOwogICAgICB0aGlzLiRidXMuJG9uKCdCaW5kaW5nQW5hbHlzZXInLCBmdW5jdGlvbiAoYW5hbHlzZXIpIHsKICAgICAgICB0aGF0LkFuYWx5c2VyID0gYW5hbHlzZXI7CiAgICAgIH0pOwogICAgfSwKICAgIGluaXRBdWRpbzogZnVuY3Rpb24gaW5pdEF1ZGlvKCkgewogICAgICB2YXIgbGlzdGVuZXIgPSBuZXcgVEhSRUUuQXVkaW9MaXN0ZW5lcigpOwogICAgICBhdWRpbyA9IG5ldyBUSFJFRS5BdWRpbyhsaXN0ZW5lcik7CiAgICB9LAogICAgQW5hbHlzaXNMaW5lOiBmdW5jdGlvbiBBbmFseXNpc0xpbmUoKSB7CiAgICAgIC8v6I635Y+W5Y+Y5YyW57q/5q61CiAgICAgIHNjZW5lLnRyYXZlcnNlKGZ1bmN0aW9uIChvYmopIHsKICAgICAgICBpZiAob2JqLm5hbWUuaW5kZXhPZigi6Z+z6aKR57q/IikgIT0gLTEpIHsKICAgICAgICAgIExpbmVHcm91cHMucHVzaChvYmopOwogICAgICAgICAgbWFwLnB1c2goewogICAgICAgICAgICB1dWlkOiBvYmoudXVpZCwKICAgICAgICAgICAgeDogb2JqLnNjYWxlLngsCiAgICAgICAgICAgIHk6IG9iai5zY2FsZS55LAogICAgICAgICAgICB6OiBvYmouc2NhbGUuegogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIGlmIChvYmoubmFtZS5pbmRleE9mKCLpn7PpopHosLEiKSAhPSAtMSkgewogICAgICAgICAgQmFyR3JvdXBzLnB1c2gob2JqKTsKICAgICAgICAgIG1hcC5wdXNoKHsKICAgICAgICAgICAgdXVpZDogb2JqLnV1aWQsCiAgICAgICAgICAgIHg6IG9iai5zY2FsZS54LAogICAgICAgICAgICB5OiBvYmouc2NhbGUueSwKICAgICAgICAgICAgejogb2JqLnNjYWxlLnoKICAgICAgICAgIH0pOyAvLyBjb25zb2xlLmxvZyhvYmouY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0pOwoKICAgICAgICAgIENvbG9yTWFwLnB1c2goewogICAgICAgICAgICB1dWlkOiBvYmoudXVpZCwKICAgICAgICAgICAgcjogb2JqLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzBdLm1hdGVyaWFsLmNvbG9yLnIsCiAgICAgICAgICAgIGc6IG9iai5jaGlsZHJlblswXS5jaGlsZHJlblswXS5tYXRlcmlhbC5jb2xvci5nLAogICAgICAgICAgICBiOiBvYmouY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0ubWF0ZXJpYWwuY29sb3IuYgogICAgICAgICAgfSk7CiAgICAgICAgICBjb25zb2xlLmxvZyhvYmouY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0ubWF0ZXJpYWwuY29sb3IpOwogICAgICAgICAgY29uc29sZS5sb2coQ29sb3JNYXApOwogICAgICAgIH0gZWxzZSBpZiAob2JqLnR5cGUuaW5kZXhPZignTWVzaCcpICE9IC0xICYmIG9iai5wYXJlbnQgPT0gc2NlbmUpIHsKICAgICAgICAgIC8v5Yeg5L2V5L2TCiAgICAgICAgICBHZW9tZXRyeUdyb3Vwcy5wdXNoKG9iaik7CiAgICAgICAgICBtYXAucHVzaCh7CiAgICAgICAgICAgIHV1aWQ6IG9iai51dWlkLAogICAgICAgICAgICB4OiBvYmouc2NhbGUueCwKICAgICAgICAgICAgeTogb2JqLnNjYWxlLnksCiAgICAgICAgICAgIHo6IG9iai5zY2FsZS56CiAgICAgICAgICB9KTsKICAgICAgICAgIGNvbnNvbGUubG9nKEdlb21ldHJ5R3JvdXBzKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHVwZGF0ZUNpcmNsZTogZnVuY3Rpb24gdXBkYXRlQ2lyY2xlKGxpbmVzR3JvdXAsIHgsIHksIHopIHsKICAgICAgaWYgKEJhck5vZGVzKSB7CiAgICAgICAgbGluZXNHcm91cC5zY2FsZS5zZXQodGhpcy5zY2FsZSAqIHgsIHRoaXMuc2NhbGUgKiB5LCB0aGlzLnNjYWxlICogeik7CiAgICAgICAgdmFyIGdlb21ldHJ5QSA9IGxpbmVzR3JvdXAuY2hpbGRyZW5bMF0uZ2VvbWV0cnk7IC8vb3V0bGluZQoKICAgICAgICB2YXIgQXR0cmlidXRlQSA9IGdlb21ldHJ5QS5nZXRBdHRyaWJ1dGUoInBvc2l0aW9uIik7CiAgICAgICAgdmFyIGdlb21ldHJ5QiA9IGxpbmVzR3JvdXAuY2hpbGRyZW5bMV0uZ2VvbWV0cnk7IC8vaW5saW5lCgogICAgICAgIHZhciBBdHRyaWJ1dGVCID0gZ2VvbWV0cnlCLmdldEF0dHJpYnV0ZSgicG9zaXRpb24iKTsKICAgICAgICB2YXIgcG9zaXRpb25zID0gQmFyTm9kZXMubWFwKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgICAgcmV0dXJuIFt2YWx1ZS5wb3NpdGlvbkEoKSwgdmFsdWUucG9zaXRpb25CKCldOwogICAgICAgIH0pOwogICAgICAgIHBvc2l0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChwb3NpdGlvbiwgaW5kZXgpIHsKICAgICAgICAgIEF0dHJpYnV0ZUEuc2V0KFtwb3NpdGlvblswXS54LCBwb3NpdGlvblswXS55XSwgaW5kZXggKiAzKTsKICAgICAgICAgIEF0dHJpYnV0ZUIuc2V0KFtwb3NpdGlvblsxXS54LCBwb3NpdGlvblsxXS55XSwgaW5kZXggKiAzKTsgLy/liY3kuKTnur/mmK9vdXRsaW5l5ZKMaW5saW5lCgogICAgICAgICAgdmFyIGdlb21ldHJ5ID0gbGluZXNHcm91cC5jaGlsZHJlbltpbmRleCArIDJdLmdlb21ldHJ5OwogICAgICAgICAgdmFyIEF0dHJpYnV0ZSA9IGdlb21ldHJ5LmdldEF0dHJpYnV0ZSgicG9zaXRpb24iKTsKICAgICAgICAgIEF0dHJpYnV0ZS5zZXQoW3Bvc2l0aW9uWzBdLngsIHBvc2l0aW9uWzBdLnksIDAsIHBvc2l0aW9uWzFdLngsIHBvc2l0aW9uWzFdLnksIDBdLCAwKTsKICAgICAgICAgIEF0dHJpYnV0ZS5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgICAgfSk7CiAgICAgICAgQXR0cmlidXRlQS5zZXQoW0F0dHJpYnV0ZUEuYXJyYXlbMF0sIEF0dHJpYnV0ZUEuYXJyYXlbMV1dLCBwb3NpdGlvbnMubGVuZ3RoICogMyk7CiAgICAgICAgQXR0cmlidXRlQi5zZXQoW0F0dHJpYnV0ZUIuYXJyYXlbMF0sIEF0dHJpYnV0ZUIuYXJyYXlbMV1dLCBwb3NpdGlvbnMubGVuZ3RoICogMyk7CiAgICAgICAgQXR0cmlidXRlQS5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgICAgQXR0cmlidXRlQi5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgIH0KICAgIH0sCiAgICBpbml0OiBmdW5jdGlvbiBpbml0KCkgewogICAgICB0aGlzLmluaXRSZW5kZXJlcigpOwogICAgICB0aGlzLmluaXRTY2VuZSgpOwogICAgICB0aGlzLmluaXRDYW1lcmEoKTsKICAgICAgdGhpcy5pbml0Q29udHJvbHMoKTsKICAgICAgdGhpcy5pbml0QXVkaW8oKTsgLy90aGlzLmluaXRFZmZlY3RDb21wb3NlcigpOwoKICAgICAgdGhpcy5pbml0U3RhdHMoKTsgLy8gaW5pdERhdEdVSSgpOwogICAgICAvL3RoaXMuYW5pbWF0ZSgpOwogICAgfSwKICAgIGluaXRDb250cm9sczogZnVuY3Rpb24gaW5pdENvbnRyb2xzKCkgewogICAgICBjb250cm9scyA9IG5ldyBPcmJpdENvbnRyb2xzKGNhbWVyYSwgcmVuZGVyZXIuZG9tRWxlbWVudCk7IC8vIOWmguaenOS9v+eUqGFuaW1hdGXmlrnms5Xml7bvvIzlsIbmraTlh73mlbDliKDpmaQKICAgICAgLy9jb250cm9scy5hZGRFdmVudExpc3RlbmVyKCAnY2hhbmdlJywgcmVuZGVyICk7CiAgICAgIC8vIOS9v+WKqOeUu+W+queOr+S9v+eUqOaXtumYu+WwvOaIluiHqui9rCDmhI/mgJ3mmK/lkKbmnInmg6/mgKcKCiAgICAgIGNvbnRyb2xzLmVuYWJsZURhbXBpbmcgPSB0cnVlOyAvL+WKqOaAgemYu+WwvOezu+aVsCDlsLHmmK/pvKDmoIfmi5bmi73ml4vovazngbXmlY/luqYKICAgICAgLy9jb250cm9scy5kYW1waW5nRmFjdG9yID0gMC4yNTsKICAgICAgLy/mmK/lkKblj6/ku6XnvKnmlL4KCiAgICAgIGNvbnRyb2xzLmVuYWJsZVpvb20gPSBmYWxzZTsgLy/mmK/lkKboh6rliqjml4vovawKCiAgICAgIGNvbnRyb2xzLmF1dG9Sb3RhdGUgPSBndWkucm90YXRlOyAvL+iuvue9ruebuOacuui3neemu+WOn+eCueeahOacgOi/nOi3neemuwoKICAgICAgY29udHJvbHMubWluRGlzdGFuY2UgPSAxOyAvL+iuvue9ruebuOacuui3neemu+WOn+eCueeahOacgOi/nOi3neemuwoKICAgICAgY29udHJvbHMubWF4RGlzdGFuY2UgPSAyMDA7IC8v5piv5ZCm5byA5ZCv5Y+z6ZSu5ouW5ou9CgogICAgICBjb250cm9scy5lbmFibGVQYW4gPSBmYWxzZTsKICAgIH0sCiAgICBpbml0TGlnaHQ6IGZ1bmN0aW9uIGluaXRMaWdodCgpIHsKICAgICAgc2NlbmUuYWRkKG5ldyBUSFJFRS5BbWJpZW50TGlnaHQoMHg0NDQ0NDQpKTsKICAgICAgdmFyIGxpZ2h0ID0gbmV3IFRIUkVFLlBvaW50TGlnaHQoMHhmZmZmZmYpOwogICAgICBsaWdodC5wb3NpdGlvbi5zZXQoODAsIDEwMCwgNTApOyAvL+WRiuivieW5s+ihjOWFiemcgOimgeW8gOWQr+mYtOW9seaKleWwhAoKICAgICAgbGlnaHQuY2FzdFNoYWRvdyA9IHRydWU7CiAgICAgIHNjZW5lLmFkZChsaWdodCk7CiAgICB9LAogICAgaW5pdFN0YXRzOiBmdW5jdGlvbiBpbml0U3RhdHMoKSB7CiAgICAgIHN0YXRzID0gbmV3IFN0YXRzKCk7CiAgICAgIHN0YXRzLmRvbUVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnOyAvL+e7neWvueWdkOaghwoKICAgICAgc3RhdHMuZG9tRWxlbWVudC5zdHlsZS5sZWZ0ID0gJzBweCc7IC8vICgwLDApcHgs5bem5LiK6KeSCgogICAgICBzdGF0cy5kb21FbGVtZW50LnN0eWxlLnRvcCA9ICcwcHgnOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2ViZ2wnKS5hcHBlbmRDaGlsZChzdGF0cy5kb21FbGVtZW50KTsKICAgIH0sCiAgICAvLyB1cGRhdGVQb3NpdGlvbigpewogICAgLy8gICAgIG1lc2gucG9zaXRpb24uc2V0KGNvbnRyb2xzLnBvc2l0aW9uWCxjb250cm9scy5wb3NpdGlvblksY29udHJvbHMucG9zaXRpb25aKTsKICAgIC8vIH0sCiAgICAvL+WIneWni+WMlua4suafk+WZqAogICAgaW5pdFJlbmRlcmVyOiBmdW5jdGlvbiBpbml0UmVuZGVyZXIoKSB7CiAgICAgIHJlbmRlcmVyID0gbmV3IFRIUkVFLldlYkdMUmVuZGVyZXIoewogICAgICAgIGFudGlhbGlhczogdHJ1ZQogICAgICB9KTsgLy/lrp7kvovljJbmuLLmn5PlmagKCiAgICAgIHJlbmRlcmVyLnNldFNpemUod2luZG93LmlubmVyV2lkdGggKiAwLjg1LCB3aW5kb3cuaW5uZXJIZWlnaHQgKiAwLjg1KTsgLy/orr7nva7lrr3pq5gKCiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3ZWJnbCcpLmFwcGVuZENoaWxkKHJlbmRlcmVyLmRvbUVsZW1lbnQpOyAvL+a3u+WKoOWIsGRvbQogICAgfSwKICAgIC8v5Yid5aeL5YyW5Zy65pmvCiAgICBpbml0U2NlbmU6IGZ1bmN0aW9uIGluaXRTY2VuZSgpIHsKICAgICAgc2NlbmUgPSBuZXcgVEhSRUUuU2NlbmUoKTsgLy/lrp7kvovljJblnLrmma8KICAgICAgLy8gICAgIHNjZW5lLmJhY2tncm91bmQgPSBuZXcgVEhSRUUuQ3ViZVRleHR1cmVMb2FkZXIoKS5sb2FkKFsKICAgICAgLy8gICByZXF1aXJlKCdAL2Fzc2V0cy9za3lib3gvcmlnaHQuanBnJyksCiAgICAgIC8vICAgcmVxdWlyZSgnQC9hc3NldHMvc2t5Ym94L2xlZnQuanBnJyksCiAgICAgIC8vICAgcmVxdWlyZSgnQC9hc3NldHMvc2t5Ym94L3RvcC5qcGcnKSwKICAgICAgLy8gICByZXF1aXJlKCdAL2Fzc2V0cy9za3lib3gvYm90dG9tLmpwZycpLAogICAgICAvLyAgIHJlcXVpcmUoJ0AvYXNzZXRzL3NreWJveC9mcm9udC5qcGcnKSwKICAgICAgLy8gICByZXF1aXJlKCdAL2Fzc2V0cy9za3lib3gvYmFjay5qcGcnKQogICAgICAvLyBdKTsKICAgIH0sCiAgICAvL+WIneWni+WMluebuOacugogICAgaW5pdENhbWVyYTogZnVuY3Rpb24gaW5pdENhbWVyYSgpIHsKICAgICAgY2FtZXJhID0gbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKDQ1LCB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodCwgMC4xLCAyMDApOyAvL+WunuS+i+WMluebuOacuuOAkQoKICAgICAgY2FtZXJhLnBvc2l0aW9uLnNldCgwLCAwLCAxNTApOwogICAgfSwKICAgIC8v5Yib5bu65qih5Z6LCiAgICAvL+i/kOihjOWKqOeUuwogICAgYW5pbWF0ZTogZnVuY3Rpb24gYW5pbWF0ZSgpIHsKICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMuYW5pbWF0ZSk7IC8v5b6q546v6LCD55So5Ye95pWwCiAgICAgIC8vIG1lc2gucm90YXRpb24ueCs9MC4wMTsKICAgICAgLy8gLy8gLy/mr4/luKfnvZHmoLzmqKHlnovmsr946L205peL6L2sMC4wMeW8p+W6pgogICAgICAvLyBtZXNoLnJvdGF0aW9uLnkrPTAuMDI7CiAgICAgIC8vIC8v5q+P5bin572R5qC85qih5Z6L5rK/eei9tOaXi+i9rDAuMDLlvKfluqYKICAgICAgLy8gLy9zdGF0cy51cGRhdGUoKTsvL+abtOaWsOaAp+iDveajgOa1i+ahhgoKICAgICAgc3RhdHMudXBkYXRlKCk7CiAgICAgIGNvbnRyb2xzLnVwZGF0ZSgpOwoKICAgICAgaWYgKHRoaXMuQW5hbHlzZXIgJiYgdGhpcy5pc1BsYXlpbmcpIHsKICAgICAgICB2YXIgYnVmZmVyTGVuZ3RoID0gdGhpcy5BbmFseXNlci5mcmVxdWVuY3lCaW5Db3VudDsKICAgICAgICB2YXIgYXJyID0gbmV3IFVpbnQ4QXJyYXkoYnVmZmVyTGVuZ3RoKTsKICAgICAgICB0aGlzLkFuYWx5c2VyLmdldEJ5dGVGcmVxdWVuY3lEYXRhKGFycik7IC8vbGV0IGFycj1hbmFseXNlci5nZXRGcmVxdWVuY3lEYXRhKCk7CiAgICAgICAgLy9jb25zb2xlLmxvZyhhcnIpOwoKICAgICAgICB2YXIgRGVsdGEgPSB0aGlzLmNsb2NrLmdldERlbHRhKCk7CiAgICAgICAgQmFyTm9kZXMuZm9yRWFjaChmdW5jdGlvbiAobm9kZSwgaW5kZXgsIGFycmF5KSB7CiAgICAgICAgICBub2RlLnN0cmVuZ3RoKGFycltpbmRleCAlIGFycmF5Lmxlbmd0aF0gKiAwLjEpOwogICAgICAgICAgbm9kZS50cmFuc2l0aW9uKERlbHRhKTsKICAgICAgICB9KTsKICAgICAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICAgICAgdGhpcy5zY2FsZSA9IDEgKyBhcnJbTWF0aC5jZWlsKGFyci5sZW5ndGggKiAwLjA1KV0gLyA1MDA7IC8vbGV0IG5zY2FsZT0xK2FyclsxM10vNTAwOwogICAgICAgIC8vY29uc29sZS5sb2coIuWOn+WniyIrdGhpcy5zY2FsZSsi5pS56L+bIituc2NhbGUpOwoKICAgICAgICBpZiAoTGluZUdyb3Vwcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICBMaW5lR3JvdXBzLmZvckVhY2goZnVuY3Rpb24gKG9iaikgewogICAgICAgICAgICB2YXIgc2NhbGVkYXRhID0gbWFwLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgIHJldHVybiBpdGVtLnV1aWQgPT0gb2JqLnV1aWQ7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGF0LnVwZGF0ZUNpcmNsZShvYmosIHNjYWxlZGF0YVswXS54LCBzY2FsZWRhdGFbMF0ueSwgc2NhbGVkYXRhWzBdLnopOwogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoQmFyR3JvdXBzLmxlbmd0aCA+IDApIHsKICAgICAgICAgIEJhckdyb3Vwcy5mb3JFYWNoKGZ1bmN0aW9uIChvYmopIHsKICAgICAgICAgICAgdmFyIHNjYWxlZGF0YSA9IG1hcC5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICByZXR1cm4gaXRlbS51dWlkID09IG9iai51dWlkOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdmFyIEJhckNvbG9yID0gQ29sb3JNYXAuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0udXVpZCA9PSBvYmoudXVpZDsKICAgICAgICAgICAgfSk7IC8vIGNvbnNvbGUubG9nKEJhckNvbG9yWzBdLnIpOwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhCYXJDb2xvclswXS5nKTsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coQmFyQ29sb3JbMF0uYik7CgogICAgICAgICAgICB0aGF0LnVwZGF0ZUJhcnMoYXJyLCBvYmosIHNjYWxlZGF0YVswXS54LCBzY2FsZWRhdGFbMF0ueSwgc2NhbGVkYXRhWzBdLnosIEJhckNvbG9yWzBdLnIsIEJhckNvbG9yWzBdLmcsIEJhckNvbG9yWzBdLmIpOwogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICA7CgogICAgICAgIGlmIChHZW9tZXRyeUdyb3Vwcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICBHZW9tZXRyeUdyb3Vwcy5mb3JFYWNoKGZ1bmN0aW9uIChvYmopIHsKICAgICAgICAgICAgdmFyIHNjYWxlZGF0YSA9IG1hcC5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICByZXR1cm4gaXRlbS51dWlkID09IG9iai51dWlkOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhhdC51cGRhdGVHZW9tZXRyeShvYmosIHNjYWxlZGF0YVswXS54LCBzY2FsZWRhdGFbMF0ueSwgc2NhbGVkYXRhWzBdLnopOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBjb21wb3Nlci5yZW5kZXIoKTsgLy/kvb/nlKjlkI7mnJ/lpITnkIbpgJrpgZPmuLLmn5MKICAgIH0sCiAgICB1cGRhdGVHZW9tZXRyeTogZnVuY3Rpb24gdXBkYXRlR2VvbWV0cnkoR2VvbWV0cnksIHgsIHksIHopIHsKICAgICAgR2VvbWV0cnkuc2NhbGUuc2V0KHRoaXMuc2NhbGUgKiB4LCB0aGlzLnNjYWxlICogeSwgdGhpcy5zY2FsZSAqIHopOwogICAgfSwKICAgIHVwZGF0ZUJhcnM6IGZ1bmN0aW9uIHVwZGF0ZUJhcnMoYXJyLCBiYXJHcm91cCwgeCwgeSwgeiwgciwgZywgYikgewogICAgICBpZiAoYmFyR3JvdXApIHsKICAgICAgICBiYXJHcm91cC5yb3RhdGlvbi56ICs9IDAuMDAyOwogICAgICAgIGJhckdyb3VwLnNjYWxlLnNldCh0aGlzLnNjYWxlICogeCwgdGhpcy5zY2FsZSAqIHksIHRoaXMuc2NhbGUgKiB6KTsKICAgICAgICBiYXJHcm91cC5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtLCBpbmRleCkgewogICAgICAgICAgLy/orrDlvZXnmoTljp9yZ2LlgLzmmK8wLTHnmoTmta7ngrnlgLzvvIzpnIDopoHmoLnmja7popHnjofmlbDlgLzovazmjaIKICAgICAgICAgIGlmIChyID4gMCkgewogICAgICAgICAgICBlbGVtLmNoaWxkcmVuWzBdLm1hdGVyaWFsLmNvbG9yLnIgPSBhcnJbaW5kZXhdICogciAvIDI1NTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZyA+IDApIHsKICAgICAgICAgICAgZWxlbS5jaGlsZHJlblswXS5tYXRlcmlhbC5jb2xvci5nID0gYXJyW2luZGV4XSAqIGcgLyAyNTU7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGIgPiAwKSB7CiAgICAgICAgICAgIGVsZW0uY2hpbGRyZW5bMF0ubWF0ZXJpYWwuY29sb3IuYiA9IGFycltpbmRleF0gKiBiIC8gMjU1OwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChhcnJbaW5kZXhdID09PSAwKSB7CiAgICAgICAgICAgIGVsZW0uc2NhbGUuc2V0KDEsIDEsIDEpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdmFyIG0gPSBhcnJbaW5kZXhdIC8gMjA7CiAgICAgICAgICAgIHZhciB0YXJnZXRSYW5nZSA9IE1hdGgubWF4KGFycltpbmRleF0gLyAyMCAtIGFycltpbmRleCAtIDFdIC8gMjAsIDApOwoKICAgICAgICAgICAgaWYgKG0gPCB0YXJnZXRSYW5nZSkgewogICAgICAgICAgICAgIG0gPSB0YXJnZXRSYW5nZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZWxlbS5zY2FsZS5zZXQoMSwgbSwgMSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBpbml0QmFyczogZnVuY3Rpb24gaW5pdEJhcnMoKSB7CiAgICAgIEJhck5vZGVzID0gcmFuZ2UoMCwgMjU2KS5tYXAoZnVuY3Rpb24gKGluZGV4KSB7CiAgICAgICAgcmV0dXJuIG5ldyBub2RlKDIwLCAoaW5kZXggLyAyNTYgKiAzNjAgKyA0NSkgJSAzNjAsIG5ldyBUSFJFRS5WZWN0b3IyKDAsIDApKTsKICAgICAgfSk7CiAgICAgIGNvbnNvbGUubG9nKEJhck5vZGVzKTsKICAgIH0sCiAgICAvL+WQjuacn+WkhOeQhgogICAgaW5pdEVmZmVjdENvbXBvc2VyOiBmdW5jdGlvbiBpbml0RWZmZWN0Q29tcG9zZXIoKSB7CiAgICAgIGNvbXBvc2VyID0gbmV3IEVmZmVjdENvbXBvc2VyKHJlbmRlcmVyKTsKICAgICAgdmFyIHJlbmRlclBhc3MgPSBuZXcgUmVuZGVyUGFzcyhzY2VuZSwgY2FtZXJhKTsKICAgICAgY29tcG9zZXIuYWRkUGFzcyhyZW5kZXJQYXNzKTsgLy9SZW5kZXJQYXNz6YCa5bi45L2N5LqO6L+H56iL6ZO+55qE5byA5aeL77yM5Lul5L6/5bCG5riy5p+T5aW955qE5Zy65pmv5L2c5Li66L6T5YWl5p2l5o+Q5L6b57uZ5LiL5LiA5Liq5ZCO5pyf5aSE55CG5q2l6aqk44CCCiAgICAgIC8vQ29weVNoYWRlcuaYr+S4uuS6huiDveWwhue7k+aenOi+k+WHuu+8jOaZrumAmueahOmAmumBk+S4gOiIrOmDveaYr+S4jeiDvei+k+WHuueahO+8jOimgemdoENvcHlTaGFkZXLov5vooYzovpPlh7oKCiAgICAgIHZhciBjb3B5U2hhZGVyID0gbmV3IFNoYWRlclBhc3MoQ29weVNoYWRlcik7CiAgICAgIGNvcHlTaGFkZXIucmVuZGVyVG9TY3JlZW4gPSB0cnVlOyAvL+i/meS4quWPguaVsOeahOebrueahOaYr+mprOS4iuWwhuW9k+WJjeeahOWGheWuuei+k+WHugoKICAgICAgdGhpcy5pbml0Qmxvb21QYXNzKCk7CiAgICAgIGNvbXBvc2VyLmFkZFBhc3MoY29weVNoYWRlcik7CiAgICB9LAogICAgaW5pdEJsb29tUGFzczogZnVuY3Rpb24gaW5pdEJsb29tUGFzcygpIHsKICAgICAgdmFyIHBhcmFtcyA9IHsKICAgICAgICBleHBvc3VyZTogMC41LAogICAgICAgIGJsb29tU3RyZW5ndGg6IDEsCiAgICAgICAgYmxvb21UaHJlc2hvbGQ6IDAsCiAgICAgICAgYmxvb21SYWRpdXM6IDAuOAogICAgICB9OwogICAgICB2YXIgYmxvb21QYXNzID0gbmV3IFVucmVhbEJsb29tUGFzcyhuZXcgVEhSRUUuVmVjdG9yMih3aW5kb3cuaW5uZXJXaWR0aCAqIDAuODUsIHdpbmRvdy5pbm5lckhlaWdodCAqIDAuODUpLCAxLjUsIDAuMiwgMCk7CiAgICAgIGJsb29tUGFzcy50aHJlc2hvbGQgPSBwYXJhbXMuYmxvb21UaHJlc2hvbGQ7CiAgICAgIGJsb29tUGFzcy5zdHJlbmd0aCA9IHBhcmFtcy5ibG9vbVN0cmVuZ3RoOwogICAgICBibG9vbVBhc3MucmFkaXVzID0gcGFyYW1zLmJsb29tUmFkaXVzOwogICAgICBjb21wb3Nlci5hZGRQYXNzKGJsb29tUGFzcyk7CiAgICB9LAogICAgc3RhcnRwbGF5OiBmdW5jdGlvbiBzdGFydHBsYXkoKSB7CiAgICAgIHZhciB0aGF0ID0gdGhpczsKICAgICAgdGhpcy4kYnVzLiRvbigncGxheWZpbGUnLCBmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgLy9jb25zb2xlLmxvZyhyZXMpOwogICAgICAgIC8vdGhhdC5pc0xvYWRlZD1mYWxzZTsKICAgICAgICAvL+avj+asoeWvvOWFpeaUueWPmOWAvOeEtuWQjumHjeaWsOa4suafkwogICAgICAgIHZhciBKU09OU3RyID0gSlNPTi5zdHJpbmdpZnkocmVzKTsKICAgICAgICB2YXIgZmlsZSA9IG5ldyBGaWxlKFtKU09OU3RyXSwgJ3NjZW5lLmpzb24nLCB7CiAgICAgICAgICB0eXBlOiAnYXBwbGljYXRpb24vanNvbicsCiAgICAgICAgICBsYXN0TW9kaWZpZWQ6IERhdGUubm93KCkKICAgICAgICB9KTsgLy/nu4TlkIjmiJDmlofku7YKCiAgICAgICAgdmFyIHVybCA9IG51bGw7CgogICAgICAgIGlmICh3aW5kb3cuY3JlYXRlT2JqZWN0VVJMICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgLy8gYmFzaWMKICAgICAgICAgIHVybCA9IHdpbmRvdy5jcmVhdGVPYmplY3RVUkwoZmlsZSk7CiAgICAgICAgfSBlbHNlIGlmICh3aW5kb3cuVVJMICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgLy8gbW96aWxsYShmaXJlZm94KQogICAgICAgICAgdXJsID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSk7CiAgICAgICAgfSBlbHNlIGlmICh3aW5kb3cud2Via2l0VVJMICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgLy8gd2Via2l0IG9yIGNocm9tZQogICAgICAgICAgdXJsID0gd2luZG93LndlYmtpdFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSk7CiAgICAgICAgfQoKICAgICAgICB2YXIgbG9hZGVyID0gbmV3IFRIUkVFLk9iamVjdExvYWRlcigpOwogICAgICAgIGxvYWRlci5sb2FkKHVybCwgZnVuY3Rpb24gKG9iaikgewogICAgICAgICAgc2NlbmUgPSBvYmo7CiAgICAgICAgICBzY2VuZS5iYWNrZ3JvdW5kID0gbmV3IFRIUkVFLkNvbG9yKDB4REVFNkU2KTsKICAgICAgICAgIGNvbnNvbGUubG9nKHNjZW5lKTsgLy90aGF0LmluaXRMaWdodCgpOwoKICAgICAgICAgIHRoYXQuQW5hbHlzaXNMaW5lKCk7CiAgICAgICAgICB0aGF0LmluaXRCYXJzKCk7CiAgICAgICAgICB0aGF0LmluaXRFZmZlY3RDb21wb3NlcigpOyAvL3RoYXQuaW5pdFN0YXRzKCk7CiAgICAgICAgICAvLyBpbml0RGF0R1VJKCk7CgogICAgICAgICAgdGhhdC5hbmltYXRlKCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHRoaXMuaW5pdCgpOwogICAgdGhpcy5HZXRBdWRpb0RhdGEoKTsKICAgIHRoaXMuR2V0U3RhdGUoKTsKICAgIHRoaXMuc3RhcnRwbGF5KCk7CiAgfQp9Ow=="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA;AACA;AACA;AACA,yD,CACA;;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uE,CACA;;AACA;AACAA,OADA;AAEAC,OAFA;AAGAC,QAHA;AAIAC,4BAJA;AAKAC,8BALA;AAMAC,qBANA;AAOAC;AAPA;AASA,oB,CAAA;;AACA,a,CAAA;;AACA,a,CAAA;;AACA;AAAA,IACAC,aADA;AAEA;AACA;AACA;AACA;AACA;AACA;AACAC,eADA;AAEAC;AACAC;AADA,GAFA;AAKAC,MALA,kBAKA;AACA;AACAC,8BADA;AAEAC,cAFA;AAGAC,oBAHA;AAIAC,sBAJA;AAKAC;AALA;AAOA,GAbA;AAcAC;AACAD;AACAE,aADA,qBACA;AACA;AACA;AACA;AACA;AACA,oCAJA,CAKA;AACA;;AACA;AACA;AACA;AAXA,KADA,CAcA;AACA;AACA;AACA;AACA;;AAlBA,GAdA;AAkCAC;AACAC,UADA,oBACA;AACA,4BADA,CAEA;;AACA;AACA;AACAC;AACAA;AACA;AACAC;;AACA;AACA;;AACA;AAAA;AACAC;AACA,WAFA,MAEA;AAAA;AACAA;AACA,WAFA,MAEA;AAAA;AACAA;AACA,WARA,CASA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACAC,2BACA;AACA;AACAC;AACAC;AAEA,WANA,EAOA;AACA;AACAJ;AACA,WAVA,EAYA;AACA;AACAA;AACA,WAfA,EAnBA,CAoCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAlDA;AAmDAD;AACA,KA3DA;AA4DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAM,YA7FA,sBA6FA;AAAA;;AACA;AACA;AACA,OAFA;AAGA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","names":["R","G","B","TrianglesBgColor","TrianglesLineColor","lineColor","rotate","TriangleGroup","name","components","AudioPlayer","data","clock","scale","Analyser","isPlaying","isLoaded","watch","handler","methods","Import","input","console","url","loader","scene","that","GetState","GetAudioData","initAudio","audio","AnalysisLine","LineGroups","map","uuid","x","y","z","BarGroups","ColorMap","r","g","b","GeometryGroups","updateCircle","linesGroup","positions","AttributeA","AttributeB","Attribute","init","initControls","controls","initLight","light","initStats","stats","document","initRenderer","renderer","antialias","initScene","initCamera","camera","animate","requestAnimationFrame","BarNodes","node","BarColor","composer","updateGeometry","Geometry","updateBars","arr","barGroup","elem","m","initBars","initEffectComposer","copyShader","initBloomPass","exposure","bloomStrength","bloomThreshold","bloomRadius","bloomPass","startplay","type","lastModified","mounted"],"sourceRoot":"src/views/scene","sources":["Scene.vue"],"sourcesContent":["<template>\n   <div class=\"app-container-play\">\n\n     <el-container>\n       <el-header>\n         <el-button @click=\"Import\" type=\"primary\" style=\"margin-left: 16px;\">\n           导入\n         </el-button>\n       </el-header>\n       <el-main>\n         <el-scrollbar class=\"Scrollbar\">\n           <div id=\"webgl\" style=\"position:relative\">\n\n           </div>\n         </el-scrollbar>\n       </el-main>\n       <el-footer height=\"100px\">\n         <AudioPlayer/>\n       </el-footer>\n     </el-container>\n\n\n     <!-- <div class=\"file-select-btn\" @click=\"$refs.fileId.click()\">\n      选择音乐\n      <input ref=\"fileId\" type=\"file\" class=\"file-input\" @change=\"getAudio\" />\n     </div> -->\n\n\n  </div>\n</template>\n\n<script>\nimport * as THREE from 'three/build/three.module.js'\nimport Stats from '../../store/Stats/stats.min.js'\nimport { OrbitControls } from \"../../lib/OrbitControls.js\";\nimport index, { GUI } from \"../../lib/dat.gui.module.js\";\n//辉光\nimport { EffectComposer } from \"three/examples/jsm/postprocessing/EffectComposer.js\";\nimport { RenderPass } from \"three/examples/jsm/postprocessing/RenderPass.js\";\nimport { GlitchPass } from 'three/examples/jsm/postprocessing/GlitchPass.js';\nimport { UnrealBloomPass } from \"three/examples/jsm/postprocessing/UnrealBloomPass.js\";\n\nimport { ShaderPass } from \"three/examples/jsm/postprocessing/ShaderPass.js\";\nimport { CopyShader } from \"three/examples/jsm/shaders/CopyShader.js\";\nimport { range } from \"../../components/mode/range\";\nimport { node } from \"../../components/mode/node\";\nimport AudioPlayer from \"../scene/Player/Player.vue\"\nimport { randomRange } from \"../../components/mode/randomRange\";\nimport { Triangle } from \"../../components/mode/Triangle\";\nimport { Loader } from '../../lib/three.module.js';\nlet renderer,camera,scene,geometry,material,mesh,stats,controls;\n//  let container=document.getElementById('webgl');\nlet gui = {\n  R: 20,\n  G: 90,\n  B: 225,\n  TrianglesBgColor: 0x03a9f4,\n  TrianglesLineColor: 0x03a9f4,\n  lineColor: 0x00ffff,\n  rotate: false\n};\nlet audio, analyser; // 音频\nlet BarNodes; // 线\nlet composer;//合成器\nlet Triangles = [],\n  TriangleGroup;\nlet LineGroups=[];\nlet BarGroups=[];\nlet GeometryGroups=[];\nlet map=[];\nlet ColorMap=[];\nexport default {\n    name: 'Scene',\n    components:{\n      AudioPlayer\n    },\n    data() {\n      return {\n        clock:new THREE.Clock(),\n        scale:1,\n        Analyser:null,\n        isPlaying:false,\n        isLoaded:false,\n      }\n    },\n    watch:{\n      isLoaded:{\n        handler(){\n          if(this.isLoaded==true){\n             this.initLight();\n              this.AnalysisLine();\n              this.initBars();\n              this.initEffectComposer();\n              //that.initStats();\n            // initDatGUI();\n            this.animate();\n          }\n        }\n      }\n      // $route:{\n      //   handler(){\n      //     this.\n      //   }\n      // }\n    },\n    methods: {\n      Import(){\n        this.isLoaded=false;\n        //每次导入改变值然后重新渲染\n        let that=this;\n        let input=document.createElement('input');\n        input.type=\"file\";\n        input.addEventListener(\"change\",function(){\n          let file=input.files[0];\n          console.log(file);\n          if(file.type.indexOf(\"json\")>=0){\n            let url = null ;\n            if (window.createObjectURL!=undefined) { // basic\n                url = window.createObjectURL(file) ;\n            } else if (window.URL!=undefined) { // mozilla(firefox)\n                url = window.URL.createObjectURL(file) ;\n            } else if (window.webkitURL!=undefined) { // webkit or chrome\n                url = window.webkitURL.createObjectURL(file) ;\n            }\n            //根据url进行加载回调，可以防止\n        //     let reader=new FileReader();\n        //     //reader.readAsText(file);\n        //     reader.readAsDataURL(file);\n        // reader.onloadend = function(e) {\n        //   _that.audioLoad(e.target.result);\n        // };\n\n\n             let loader=new THREE.ObjectLoader();\n             loader.load(url,\n              function(obj){\n                //加载完成后进行\n                scene=obj;\n                that.isLoaded=true;\n\n              },\n              // onProgress callback\n\t            function ( xhr ) {\n\t\t          console.log( (xhr.loaded / xhr.total * 100) + '% loaded' );\n\t            },\n\n\t          // onError callback\n\t            function ( err ) {\n\t\t              console.error( 'An error happened'+err );\n              });\n\n            // let reader=new FileReader();\n            // reader.readAsText(file);\n            // reader.onloadend=function(){\n            //   let loader=new THREE.ObjectLoader();\n            //   loader.parse(JSON.parse(this.result),\n            //     function(obj){\n            //       scene=obj;\n            //     }\n            //   );\n              //scene=newscene;\n          }\n        });\n        input.click();\n      },\n      // 选择音频\n    // getAudio() {\n    //   let _that = this;\n    //   let objFile = this.$refs.fileId;\n    //   if (objFile.value === \"\") {\n    //     return false;\n    //   }\n    //   if (window.FileReader) {\n    //     let reader = new FileReader();\n    //     reader.readAsDataURL(objFile.files[0]);\n    //     reader.onloadend = function(e) {\n    //       _that.audioLoad(e.target.result);\n    //     };\n    //   }\n    // },\n    //  音频加载播放\n    // audioLoad(url) {\n    //   // let _that = this;\n\n    //   let audioLoader = new THREE.AudioLoader(); // 音频加载器\n    //   audioLoader.load(url, function(AudioBuffer) {\n    //     if (audio.isPlaying) {\n    //       audio.stop();\n    //       audio.setBuffer();\n    //     }\n    //     audio.setBuffer(AudioBuffer); // 音频缓冲区对象关联到音频对象audio\n    //     audio.setLoop(true); //是否循环\n    //     audio.setVolume(1); //音量\n    //     audio.play(); //播放\n    //     // 音频分析器和音频绑定，可以实时采集音频时域数据进行快速傅里叶变换\n    //     analyser = new THREE.AudioAnalyser(audio, 256 * 2);\n    //   });\n    // },\n    GetState(){\n      this.$bus.$on('PlayState',(isPlaying)=>{\n          this.isPlaying=isPlaying;\n      })\n    },\n    GetAudioData(){\n      let that=this;\n        this.$bus.$on('BindingAnalyser',(analyser)=>{\n          that.Analyser=analyser;\n\n        })\n    },\n    initAudio(){\n      let listener=new THREE.AudioListener();\n      audio=new THREE.Audio(listener);\n    },\n      AnalysisLine(){\n\n\n        //获取变化线段\n        scene.traverse(function(obj){\n          if(obj.name.indexOf(\"音频线\")!=-1){\n            LineGroups.push(obj);\n            map.push({\n              uuid:obj.uuid,\n              x:obj.scale.x,\n              y:obj.scale.y,\n              z:obj.scale.z\n            });\n\n          }else if(obj.name.indexOf(\"音频谱\")!=-1){\n            BarGroups.push(obj);\n            map.push({\n              uuid:obj.uuid,\n              x:obj.scale.x,\n              y:obj.scale.y,\n              z:obj.scale.z\n            });\n           // console.log(obj.children[0].children[0]);\n            ColorMap.push({\n              uuid:obj.uuid,\n              r:obj.children[0].children[0].material.color.r,\n              g:obj.children[0].children[0].material.color.g,\n              b:obj.children[0].children[0].material.color.b,\n            });\n            console.log(obj.children[0].children[0].material.color);\n            console.log(ColorMap);\n\n          }else if(obj.type.indexOf('Mesh')!=-1&&obj.parent==scene){\n            //几何体\n            GeometryGroups.push(obj);\n            map.push({\n              uuid:obj.uuid,\n              x:obj.scale.x,\n              y:obj.scale.y,\n              z:obj.scale.z\n\n            });\n            console.log(GeometryGroups);\n\n          }\n        });\n      },\n       updateCircle(linesGroup,x,y,z) {\n      if (BarNodes) {\n\n        linesGroup.scale.set(this.scale*x,this.scale*y,this.scale*z);\n\n        const geometryA = linesGroup.children[0].geometry;\n        //outline\n        const AttributeA = geometryA.getAttribute(\"position\");\n        const geometryB = linesGroup.children[1].geometry;\n        //inline\n        const AttributeB = geometryB.getAttribute(\"position\");\n\n        const positions = BarNodes.map(value => {\n          return [value.positionA(), value.positionB()];\n        });\n        positions.forEach((position, index) => {\n          AttributeA.set([position[0].x, position[0].y], index * 3);\n          AttributeB.set([position[1].x, position[1].y], index * 3);\n          //前两线是outline和inline\n          const geometry = linesGroup.children[index+2].geometry;\n          const Attribute = geometry.getAttribute(\"position\");\n          Attribute.set(\n            [position[0].x, position[0].y, 0, position[1].x, position[1].y, 0],\n            0\n          );\n          Attribute.needsUpdate = true;\n        });\n        AttributeA.set(\n          [AttributeA.array[0], AttributeA.array[1]],\n          positions.length * 3\n        );\n        AttributeB.set(\n          [AttributeB.array[0], AttributeB.array[1]],\n          positions.length * 3\n        );\n        AttributeA.needsUpdate = true;\n        AttributeB.needsUpdate = true;\n      }\n    },\n\n        init(){\n            this.initRenderer();\n            this.initScene();\n            this.initCamera();\n            this.initControls();\n\n            this.initAudio();\n            //this.initEffectComposer();\n            this.initStats();\n            // initDatGUI();\n            //this.animate();\n\n        },\n        initControls() {\n          controls = new OrbitControls(camera, renderer.domElement);\n         // 如果使用animate方法时，将此函数删除\n         //controls.addEventListener( 'change', render );\n          // 使动画循环使用时阻尼或自转 意思是否有惯性\n          controls.enableDamping = true;\n          //动态阻尼系数 就是鼠标拖拽旋转灵敏度\n         //controls.dampingFactor = 0.25;\n          //是否可以缩放\n          controls.enableZoom = false;\n          //是否自动旋转\n          controls.autoRotate = gui.rotate;\n          //设置相机距离原点的最远距离\n          controls.minDistance = 1;\n          //设置相机距离原点的最远距离\n          controls.maxDistance = 200;\n          //是否开启右键拖拽\n          controls.enablePan = false;\n        },\n        initLight() {\n          scene.add(new THREE.AmbientLight(0x444444));\n          let light = new THREE.PointLight(0xffffff);\n          light.position.set(80, 100, 50);\n          //告诉平行光需要开启阴影投射\n          light.castShadow = true;\n          scene.add(light);\n        },\n        initStats(){\n             stats = new Stats();\n             stats.domElement.style.position = 'absolute'; //绝对坐标\n             stats.domElement.style.left = '0px';// (0,0)px,左上角\n             stats.domElement.style.top = '0px';\n            document.getElementById('webgl').appendChild(stats.domElement);\n\n        },\n        // updatePosition(){\n        //     mesh.position.set(controls.positionX,controls.positionY,controls.positionZ);\n        // },\n        //初始化渲染器\n        initRenderer(){\n\n\n            renderer=new THREE.WebGLRenderer({ antialias: true });//实例化渲染器\n            renderer.setSize(window.innerWidth*0.85,window.innerHeight*0.85);//设置宽高\n            document.getElementById('webgl').appendChild(renderer.domElement);//添加到dom\n        },\n        //初始化场景\n        initScene(){\n\n            scene=new THREE.Scene();//实例化场景\n        //     scene.background = new THREE.CubeTextureLoader().load([\n        //   require('@/assets/skybox/right.jpg'),\n        //   require('@/assets/skybox/left.jpg'),\n        //   require('@/assets/skybox/top.jpg'),\n        //   require('@/assets/skybox/bottom.jpg'),\n        //   require('@/assets/skybox/front.jpg'),\n        //   require('@/assets/skybox/back.jpg')\n        // ]);\n\n        },\n        //初始化相机\n        initCamera(){\n            camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,0.1,200)\n            //实例化相机】\n            camera.position.set(0,0,150);\n        },\n        //创建模型\n\n\n        //运行动画\n        animate(){\n            requestAnimationFrame(this.animate);//循环调用函数\n\n            // mesh.rotation.x+=0.01;\n            // // //每帧网格模型沿x轴旋转0.01弧度\n            // mesh.rotation.y+=0.02;\n            // //每帧网格模型沿y轴旋转0.02弧度\n            // //stats.update();//更新性能检测框\n\n            stats.update();\n            controls.update();\n            if(this.Analyser&&this.isPlaying){\n              let bufferLength=this.Analyser.frequencyBinCount;\n              let arr=new Uint8Array(bufferLength);\n              this.Analyser.getByteFrequencyData(arr);\n              //let arr=analyser.getFrequencyData();\n              //console.log(arr);\n              const Delta=this.clock.getDelta();\n              BarNodes.forEach((node,index,array)=>{\n                node.strength(arr[index % array.length]*0.1);\n                node.transition(Delta);\n\n              });\n              let that=this;\n               this.scale=1+arr[Math.ceil(arr.length*0.05)]/500;\n              //let nscale=1+arr[13]/500;\n              //console.log(\"原始\"+this.scale+\"改进\"+nscale);\n\n               if(LineGroups.length>0){\n                  LineGroups.forEach(function(obj){\n                    const scaledata=map.filter((item)=>item.uuid==obj.uuid);\n\n                    that.updateCircle(obj,scaledata[0].x,scaledata[0].y,scaledata[0].z);\n                });\n               }\n               if(BarGroups.length>0){\n                 BarGroups.forEach(function(obj){\n\n                    const scaledata=map.filter((item)=>item.uuid==obj.uuid);\n                    const BarColor=ColorMap.filter((item)=>item.uuid==obj.uuid);\n                    // console.log(BarColor[0].r);\n                    // console.log(BarColor[0].g);\n                    // console.log(BarColor[0].b);\n                    that.updateBars(arr,obj,scaledata[0].x,scaledata[0].y,scaledata[0].z,\n                                   BarColor[0].r,BarColor[0].g,BarColor[0].b);\n                 });\n               };\n               if(GeometryGroups.length>0){\n                 GeometryGroups.forEach(function (obj){\n                   const scaledata=map.filter((item)=>item.uuid==obj.uuid);\n                   that.updateGeometry(obj,scaledata[0].x,scaledata[0].y,scaledata[0].z);\n\n                 });\n               }\n\n\n            }\n            composer.render();//使用后期处理通道渲染\n        },\n        updateGeometry(Geometry,x,y,z){\n            Geometry.scale.set(this.scale*x,this.scale*y,this.scale*z);\n        },\n        updateBars(arr,barGroup,x,y,z,r,g,b){\n           if(barGroup){\n              barGroup.rotation.z += 0.002;\n              barGroup.scale.set(this.scale*x, this.scale*y, this.scale*z);\n              barGroup.children.forEach((elem,index)=>{\n                //记录的原rgb值是0-1的浮点值，需要根据频率数值转换\n                if(r>0){\n                   elem.children[0].material.color.r= arr[index] *r/ 255;\n\n                }\n               if(g>0){\n                  elem.children[0].material.color.g=arr[index]*g/255;\n               }\n\n                if(b>0){\n                  elem.children[0].material.color.b=arr[index]*b/255;\n                }\n\n                if(arr[index]===0){\n                  elem.scale.set(1,1,1);\n                }else{\n              let m = arr[index] / 20;\n                   let targetRange = Math.max(\n                  arr[index] / 20 - arr[index - 1] / 20,0);\n              if (m < targetRange) {\n                m = targetRange;\n              }\n\n              elem.scale.set(1, m, 1);\n                }\n\n              });\n           }\n        },\n        initBars(){\n          BarNodes=range(0, 256).map(index => {\n            return new node(\n              20,\n              ((index / 256) * 360 + 45) % 360,\n              new THREE.Vector2(0, 0)\n            );\n          });\n          console.log(BarNodes);\n        },\n        //后期处理\n        initEffectComposer(){\n            composer=new EffectComposer(renderer);\n            var renderPass=new RenderPass(scene,camera);\n            composer.addPass(renderPass);\n            //RenderPass通常位于过程链的开始，以便将渲染好的场景作为输入来提供给下一个后期处理步骤。\n            //CopyShader是为了能将结果输出，普通的通道一般都是不能输出的，要靠CopyShader进行输出\n             const copyShader = new ShaderPass(CopyShader);\n            copyShader.renderToScreen = true;\n            //这个参数的目的是马上将当前的内容输出\n            this.initBloomPass();\n            composer.addPass(copyShader);\n        },\n        initBloomPass(){\n          let params = {\n            exposure: 0.5,\n            bloomStrength: 1,\n             bloomThreshold: 0,\n            bloomRadius: 0.8\n          };\n          let bloomPass=new UnrealBloomPass(\n            new THREE.Vector2(window.innerWidth*0.85,window.innerHeight*0.85),\n              1.5,\n              0.2,\n              0\n          );\n          bloomPass.threshold = params.bloomThreshold;\n          bloomPass.strength = params.bloomStrength;\n          bloomPass.radius = params.bloomRadius;\n          composer.addPass(bloomPass);\n\n        },\n      startplay(){\n        let that=this;\n        this.$bus.$on('playfile',(res)=>{\n          //console.log(res);\n          //that.isLoaded=false;\n          //每次导入改变值然后重新渲染\n          var JSONStr=JSON.stringify(res);\n          let file=new File([JSONStr],'scene.json',{\n            type: 'application/json',\n            lastModified: Date.now()\n          });\n          //组合成文件\n          let url = null ;\n          if (window.createObjectURL!=undefined) { // basic\n            url = window.createObjectURL(file) ;\n          } else if (window.URL!=undefined) { // mozilla(firefox)\n            url = window.URL.createObjectURL(file) ;\n          } else if (window.webkitURL!=undefined) { // webkit or chrome\n            url = window.webkitURL.createObjectURL(file) ;\n          }\n          var loader=new THREE.ObjectLoader();\n          loader.load(url,function (obj){\n            scene=obj;\n            scene.background=new THREE.Color( 0xDEE6E6 );\n            console.log(scene);\n            //that.initLight();\n            that.AnalysisLine();\n            that.initBars();\n            that.initEffectComposer();\n            //that.initStats();\n            // initDatGUI();\n            that.animate();\n          });\n\n        });\n      }\n\n    },\n    mounted() {\n        this.init();\n        this.GetAudioData();\n        this.GetState();\n        this.startplay();\n\n    },\n}\n</script>\n\n<style>\n\n</style>\n"]}]}