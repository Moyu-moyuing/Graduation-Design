{"remainingRequest":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\node_modules\\babel-loader\\lib\\index.js!E:\\wuhanligong-java\\music\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\wuhanligong-java\\music\\vue-admin-template-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\wuhanligong-java\\music\\vue-admin-template-master\\src\\views\\Editor\\Edit.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\src\\views\\Editor\\Edit.vue","mtime":1654439523906},{"path":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\babel.config.js","mtime":1637248914000},{"path":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\wuhanligong-java\\music\\vue-admin-template-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXktYnVmZmVyLnNsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmxvYXQzMi1hcnJheS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmNvcHktd2l0aGluLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZXZlcnkuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maWxsLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZpbmQtaW5kZXguanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuaW5kZXgtb2YuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmpvaW4uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5sYXN0LWluZGV4LW9mLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmVkdWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmVkdWNlLXJpZ2h0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmV2ZXJzZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNldC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc29tZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNvcnQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zdWJhcnJheS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnRvLWxvY2FsZS1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5qc29uLnN0cmluZ2lmeS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwudG8tanNvbi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnVybC1zZWFyY2gtcGFyYW1zLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0ICogYXMgVEhSRUUgZnJvbSAndGhyZWUvYnVpbGQvdGhyZWUubW9kdWxlLmpzJzsKaW1wb3J0IFN0YXRzIGZyb20gJy4uLy4uL3N0b3JlL1N0YXRzL3N0YXRzLm1pbi5qcyc7CmltcG9ydCBXaWRnZXQgZnJvbSAnLi4vRWRpdG9yL1dpZGdldC9XaWRnZXQudnVlJzsKaW1wb3J0IEF0dHJpYnV0ZSBmcm9tICcuLi9FZGl0b3IvQXR0cmlidXRlL2luZGV4LnZ1ZSc7CmltcG9ydCBGb290ZXIgZnJvbSAnLi4vRWRpdG9yL0Zvb3Rlci9pbmRleC52dWUnOwppbXBvcnQgeyBUcmFuc2Zvcm1Db250cm9scyB9IGZyb20gJ3RocmVlL2V4YW1wbGVzL2pzbS9jb250cm9scy9UcmFuc2Zvcm1Db250cm9scyc7CmltcG9ydCB7IERyYWdDb250cm9scyB9IGZyb20gJ3RocmVlL2V4YW1wbGVzL2pzbS9jb250cm9scy9EcmFnQ29udHJvbHMnOwppbXBvcnQgeyBUcmFja2JhbGxDb250cm9scyB9IGZyb20gJ3RocmVlL2V4YW1wbGVzL2pzbS9jb250cm9scy9UcmFja2JhbGxDb250cm9scyc7CmltcG9ydCB7IE9yYml0Q29udHJvbHMgfSBmcm9tICd0aHJlZS9leGFtcGxlcy9qc20vY29udHJvbHMvT3JiaXRDb250cm9scyc7CmltcG9ydCB7IENvbG9yLCBHcm91cCwgT2JqZWN0M0QgfSBmcm9tICcuLi8uLi9saWIvdGhyZWUubW9kdWxlLmpzJzsKaW1wb3J0IHsgTU9VU0UgfSBmcm9tICd0aHJlZS9zcmMvY29uc3RhbnRzJzsKaW1wb3J0IHsgQXhlc0hlbHBlciB9IGZyb20gJ3RocmVlL3NyYy9oZWxwZXJzL0F4ZXNIZWxwZXInOwppbXBvcnQgeyBHcmlkSGVscGVyIH0gZnJvbSAndGhyZWUvc3JjL2hlbHBlcnMvR3JpZEhlbHBlci5qcyc7CmltcG9ydCB7IEV2ZW50TWFuYWdlciB9IGZyb20gJy4uLy4uL2xpYi9FdmVudE1hbmFnZXInOwppbXBvcnQgeyBEaXJlY3Rpb25hbExpZ2h0SGVscGVyIH0gZnJvbSAndGhyZWUvc3JjL2hlbHBlcnMvRGlyZWN0aW9uYWxMaWdodEhlbHBlcic7CmltcG9ydCB7IHJhbmdlIH0gZnJvbSAiLi4vLi4vY29tcG9uZW50cy9tb2RlL3JhbmdlIjsKaW1wb3J0IHsgbm9kZSB9IGZyb20gIi4uLy4uL2NvbXBvbmVudHMvbW9kZS9ub2RlIjsgLy/liJ3lp4vmlbDmja4KCnZhciByZW5kZXJlciwgY2FtZXJhLCBzY2VuZSwgZ2VvbWV0cnksIG1hdGVyaWFsLCBtZXNoLCBzdGF0cywgb2JqczsgLy8gIGxldCBjb250YWluZXI9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dlYmdsJyk7Cgp2YXIgY29udHJvbHMgPSB7CiAgcG9zaXRpb25YOiAwLAogIHBvc2l0aW9uWTogMCwKICBwb3NpdGlvblo6IDAKfTsKdmFyIGNhbWVyYUNvbnRyb2xzOwp2YXIgdHJhbnNmb3JtQ29udHJvbDsKdmFyIGV2ZW50TWFuYWdlcjsKdmFyIGRpcmVjdGlvbmFsTGlnaHQsIGFtYmllbnRMaWdodDsKdmFyIGlkOyAvLyBsZXQgbW91c2U7Ci8vIGxldCByYXljYXN0ZXI7CgovKui/memHjOiusOW9leS4gOS4quWwj2J1ZwrlvZPmi5bmi73niankvZPnlaXov4flhbbku5bniankvZPkuIrml7bkvJrpgKDmiJDniankvZPlhajpu5EK5bqU6K+l5piv5p2Q6LSo6Zeu6aKY5L2/55So5LqG5rOV57q/5Y+Y5o2i6aKc6Imy5p2Q6LSo77yM5o2i5oiQ5q2j5bi46aKc6Imy5bqU6K+l5piv5rKh5pyJ6Zeu6aKYCgoqLwoKdmFyIHRyYW5zaW5nID0gZmFsc2U7CnZhciBheGVzSGVscGVyLCBncmlkSGVscGVyLCBkaXJlY3RMaWdodEhlbHBlcjsKdmFyIGNhY2hlb2JqZWN0czsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdFZGl0b3InLAogIGNvbXBvbmVudHM6IHsKICAgIFdpZGdldDogV2lkZ2V0LAogICAgQXR0cmlidXRlOiBBdHRyaWJ1dGUsCiAgICBGb290ZXI6IEZvb3RlcgogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHN0YXRlOiB7CiAgICAgICAgR3JpZEhlbHBlcjogdHJ1ZSwKICAgICAgICBBeGVzSGVscGVyOiB0cnVlLAogICAgICAgIExpZ2h0SGVscGVyOiB0cnVlLAogICAgICAgIFBsYW5lSGVscGVyOiBmYWxzZSwKICAgICAgICBCb3hIZWxwZXI6IGZhbHNlLAogICAgICAgIENvbnRyb2w6IHRydWUKICAgICAgfSwKICAgICAgY29uZmlndXJhdGlvbjoge30KICAgIH07CiAgfSwKICB3YXRjaDogewogICAgJ3N0YXRlLkdyaWRIZWxwZXInOiB7CiAgICAgIC8vIGltbWVkaWF0ZTp0cnVlLAogICAgICBkZWVwOiB0cnVlLAogICAgICBoYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGVyKG5ld1ZhbHVlKSB7CiAgICAgICAgaWYgKG5ld1ZhbHVlKSB7CiAgICAgICAgICB0aGlzLkFkZEdyaWQoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5SZW1vdmVHcmlkKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgJ3N0YXRlLkF4ZXNIZWxwZXInOiB7CiAgICAgIC8vIGltbWVkaWF0ZTp0cnVlLAogICAgICBkZWVwOiB0cnVlLAogICAgICBoYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGVyKG5ld1ZhbHVlKSB7CiAgICAgICAgaWYgKG5ld1ZhbHVlKSB7CiAgICAgICAgICB0aGlzLkFkZEF4ZXMoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5SZW1vdmVBeGVzKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgJ3N0YXRlLkxpZ2h0SGVscGVyJzogewogICAgICAvLyBpbW1lZGlhdGU6dHJ1ZSwKICAgICAgZGVlcDogdHJ1ZSwKICAgICAgaGFuZGxlcjogZnVuY3Rpb24gaGFuZGxlcihuZXdWYWx1ZSkgewogICAgICAgIGlmIChuZXdWYWx1ZSkgewogICAgICAgICAgdGhpcy5BZGRMaWdodCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLlJlbW92ZUxpZ2h0KCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgJ3N0YXRlLkNvbnRyb2wnOiB7CiAgICAgIC8vIGltbWVkaWF0ZTp0cnVlLAogICAgICBkZWVwOiB0cnVlLAogICAgICBoYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGVyKG5ld1ZhbHVlKSB7CiAgICAgICAgaWYgKG5ld1ZhbHVlKSB7CiAgICAgICAgICB0aGlzLkFkZENvbnRyb2woKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5SZW1vdmVDb250cm9sKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBpbml0c3RhdGU6IGZ1bmN0aW9uIGluaXRzdGF0ZSgpIHsKICAgICAgdGhpcy5zdGF0ZSA9IHsKICAgICAgICBHcmlkSGVscGVyOiB0cnVlLAogICAgICAgIEF4ZXNIZWxwZXI6IHRydWUsCiAgICAgICAgTGlnaHRIZWxwZXI6IHRydWUsCiAgICAgICAgUGxhbmVIZWxwZXI6IGZhbHNlLAogICAgICAgIEJveEhlbHBlcjogZmFsc2UsCiAgICAgICAgQ29udHJvbDogdHJ1ZQogICAgICB9OwogICAgfSwKICAgIEFkZE1vZGVsOiBmdW5jdGlvbiBBZGRNb2RlbCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHRoaXMuJGJ1cy4kb2ZmKCdBZGRPYmplY3RzJyk7IC8v6Ziy5q2i5aSa5qyh6Kem5Y+RYnVz5oC757q/CgogICAgICB0aGlzLiRidXMuJG9uKCdBZGRPYmplY3RzJywgZnVuY3Rpb24gKGVtLCBpdGVtKSB7CiAgICAgICAgaWYgKGl0ZW0ubmFtZSA9PSAn5Z+656GA5Yeg5L2V5qih5Z6LJyB8fCBpdGVtLm5hbWUgPT0gJzNE6Z+z5LmQ5qih5Z6LJykgewogICAgICAgICAgX3RoaXMuQWRkRWxlbWVudChlbS50eXBlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3RoaXMuTG9hZEVsZW1lbnQoZW0udHlwZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBmaW5kY3VycmVudE9iajogZnVuY3Rpb24gZmluZGN1cnJlbnRPYmooKSB7CiAgICAgIHZhciB0aGF0ID0gdGhpczsgLy/ph43lrprlkJF0aGlzLOWlveWIqeeUqOaAu+e6vwoKICAgICAgdGhpcy4kYnVzLiRvbigncmVxdWVzdE9iaicsIGZ1bmN0aW9uICh0YXJnZXQpIHsKICAgICAgICB2YXIgb2JqZWN0ID0gc2NlbmUuZ2V0T2JqZWN0QnlQcm9wZXJ0eSgndXVpZCcsIHRhcmdldC51dWlkKTsKICAgICAgICB0aGF0LiRidXMuJGVtaXQoJ3Jlc3BvbnNlT2JqJywgb2JqZWN0KTsKICAgICAgfSk7CiAgICB9LAogICAgQ2hlY2tGcm9tVHJlZTogZnVuY3Rpb24gQ2hlY2tGcm9tVHJlZSgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLiRidXMuJG9uKCdjaGVja0V2ZW50JywgZnVuY3Rpb24gKHRhcmdldCkgewogICAgICAgIGlmIChfdGhpczIuc3RhdGUuQ29udHJvbCA9PSB0cnVlKSB7CiAgICAgICAgICBpZiAoIXRhcmdldCkgewogICAgICAgICAgICAvL+WkhOeQhuWvueS6juS8oOi/h+adpeaYr+epuuebruagh+eahOaDheWGte+8jOebtOaOpeenu+mZpOaOp+S7tgogICAgICAgICAgICB0cmFuc2Zvcm1Db250cm9sLmRldGFjaCgpOwogICAgICAgICAgICBzY2VuZS5yZW1vdmUodHJhbnNmb3JtQ29udHJvbCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAodHJhbnNmb3JtQ29udHJvbC5vYmplY3QgJiYgdGFyZ2V0LnV1aWQgIT0gdHJhbnNmb3JtQ29udHJvbC5vYmplY3QudXVpZCkgewogICAgICAgICAgICAgIC8v5aaC5p6c5LuO5Zy65pmv57uT5p6E5qCR5Lit5b6X5Yiw55qE54mp5L2T5LiO55uu5YmN55qE5LiN5ZCM5omN6L+b6KGM5LqL5Lu25aSE55CGCiAgICAgICAgICAgICAgLy/ljbPmm7TmjaLlsITnur/mi77lj5YKICAgICAgICAgICAgICB0cmFuc2Zvcm1Db250cm9sLmRldGFjaCgpOwogICAgICAgICAgICAgIHNjZW5lLnJlbW92ZSh0cmFuc2Zvcm1Db250cm9sKTsgLy/lhYjliKDpmaTlvZPliY3mjqfku7blr7nosaEKCiAgICAgICAgICAgICAgc2NlbmUudHJhdmVyc2UoZnVuY3Rpb24gKG9iaikgewogICAgICAgICAgICAgICAgaWYgKG9iai51dWlkID09IHRhcmdldC51dWlkKSB7CiAgICAgICAgICAgICAgICAgIGlmIChvYmoudHlwZS5pbmRleE9mKCdIZWxwZXInKSA9PSAtMSkgewogICAgICAgICAgICAgICAgICAgIC8v5aaC5p6c5LiN5pivaGVscGVyCgogICAgICAgICAgICAgICAgICAgIC8qIOiDveWQpuebtOaOpeS8oHV1aWTov5vmnaXmn6XnhLblkI7kvKDlh7rljrvvvJ8KICAgICAgICAgICAgICAgICAgICAg6ZyA6KaB6YeN5p6ECiAgICAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgICAgICBzY2VuZS5hZGQodHJhbnNmb3JtQ29udHJvbCk7CiAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtQ29udHJvbC5hdHRhY2gob2JqKTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0cmFuc2Zvcm1Db250cm9sLmRldGFjaCgpOwogICAgICAgICAgICAgICAgICAgIHNjZW5lLnJlbW92ZSh0cmFuc2Zvcm1Db250cm9sKTsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgaWYgKCF0cmFuc2Zvcm1Db250cm9sLm9iamVjdCkgewogICAgICAgICAgICAgIC8v5aaC5p6c5o6n5Lu25pys6Lqr5LiN5a2Y5Zyo6YKj5LmI55u05o6l5YqgCiAgICAgICAgICAgICAgc2NlbmUudHJhdmVyc2UoZnVuY3Rpb24gKG9iaikgewogICAgICAgICAgICAgICAgaWYgKG9iai51dWlkID09IHRhcmdldC51dWlkKSB7CiAgICAgICAgICAgICAgICAgIC8v5ZCM5qC36ZyA6KaB5Yik5pat5piv5ZCm5pivaGVscGVyCiAgICAgICAgICAgICAgICAgIGlmIChvYmoudHlwZS5pbmRleE9mKCdIZWxwZXInKSA9PSAtMSkgewogICAgICAgICAgICAgICAgICAgIC8v5aaC5p6c5LiN5pivaGVscGVyCiAgICAgICAgICAgICAgICAgICAgc2NlbmUuYWRkKHRyYW5zZm9ybUNvbnRyb2wpOwogICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybUNvbnRyb2wuYXR0YWNoKG9iaik7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtQ29udHJvbC5kZXRhY2goKTsKICAgICAgICAgICAgICAgICAgICBzY2VuZS5yZW1vdmUodHJhbnNmb3JtQ29udHJvbCk7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgUmVtb3ZlR3JpZDogZnVuY3Rpb24gUmVtb3ZlR3JpZCgpIHsKICAgICAgc2NlbmUucmVtb3ZlKGdyaWRIZWxwZXIpOyAvL2NvbnNvbGUubG9nKHNjZW5lKTsKICAgIH0sCiAgICBBZGRHcmlkOiBmdW5jdGlvbiBBZGRHcmlkKCkgewogICAgICBzY2VuZS5hZGQoZ3JpZEhlbHBlcik7CiAgICB9LAogICAgUmVtb3ZlQXhlczogZnVuY3Rpb24gUmVtb3ZlQXhlcygpIHsKICAgICAgc2NlbmUucmVtb3ZlKGF4ZXNIZWxwZXIpOwogICAgfSwKICAgIEFkZEF4ZXM6IGZ1bmN0aW9uIEFkZEF4ZXMoKSB7CiAgICAgIHNjZW5lLmFkZChheGVzSGVscGVyKTsKICAgIH0sCiAgICBSZW1vdmVMaWdodDogZnVuY3Rpb24gUmVtb3ZlTGlnaHQoKSB7CiAgICAgIHNjZW5lLnJlbW92ZShkaXJlY3RMaWdodEhlbHBlcik7CiAgICB9LAogICAgQWRkTGlnaHQ6IGZ1bmN0aW9uIEFkZExpZ2h0KCkgewogICAgICBzY2VuZS5hZGQoZGlyZWN0TGlnaHRIZWxwZXIpOwogICAgfSwKICAgIFJlbW92ZUNvbnRyb2w6IGZ1bmN0aW9uIFJlbW92ZUNvbnRyb2woKSB7CiAgICAgIHRyYW5zZm9ybUNvbnRyb2wuZGV0YWNoKCk7CiAgICAgIHNjZW5lLnJlbW92ZSh0cmFuc2Zvcm1Db250cm9sKTsKICAgICAgdmFyIG9iamVjdCA9IG51bGw7CiAgICAgIHRoaXMuJGJ1cy4kZW1pdCgnZ2V0RXZlbnQnLCBvYmplY3QpOwogICAgfSwKICAgIEFkZENvbnRyb2w6IGZ1bmN0aW9uIEFkZENvbnRyb2woKSB7CiAgICAgIHNjZW5lLmFkZCh0cmFuc2Zvcm1Db250cm9sKTsKICAgIH0sCiAgICBBZGRIZWxwZXJBbmRDb250cm9sOiBmdW5jdGlvbiBBZGRIZWxwZXJBbmRDb250cm9sKCkgewogICAgICB0aGlzLkFkZEF4ZXMoKTsKICAgICAgdGhpcy5BZGRDb250cm9sKCk7CiAgICAgIHRoaXMuQWRkR3JpZCgpOwogICAgICB0aGlzLkFkZExpZ2h0KCk7CiAgICB9LAogICAgUmVtb3ZlSGVscGVyQW5kQ29udHJvbDogZnVuY3Rpb24gUmVtb3ZlSGVscGVyQW5kQ29udHJvbCgpIHsKICAgICAgdGhpcy5SZW1vdmVHcmlkKCk7CiAgICAgIHRoaXMuUmVtb3ZlQXhlcygpOwogICAgICB0aGlzLlJlbW92ZUxpZ2h0KCk7CiAgICAgIHRoaXMuUmVtb3ZlQ29udHJvbCgpOwogICAgfSwKICAgIGluaXRIZWxwZXI6IGZ1bmN0aW9uIGluaXRIZWxwZXIoKSB7CiAgICAgIC8v5Yqg5Z2Q5qCH6L206L6F5Yqp5bel5YW3CiAgICAgIGF4ZXNIZWxwZXIgPSBuZXcgQXhlc0hlbHBlcig1MDApOwoKICAgICAgYXhlc0hlbHBlci5yYXljYXN0ID0gZnVuY3Rpb24gKCkge307CgogICAgICBheGVzSGVscGVyLm5hbWUgPSAi5Z2Q5qCH6L20IjsKICAgICAgc2NlbmUuYWRkKGF4ZXNIZWxwZXIpOwogICAgICBncmlkSGVscGVyID0gbmV3IEdyaWRIZWxwZXIoNTAwLCA0MCwgJ3JnYigyMDAsMjAwLDIwMCknLCAncmdiKDEwMCwxMDAsMTAwKScpOwoKICAgICAgZ3JpZEhlbHBlci5yYXljYXN0ID0gZnVuY3Rpb24gKCkge307CgogICAgICBncmlkSGVscGVyLm5hbWUgPSAi572R5qC85p2/IjsKICAgICAgc2NlbmUuYWRkKGdyaWRIZWxwZXIpOyAvL+WwhuS4pOS4qui+heWKqeW3peWFt3JheWNhc3TlsITnur/mlrnms5Xnva7nqbrkvb/lvpflhbbnpoHnlKjlj5jmjaLmjqfku7YKCiAgICAgIGRpcmVjdExpZ2h0SGVscGVyID0gbmV3IERpcmVjdGlvbmFsTGlnaHRIZWxwZXIoZGlyZWN0aW9uYWxMaWdodCwgNyk7IC8vZGlyZWN0TGlnaHRIZWxwZXIucmF5Y2FzdD0oKT0+e307CgogICAgICBkaXJlY3RMaWdodEhlbHBlci5uYW1lID0gIuWumuWQkeWFieWKqeaJiyI7CiAgICAgIGRpcmVjdExpZ2h0SGVscGVyLnR5cGUgPSAiRGlydGVjdGlvbmFsTGlnaHRIZWxwZXIiOwogICAgICBzY2VuZS5hZGQoZGlyZWN0TGlnaHRIZWxwZXIpOwogICAgfSwKICAgIGluaXRDYW1lcmFDb250cm9sOiBmdW5jdGlvbiBpbml0Q2FtZXJhQ29udHJvbCgpIHsKICAgICAgY2FtZXJhQ29udHJvbHMgPSBuZXcgT3JiaXRDb250cm9scyhjYW1lcmEsIHJlbmRlcmVyLmRvbUVsZW1lbnQpOwogICAgICBjYW1lcmFDb250cm9scy5lbmFibGVEYW1waW5nID0gdHJ1ZTsKICAgICAgY2FtZXJhQ29udHJvbHMubW91c2VCdXR0b25zID0gewogICAgICAgIExFRlQ6IG51bGwsCiAgICAgICAgTUlERExFOiBNT1VTRS5ET0xMWSwKICAgICAgICBSSUdIVDogTU9VU0UuUk9UQVRFIC8v5bem6ZSu5LiN5o6n5Yi255u45py6CiAgICAgICAgLy/lj7PplK7mjqfliLbml4vovawKICAgICAgICAvL+S4remXtOmUruaOp+WItue8qeaUvgogICAgICAgIC8vY3RybCvlj7PplK7mjqfliLbnm7jmnLrlubPnp7sKCiAgICAgIH07CiAgICB9LAogICAgZ2V0UGFyZW50czogZnVuY3Rpb24gZ2V0UGFyZW50cyhvYmopIHsKICAgICAgaWYgKG9iai5wYXJlbnQpIHsKICAgICAgICBpZiAob2JqLnBhcmVudC50eXBlID09ICJTY2VuZSIpIHsKICAgICAgICAgIHJldHVybiBvYmo7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHdoaWxlIChvYmoucGFyZW50LnR5cGUgIT0gIlNjZW5lIikgewogICAgICAgICAgICBvYmogPSBvYmoucGFyZW50OwogICAgICAgICAgICBjb25zb2xlLmxvZyhvYmopOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBvYmo7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgaW5pdEV2ZW50TWFuYWdlcjogZnVuY3Rpb24gaW5pdEV2ZW50TWFuYWdlcigpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICBldmVudE1hbmFnZXIgPSBuZXcgRXZlbnRNYW5hZ2VyKHJlbmRlcmVyLmRvbUVsZW1lbnQsIHNjZW5lLCBjYW1lcmEsIG9ianMpOwogICAgICBldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgLy/lhajlsYBjYW52YXPop6blj5Hmi7/liLDniankvZPmjIfpkojpmJ/liJcKICAgICAgICBpZiAoZXZlbnQuaW50ZXJzZWN0aW9uLmxlbmd0aCkgewogICAgICAgICAgdmFyIG9iamVjdCA9IGV2ZW50LmludGVyc2VjdGlvblswXS5vYmplY3Q7CgogICAgICAgICAgaWYgKG9iamVjdCA9PSBjYWNoZW9iamVjdHMpIHsKICAgICAgICAgICAgLy/lpoLmnpzlvZPkuIvpvKDmoIfov5jlnKjlkIzkuIDkuKrniankvZPkuIvkuI3op6blj5Hku7vkvZXmk43kvZwKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfSBlbHNlIGlmIChvYmplY3QgIT0gY2FjaGVvYmplY3RzICYmIGNhY2hlb2JqZWN0cykgewogICAgICAgICAgICAvL+WmguaenOW9k+S4i+m8oOagh+S7juS4gOS4queJqeS9k+enu+WKqOWIsOWPpuS4gOS4queJqeS9k+aXtgogICAgICAgICAgICAvL+WFiOinpuWPkeminOiJsuaBouWkjeWGjeinpuWPkeWPmOiJsgogICAgICAgICAgICBjYWNoZW9iamVjdHMubWF0ZXJpYWwuY29sb3IubXVsdGlwbHlTY2FsYXIoMC41KTsgLy/ov5Tlm57ljp/mnaXpopzoibIKICAgICAgICAgIH0gLy/lpoLmnpzmnInmnZDotKgKCgogICAgICAgICAgaWYgKG9iamVjdC5tYXRlcmlhbCkgewogICAgICAgICAgICBvYmplY3QubWF0ZXJpYWwuY29sb3IubXVsdGlwbHlTY2FsYXIoMik7IC8v5Y+Y5LquCgogICAgICAgICAgICBjYWNoZW9iamVjdHMgPSBvYmplY3Q7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8v5aaC5p6c6byg5qCH56e75Yqo5Yiw5Zy65pmv56m655m95aSE5oGi5aSNCiAgICAgICAgICBpZiAoY2FjaGVvYmplY3RzKSB7CiAgICAgICAgICAgIGNhY2hlb2JqZWN0cy5tYXRlcmlhbC5jb2xvci5tdWx0aXBseVNjYWxhcigwLjUpOyAvL+i/lOWbnuWOn+adpeminOiJsgogICAgICAgICAgfQoKICAgICAgICAgIGNhY2hlb2JqZWN0cyA9IG51bGw7CiAgICAgICAgfQogICAgICB9KTsgLy8gLy/niankvZPmi77lj5bkuovku7blpITnkIYKCiAgICAgIGV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIGlmICh0cmFuc2luZykgewogICAgICAgICAgdHJhbnNpbmcgPSBmYWxzZTsKICAgICAgICAgIGNvbnNvbGUubG9nKHRyYW5zaW5nKTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGlmIChldmVudC5pbnRlcnNlY3Rpb24ubGVuZ3RoKSB7CiAgICAgICAgICB2YXIgb2JqZWN0ID0gZXZlbnQuaW50ZXJzZWN0aW9uWzBdLm9iamVjdDsKICAgICAgICAgIGNvbnNvbGUubG9nKGV2ZW50LmludGVyc2VjdGlvbik7CgogICAgICAgICAgaWYgKG9iamVjdC50eXBlID09ICJUcmFuc2Zvcm1Db250cm9sc1BsYW5lIikgewogICAgICAgICAgICAvL+WmguaenOmAieWPluWIsOaOp+WItuWZqOacrOi6q+ebtOaOpei3s+i/hwogICAgICAgICAgICB0cmFuc2Zvcm1Db250cm9sLmRldGFjaCgpOwogICAgICAgICAgICBzY2VuZS5yZW1vdmUodHJhbnNmb3JtQ29udHJvbCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvL+mAieWPluWIsOeJqeS9kwogICAgICAgICAgICBpZiAoX3RoaXMzLnN0YXRlLkNvbnRyb2wgPT0gdHJ1ZSkgewogICAgICAgICAgICAgIC8v5Y+q5pyJ5b2TQ29udHJvbOWxnuaAp+W8gOWQr+aXtuaJjeWQr+eUqHRyYW5zZm9ybUNvbnRyb2wKICAgICAgICAgICAgICAvL+S9huS4jeW9seWTjeaYvuekulRyZWXlvZPliY3ngrnkuq4KICAgICAgICAgICAgICBzY2VuZS5hZGQodHJhbnNmb3JtQ29udHJvbCk7IC8vdHJhbnNmb3JtQ29udHJvbC5hdHRhY2gob2JqZWN0LnBhcmVudCBpbnN0YW5jZW9mIFRIUkVFLkdyb3VwID8gb2JqZWN0LnBhcmVudCA6IG9iamVjdCk7CgogICAgICAgICAgICAgIHRyYW5zZm9ybUNvbnRyb2wuYXR0YWNoKF90aGlzMy5nZXRQYXJlbnRzKG9iamVjdCkpOwogICAgICAgICAgICB9IC8vbGV0IHV1aWQ9b2JqZWN0LnV1aWQ7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHV1aWQpOwoKCiAgICAgICAgICAgIF90aGlzMy4kYnVzLiRlbWl0KCdnZXRFdmVudCcsIF90aGlzMy5nZXRQYXJlbnRzKG9iamVjdCkpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvL+W9k+eCueWHu+WIsOWcuuaZr+epuueZveWkhOaXtuemgeeUqOWPr+aOp+S7tgogICAgICAgICAgdHJhbnNmb3JtQ29udHJvbC5kZXRhY2goKTsKICAgICAgICAgIHNjZW5lLnJlbW92ZSh0cmFuc2Zvcm1Db250cm9sKTsKICAgICAgICAgIHZhciBfb2JqZWN0ID0gbnVsbDsKCiAgICAgICAgICBfdGhpczMuJGJ1cy4kZW1pdCgnZ2V0RXZlbnQnLCBfb2JqZWN0KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8v5bCE57q/5ou+5Y+W5ZmoCiAgICBpbml0TGlnaHQ6IGZ1bmN0aW9uIGluaXRMaWdodCgpIHsKICAgICAgZGlyZWN0aW9uYWxMaWdodCA9IG5ldyBUSFJFRS5EaXJlY3Rpb25hbExpZ2h0KDB4ZmZmZmZmKTsgLy/mt7vliqDkuobkuIDkuKrnmb3oibLnmoTlubPooYzlhYkKCiAgICAgIGRpcmVjdGlvbmFsTGlnaHQucG9zaXRpb24uc2V0KDIwLCA1MCwgNTApOyAvL+iuvue9ruWFieeahOaWueWQkQoKICAgICAgZGlyZWN0aW9uYWxMaWdodC5uYW1lID0gIuW5s+ihjOWFiSI7CiAgICAgIHNjZW5lLmFkZChkaXJlY3Rpb25hbExpZ2h0KTsgLy/mt7vliqDliLDlnLrmma8KCiAgICAgIG9ianMucHVzaChkaXJlY3Rpb25hbExpZ2h0KTsKICAgICAgYW1iaWVudExpZ2h0ID0gbmV3IFRIUkVFLkFtYmllbnRMaWdodCgweDIyMjIyMik7CiAgICAgIGFtYmllbnRMaWdodC5uYW1lID0gIuWFqOWxgOWFiSI7IC8v5re75Yqg5LiA5Liq5YWo5bGA546v5aKD5YWJCgogICAgICBzY2VuZS5hZGQoYW1iaWVudExpZ2h0KTsKICAgICAgb2Jqcy5wdXNoKGFtYmllbnRMaWdodCk7CiAgICB9LAogICAgLy8gaW5pdFJheWNhc3RlcigpewogICAgLy8gICAgIC8vIHJheWNhc3Rlcj1uZXcgVEhSRUUuUmF5Y2FzdGVyKCk7CiAgICAvLyB9LAogICAgLy/lr7nosaHnvJPlrZjliJ3lp4vljJYKICAgIGluaXRDYWNoZTogZnVuY3Rpb24gaW5pdENhY2hlKCkgewogICAgICBjYWNoZW9iamVjdHMgPSBudWxsOwogICAgfSwKICAgIGluaXRDb250cm9sOiBmdW5jdGlvbiBpbml0Q29udHJvbCgpIHsKICAgICAgLy/lj6/op4bljJblj5jmjaLmjqfku7blr7nosaEKICAgICAgdHJhbnNmb3JtQ29udHJvbCA9IG5ldyBUcmFuc2Zvcm1Db250cm9scyhjYW1lcmEsIHJlbmRlcmVyLmRvbUVsZW1lbnQpOwogICAgICB0cmFuc2Zvcm1Db250cm9sLnR5cGUgPSAiVHJhbnNmb3JtQ29udHJvbCI7IC8vIHNjZW5lLmFkZCggdHJhbnNmb3JtQ29udHJvbCApOy8v5o6n5Lu25a+56LGh5re75Yqg5Yiw5Zy65pmv5a+56LGhCgogICAgICB0cmFuc2Zvcm1Db250cm9sLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlRG93bicsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIC8v5Yqg5LiA5Liq5Y+C5pWw5o6n5Yi26Ziy5q2i54K55Ye75LqL5Lu25ZKM5ouW5ou95LqL5Lu25Yay56qBCiAgICAgICAgdHJhbnNpbmcgPSB0cnVlOwogICAgICAgIGNvbnNvbGUubG9nKHRyYW5zaW5nKTsKICAgICAgfSk7IC8v6ZSu55uY5o6n5Yi25Y+v6KeG5YyW5Y+Y5o2i5o6n5Lu25Yqf6IO9CgogICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIGlmIChldmVudC5rZXkgPT0gJ2UnKSB7CiAgICAgICAgICAvL0XplK7nvKnmlL4KICAgICAgICAgIHRyYW5zZm9ybUNvbnRyb2wubW9kZSA9ICJzY2FsZSI7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBpZiAoZXZlbnQua2V5ID09ICdyJykgewogICAgICAgICAgLy9S6ZSu5peL6L2sCiAgICAgICAgICB0cmFuc2Zvcm1Db250cm9sLm1vZGUgPSAicm90YXRlIjsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGlmIChldmVudC5rZXkgPT0gJ3QnKSB7CiAgICAgICAgICAvL1TplK7lubPnp7sKICAgICAgICAgIHRyYW5zZm9ybUNvbnRyb2wubW9kZSA9ICJ0cmFuc2xhdGUiOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgTG9hZEVsZW1lbnQ6IGZ1bmN0aW9uIExvYWRFbGVtZW50KHR5cGUpIHsKICAgICAgc2NlbmUuYmFja2dyb3VuZCA9IG5ldyBUSFJFRS5DdWJlVGV4dHVyZUxvYWRlcigpLmxvYWQoW3JlcXVpcmUoJ0AvYXNzZXRzL3NreWJveC8nICsgdHlwZSArICcvTGVmdC5wbmcnKSwgcmVxdWlyZSgnQC9hc3NldHMvc2t5Ym94LycgKyB0eXBlICsgJy9SaWdodC5wbmcnKSwgcmVxdWlyZSgnQC9hc3NldHMvc2t5Ym94LycgKyB0eXBlICsgJy9VcC5wbmcnKSwgcmVxdWlyZSgnQC9hc3NldHMvc2t5Ym94LycgKyB0eXBlICsgJy9Eb3duLnBuZycpLCByZXF1aXJlKCdAL2Fzc2V0cy9za3lib3gvJyArIHR5cGUgKyAnL0Zyb250LnBuZycpLCByZXF1aXJlKCdAL2Fzc2V0cy9za3lib3gvJyArIHR5cGUgKyAnL0JhY2sucG5nJyldKTsKICAgIH0sCiAgICBBZGRFbGVtZW50OiBmdW5jdGlvbiBBZGRFbGVtZW50KHR5cGUpIHsKICAgICAgaWYgKHR5cGUgPT0gJ2xvbmVseVBsYW5ldCcpIHsKICAgICAgICB0aGlzLmluaXRCb3goKTsKICAgICAgfSBlbHNlIGlmICh0eXBlID09ICdiZXppZXJDdXJ2ZScpIHsKICAgICAgICB0aGlzLmluaXRDb25lKCk7CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSAnZXRoZXJlYVRvbmUnKSB7CiAgICAgICAgdGhpcy5pbml0Q3lsaW5kZXIoKTsKICAgICAgfSBlbHNlIGlmICh0eXBlID09ICdlbGVjdHJvbmljTXVzaWMnKSB7CiAgICAgICAgdGhpcy5pbml0U3BoZXJlKCk7CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSAnYmxhc3RTdWJ3b29mZXInKSB7CiAgICAgICAgdGhpcy5pbml0VG9ydXMoKTsKICAgICAgfSBlbHNlIGlmICh0eXBlID09ICdCYXJNb2RlbCcpIHsKICAgICAgICB0aGlzLmluaXRCYXJzKCk7CiAgICAgICAgdGhpcy5zY2VuZUNoYW5nZWRFdmVudCgpOwogICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gJ0xpbmVNb2RlbCcpIHsKICAgICAgICB0aGlzLmluaXRMaW5lKCk7CiAgICAgICAgdGhpcy5zY2VuZUNoYW5nZWRFdmVudCgpOwogICAgICB9CiAgICB9LAogICAgaW5pdEJveDogZnVuY3Rpb24gaW5pdEJveCgpIHsKICAgICAgdmFyIG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKCk7CiAgICAgIG1hdGVyaWFsLmNvbG9yID0gbmV3IENvbG9yKDAuOCwgMC4yLCAwLjIpOwogICAgICB2YXIgYm94ID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLkJveEdlb21ldHJ5KDUsIDUsIDUpLCBtYXRlcmlhbCk7CiAgICAgIGJveC5wb3NpdGlvbi5zZXQoLTUwLCAyMCwgMCk7CiAgICAgIGJveC5uYW1lID0gIuebkuWtkCI7CiAgICAgIHNjZW5lLmFkZChib3gpOwogICAgICBvYmpzLnB1c2goYm94KTsKICAgICAgdGhpcy5zY2VuZUNoYW5nZWRFdmVudCgpOwogICAgfSwKICAgIGluaXRDb25lOiBmdW5jdGlvbiBpbml0Q29uZSgpIHsKICAgICAgdmFyIG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKCk7CiAgICAgIG1hdGVyaWFsLmNvbG9yID0gbmV3IENvbG9yKDAuNywgMC42LCAwLjYpOwogICAgICB2YXIgY29uZSA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5Db25lR2VvbWV0cnkoNSwgMjAsIDMyKSwgbWF0ZXJpYWwpOwogICAgICBjb25lLnBvc2l0aW9uLnNldCgyMCwgMjAsIDApOwogICAgICBjb25lLm5hbWUgPSAi5ZyG6ZSlIjsKICAgICAgc2NlbmUuYWRkKGNvbmUpOwogICAgICBvYmpzLnB1c2goY29uZSk7CiAgICAgIHRoaXMuc2NlbmVDaGFuZ2VkRXZlbnQoKTsgLy9yZW5kZXJlci5yZW5kZXIoc2NlbmUsY2FtZXJhKTsvL+a4suafkwogICAgfSwKICAgIGluaXRDeWxpbmRlcjogZnVuY3Rpb24gaW5pdEN5bGluZGVyKCkgewogICAgICB2YXIgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoKTsKICAgICAgbWF0ZXJpYWwuY29sb3IgPSBuZXcgQ29sb3IoMC44LCAwLjcsIDAuMik7CiAgICAgIHZhciBjeWxpbmRlciA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5DeWxpbmRlckdlb21ldHJ5KDUsIDUsIDIwLCAzMiksIG1hdGVyaWFsKTsKICAgICAgY3lsaW5kZXIucG9zaXRpb24uc2V0KDUwLCAyMCwgMCk7CiAgICAgIGN5bGluZGVyLm5hbWUgPSAi5ZyG5p+xIjsKICAgICAgc2NlbmUuYWRkKGN5bGluZGVyKTsKICAgICAgb2Jqcy5wdXNoKGN5bGluZGVyKTsKICAgICAgdGhpcy5zY2VuZUNoYW5nZWRFdmVudCgpOyAvL3JlbmRlcmVyLnJlbmRlcihzY2VuZSxjYW1lcmEpOy8v5riy5p+TCiAgICB9LAogICAgaW5pdFNwaGVyZTogZnVuY3Rpb24gaW5pdFNwaGVyZSgpIHsKICAgICAgdmFyIG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKCk7CiAgICAgIG1hdGVyaWFsLmNvbG9yID0gbmV3IENvbG9yKDAuMiwgMC43LCAwLjIpOwogICAgICB2YXIgc3BoZXJlID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLlNwaGVyZUdlb21ldHJ5KDUsIDMyLCAzMiksIG1hdGVyaWFsKTsKICAgICAgc3BoZXJlLnBvc2l0aW9uLnNldCgtMjAsIC0yMCwgMCk7CiAgICAgIHNwaGVyZS5uYW1lID0gIueQgyI7CiAgICAgIHNjZW5lLmFkZChzcGhlcmUpOwogICAgICBvYmpzLnB1c2goc3BoZXJlKTsKICAgICAgdGhpcy5zY2VuZUNoYW5nZWRFdmVudCgpOwogICAgfSwKICAgIGluaXRUb3J1czogZnVuY3Rpb24gaW5pdFRvcnVzKCkgewogICAgICB2YXIgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoKTsKICAgICAgbWF0ZXJpYWwuY29sb3IgPSBuZXcgQ29sb3IoMC4zLCAwLjEsIDAuOSk7CiAgICAgIHZhciB0b3J1cyA9IG5ldyBUSFJFRS5NZXNoKG5ldyBUSFJFRS5Ub3J1c0dlb21ldHJ5KDEwLCAzLCAxNiwgMTAwKSwgbWF0ZXJpYWwpOwogICAgICB0b3J1cy5wb3NpdGlvbi5zZXQoNTAsIC0yMCwgMCk7CiAgICAgIHRvcnVzLm5hbWUgPSAi5ZyG546vIjsKICAgICAgc2NlbmUuYWRkKHRvcnVzKTsKICAgICAgb2Jqcy5wdXNoKHRvcnVzKTsKICAgICAgdGhpcy5zY2VuZUNoYW5nZWRFdmVudCgpOyAvL3JlbmRlcmVyLnJlbmRlcihzY2VuZSxjYW1lcmEpOy8v5riy5p+TCiAgICB9LAogICAgaW5pdDogZnVuY3Rpb24gaW5pdCgpIHsKICAgICAgdGhpcy5pbml0UmVuZGVyZXIoKTsKICAgICAgdGhpcy5pbml0U2NlbmUoKTsKICAgICAgdGhpcy5pbml0Q2FtZXJhKCk7CiAgICAgIHRoaXMuaW5pdExpZ2h0KCk7CiAgICAgIHRoaXMuaW5pdE1lc2goKTsgLy8gdGhpcy5pbml0UmF5Y2FzdGVyKCk7CgogICAgICB0aGlzLmluaXRDYWNoZSgpOwogICAgICB0aGlzLmluaXRDYW1lcmFDb250cm9sKCk7CiAgICAgIHRoaXMuaW5pdENvbnRyb2woKTsKICAgICAgdGhpcy5pbml0SGVscGVyKCk7CiAgICAgIHRoaXMud2F0Y2hIZWxwZXIoKTsgLy8gdGhpcy5pbml0TW91c2VFdmVudCgpOwoKICAgICAgdGhpcy5pbml0RXZlbnRNYW5hZ2VyKCk7CiAgICAgIHRoaXMuc2VuZGlkKCk7CiAgICAgIHRoaXMuaW5pdFN0YXRzKCk7IC8vIGluaXREYXRHVUkoKTsKCiAgICAgIHRoaXMuc2NlbmVDaGFuZ2VkRXZlbnQoKTsKICAgICAgdGhpcy5hbmltYXRlKCk7IC8vIGNvbnNvbGUubG9nKHNjZW5lKTsKICAgIH0sCiAgICB3YXRjaEhlbHBlcjogZnVuY3Rpb24gd2F0Y2hIZWxwZXIoKSB7CiAgICAgIHZhciBzdGF0ZSA9IHRoaXMuc3RhdGU7CiAgICAgIHRoaXMuJGJ1cy4kZW1pdCgnc3RhdGVDb250cm9sJywgc3RhdGUpOwogICAgfSwKICAgIHNjZW5lQ2hhbmdlZEV2ZW50OiBmdW5jdGlvbiBzY2VuZUNoYW5nZWRFdmVudCgpIHsKICAgICAgLy9yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5zY2VuZUNoYW5nZWRFdmVudCgpKTsKICAgICAgdmFyIHNjZW5lbGlzdCA9IHNjZW5lLmNoaWxkcmVuOwogICAgICB0aGlzLiRidXMuJGVtaXQoJ3NjZW5lQ2hhbmdlZCcsIHNjZW5lbGlzdCk7CiAgICB9LAogICAgLy/pvKDmoIfkuovliqHlpITnkIbvvIjljIXmi6zngrnlh7vkuovku7bjgIHnp7vliqjkuovku7bvvIkKICAgIC8vIGluaXRNb3VzZUV2ZW50KCl7CiAgICAvL+e7mWNhbnZhc+Wvueixoei/m+ihjOm8oOagh+WdkOagh+i9rOaNogogICAgLy8gbW91c2U9bmV3IFZlY3RvcjIoKTsKICAgIC8vIGxldCBkb21YPTA7CiAgICAvLyBsZXQgZG9tWT0wOwogICAgLy8gbGV0IHdpZHRoPTA7CiAgICAvLyBsZXQgaGVpZ2h0PTA7CiAgICAvLyByZW5kZXJlci5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsKGV2ZW50KT0+ewogICAgLy8gICAgIC8vY29uc29sZS5sb2coZXZlbnQub2Zmc2V0WCxldmVudC5vZmZzZXRZKTsKICAgIC8vICAgICBkb21YPWV2ZW50Lm9mZnNldFg7CiAgICAvLyAgICAgZG9tWT1ldmVudC5vZmZzZXRZOwogICAgLy8gICAgIHdpZHRoPXJlbmRlcmVyLmRvbUVsZW1lbnQub2Zmc2V0V2lkdGg7CiAgICAvLyAgICAgaGVpZ2h0PXJlbmRlcmVyLmRvbUVsZW1lbnQub2Zmc2V0SGVpZ2h0OwogICAgLy8gICAgIG1vdXNlLng9ZG9tWC93aWR0aCoyLTE7CiAgICAvLyAgICAgbW91c2UueT0tZG9tWSoyL2hlaWdodCsxOwogICAgLy8gICAgIC8vIGNvbnNvbGUubG9nKG1vdXNlLngsbW91c2UueSk7CiAgICAvLyAgICAgcmF5Y2FzdGVyLnNldEZyb21DYW1lcmEobW91c2UsY2FtZXJhKTsKICAgIC8vICAgICAvL+mYsuatouaOp+WItuWZqOiiq+mAieS4rQogICAgLy8gICAgIHNjZW5lLnJlbW92ZSh0cmFuc2Zvcm1Db250cm9sKTsKICAgIC8vICAgICBjb25zdCBpbnRlcnNlY3Rpb249cmF5Y2FzdGVyLmludGVyc2VjdE9iamVjdHMoc2NlbmUuY2hpbGRyZW4sZmFsc2UpOwogICAgLy8gICAgIC8v5oqK5omA5pyJ5pyJY2hpbGRyZW7nmoTlsY/olL3mjonvvIzlj6/ku6XpmLLmraLlr7loZWxwZXLov5vooYzmjqfliLYKICAgIC8vICAgICBzY2VuZS5hZGQodHJhbnNmb3JtQ29udHJvbCk7CiAgICAvLyAgICAgaWYoaW50ZXJzZWN0aW9uLmxlbmd0aCl7CiAgICAvLyAgICAgICAgIC8v5aaC5p6c5ou+5Y+W5Yiw5p2Q6LSo54mp5L2TCiAgICAvLyAgICAgICAgIGNvbnN0IG9iamVjdD1pbnRlcnNlY3Rpb25bMF0ub2JqZWN0OwogICAgLy8gICAgICAgICAvL+WmguaenOW9k+S4i+eJqeS9k+S4jeaYr+S4iuasoee8k+WtmOeJqeS9k++8jOivtOaYjuaYr+S7juS4jeWQjOeJqeS9k+S4iuenu+WIsOW9k+WJjeeJqeS9k+S4iuinpuWPkW1vdXNlZW50ZXLkuovku7YKICAgIC8vICAgICAgICAgaWYob2JqZWN0IT1jYWNoZW9iamVjdHMpewogICAgLy8gICAgICAgICAgICAgaWYoY2FjaGVvYmplY3RzKXsKICAgIC8vICAgICAgICAgICAgICAgICAvL+W9k+m8oOagh+S7juS4gOS4queJqeS9k+enu+WKqOWIsOWPpuS4gOS4queJqeS9k+aXtu+8jOWFiOinpuWPkeS5i+WJjee8k+WtmOeJqeS9k+eahG1vdXNlbGVhdmXmlrnms5UKICAgIC8vICAgICAgICAgICAgICAgICAvL+WGjeinpuWPkeW9k+WJjeeJqeS9k+eahG1vdXNlZW50ZXLmlrnms5UKICAgIC8vICAgICAgICAgICAgICAgICBjYWNoZW9iamVjdHMuZGlzcGF0Y2hFdmVudCh7CiAgICAvLyAgICAgICAgICAgICB0eXBlOidtb3VzZWxlYXZlJwogICAgLy8gICAgICAgICB9KTsKICAgIC8vICAgICAgICAgICAgIH0KICAgIC8vICAgICAgICAgICAgICAgb2JqZWN0LmRpc3BhdGNoRXZlbnQoewogICAgLy8gICAgICAgICAgICAgdHlwZTonbW91c2VlbnRlcicKICAgIC8vICAgICAgICAgfSk7CiAgICAvLyAgICAgICAgIH0vL+WmguaenOebuOetieinpuWPkW1vdXNlbW92ZeaWueazleW+l+WIsOeJqeS9k+WdkOaghyjpvKDmoIfkuIDnm7TlnKjniankvZPkuIrnp7vliqgpCiAgICAvLyAgICAgICAgIGVsc2UgaWYob2JqZWN0PT1jYWNoZW9iamVjdHMpewogICAgLy8gICAgICAgICAgICAgb2JqZWN0LmRpc3BhdGNoRXZlbnQoewogICAgLy8gICAgICAgICAgICAgdHlwZTonbW91c2Vtb3ZlJwogICAgLy8gICAgICAgICB9KTsKICAgIC8vICAgICAgICAgfQogICAgLy8gICAgICAgICBjYWNoZW9iamVjdHM9b2JqZWN0OwogICAgLy8gICAgIH1lbHNlewogICAgLy8gICAgICAgICAvL+W9k+m8oOagh+S7juS4gOS4queJqeS9k+enu+WKqOWIsOWwhOe6v+aLvuWPluWZqOaLvuWPluS4jeWIsOeJqeS9k+aXtuS5n+S8muinpuWPkeS5i+WJjeeahOeJqeS9k+eahG1vdXNlbGVhdmXmlrnms5UKICAgIC8vICAgICAgICAgIGlmKGNhY2hlb2JqZWN0cyl7CiAgICAvLyAgICAgICAgICAgICAgICAgLy/lvZPpvKDmoIfku47kuIDkuKrniankvZPnp7vliqjliLDlj6bkuIDkuKrniankvZPml7bvvIzlhYjop6blj5HkuYvliY3nvJPlrZjniankvZPnmoRtb3VzZWxlYXZl5pa55rOVCiAgICAvLyAgICAgICAgICAgICAgICAgLy/lho3op6blj5HlvZPliY3niankvZPnmoRtb3VzZWVudGVy5pa55rOVCiAgICAvLyAgICAgICAgICAgICAgICAgY2FjaGVvYmplY3RzLmRpc3BhdGNoRXZlbnQoewogICAgLy8gICAgICAgICAgICAgdHlwZTonbW91c2VsZWF2ZScKICAgIC8vICAgICAgICAgfSk7CiAgICAvLyAgICAgfQogICAgLy8gICAgICAgICBjYWNoZW9iamVjdHM9bnVsbDsKICAgIC8vICAgICB9CiAgICAvLyB9KTsKICAgIC8vIC8vIC8v54mp5L2T5ou+5Y+W5LqL5Lu25aSE55CGCiAgICAvLyByZW5kZXJlci5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoZXZlbnQpPT57CiAgICAvLyAgICAgaWYodHJhbnNpbmcpewogICAgLy8gICAgICAgICB0cmFuc2luZz1mYWxzZTsKICAgIC8vICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgLy8gICAgIH0KICAgIC8vICAgICAvLyByYXljYXN0ZXIuc2V0RnJvbUNhbWVyYShtb3VzZSxjYW1lcmEpOwogICAgLy8gICAgIC8vIC8v6Ziy5q2i5o6n5Yi25Zmo6KKr6YCJ5LitCiAgICAvLyAgICAgLy8gc2NlbmUucmVtb3ZlKHRyYW5zZm9ybUNvbnRyb2wpOwogICAgLy8gICAgIC8vIGNvbnN0IGludGVyc2VjdGlvbj1yYXljYXN0ZXIuaW50ZXJzZWN0T2JqZWN0cyhzY2VuZS5jaGlsZHJlbixmYWxzZSk7CiAgICAvLyAgICAgLy8gLy/miormiYDmnInmnIljaGlsZHJlbueahOWxj+iUveaOie+8jOWPr+S7pemYsuatouWvuWhlbHBlcui/m+ihjOaOp+WItgogICAgLy8gICAgIC8vIHNjZW5lLmFkZCh0cmFuc2Zvcm1Db250cm9sKTsKICAgIC8vICAgICAvLyBpZihpbnRlcnNlY3Rpb24ubGVuZ3RoKXsKICAgIC8vICAgICAvLyAgICAgY29uc3Qgb2JqZWN0PWludGVyc2VjdGlvblswXS5vYmplY3Q7CiAgICAvLyAgICAgLy8gICAgIHRyYW5zZm9ybUNvbnRyb2wuYXR0YWNoKG9iamVjdCk7CiAgICAvLyAgICAgLy8gfWVsc2V7CiAgICAvLyAgICAgLy8gICAgIC8v5b2T54K55Ye75Yiw5Zy65pmv56m655m95aSE5pe256aB55So5Y+v5o6n5Lu2CiAgICAvLyAgICAgLy8gICAgdHJhbnNmb3JtQ29udHJvbC5kZXRhY2goKTsKICAgIC8vICAgICAvLyB9CiAgICAvLyB9KTsKICAgIC8vIH0sCiAgICBpbml0U3RhdHM6IGZ1bmN0aW9uIGluaXRTdGF0cygpIHsKICAgICAgc3RhdHMgPSBuZXcgU3RhdHMoKTsKICAgICAgc3RhdHMuZG9tRWxlbWVudC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7IC8v57ud5a+55Z2Q5qCHCgogICAgICBzdGF0cy5kb21FbGVtZW50LnN0eWxlLmxlZnQgPSAnMHB4JzsgLy8gKDAsMClweCzlt6bkuIrop5IKCiAgICAgIHN0YXRzLmRvbUVsZW1lbnQuc3R5bGUudG9wID0gJzBweCc7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3ZWJnbCcpLmFwcGVuZENoaWxkKHN0YXRzLmRvbUVsZW1lbnQpOwogICAgfSwKICAgIHVwZGF0ZVBvc2l0aW9uOiBmdW5jdGlvbiB1cGRhdGVQb3NpdGlvbigpIHsKICAgICAgbWVzaC5wb3NpdGlvbi5zZXQoY29udHJvbHMucG9zaXRpb25YLCBjb250cm9scy5wb3NpdGlvblksIGNvbnRyb2xzLnBvc2l0aW9uWik7CiAgICB9LAogICAgLy/liJ3lp4vljJbmuLLmn5PlmagKICAgIGluaXRSZW5kZXJlcjogZnVuY3Rpb24gaW5pdFJlbmRlcmVyKCkgewogICAgICByZW5kZXJlciA9IG5ldyBUSFJFRS5XZWJHTFJlbmRlcmVyKHsKICAgICAgICBhbnRpYWxpYXM6IHRydWUKICAgICAgfSk7IC8v5a6e5L6L5YyW5riy5p+T5ZmoCiAgICAgIC8v5oqX6ZSv6b2/5byA5ZCvCgogICAgICByZW5kZXJlci5zZXRTaXplKHdpbmRvdy5pbm5lcldpZHRoICogMC43LCB3aW5kb3cuaW5uZXJIZWlnaHQgKiAwLjcpOyAvL+iuvue9ruWuvemrmAoKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dlYmdsJykuYXBwZW5kQ2hpbGQocmVuZGVyZXIuZG9tRWxlbWVudCk7IC8v5re75Yqg5YiwZG9tCiAgICB9LAogICAgLy/liJ3lp4vljJblnLrmma8KICAgIGluaXRTY2VuZTogZnVuY3Rpb24gaW5pdFNjZW5lKCkgewogICAgICBzY2VuZSA9IG5ldyBUSFJFRS5TY2VuZSgpOyAvL+WunuS+i+WMluWcuuaZrwoKICAgICAgb2JqcyA9IFtdOwogICAgICBzY2VuZS5iYWNrZ3JvdW5kID0gbmV3IFRIUkVFLkN1YmVUZXh0dXJlTG9hZGVyKCkubG9hZChbcmVxdWlyZSgnQC9hc3NldHMvc2t5Ym94L0dhbGF4eS9MZWZ0LnBuZycpLCByZXF1aXJlKCdAL2Fzc2V0cy9za3lib3gvR2FsYXh5L1JpZ2h0LnBuZycpLCByZXF1aXJlKCdAL2Fzc2V0cy9za3lib3gvR2FsYXh5L1VwLnBuZycpLCByZXF1aXJlKCdAL2Fzc2V0cy9za3lib3gvR2FsYXh5L0Rvd24ucG5nJyksIHJlcXVpcmUoJ0AvYXNzZXRzL3NreWJveC9HYWxheHkvRnJvbnQucG5nJyksIHJlcXVpcmUoJ0AvYXNzZXRzL3NreWJveC9HYWxheHkvQmFjay5wbmcnKV0pOyAvLyB0aGlzLiRidXMuJGVtaXQoJ3NjZW5lQ2hhbmdlZCcsc2NlbmUpOwogICAgfSwKICAgIC8v5Yid5aeL5YyW55u45py6CiAgICBpbml0Q2FtZXJhOiBmdW5jdGlvbiBpbml0Q2FtZXJhKCkgewogICAgICBjYW1lcmEgPSBuZXcgVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEoNDUsIHdpbmRvdy5pbm5lcldpZHRoIC8gd2luZG93LmlubmVySGVpZ2h0LCAwLjEsIDIwMCk7IC8v5a6e5L6L5YyW55u45py644CRCgogICAgICBjYW1lcmEucG9zaXRpb24uc2V0KDAsIDAsIDE1MCk7CiAgICB9LAogICAgLy/liJvlu7rmqKHlnosKICAgIGluaXRNZXNoOiBmdW5jdGlvbiBpbml0TWVzaCgpIHsKICAgICAgLy8gZ2VvbWV0cnkgPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkoNSwgNSwgNSApOyAvL+WIm+W7uuWHoOS9leS9kwogICAgICAvLyB2YXIgbWF0ZXJpYWw9bmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKCk7CiAgICAgIC8vIG1hdGVyaWFsLmNvbG9yPW5ldyBDb2xvcigwLjcsMC4yLDAuMik7IC8v5Yib5bu65p2Q6LSoCiAgICAgIC8vIG1lc2ggPSBuZXcgVEhSRUUuTWVzaCggZ2VvbWV0cnksIG1hdGVyaWFsICk7IC8v5Yib5bu6572R5qC8CiAgICAgIC8vIG1lc2gubmFtZT0i55uS5a2QIjsKICAgICAgLy8gc2NlbmUuYWRkKCBtZXNoICk7IC8v5bCG572R5qC85re75Yqg5Yiw5Zy65pmvCiAgICAgIC8vIHRoaXMuaW5pdENvbmUoKTsKICAgICAgLy8gdGhpcy5pbml0Qm94KCk7CiAgICAgIHRoaXMuaW5pdExpbmUoKTsKICAgICAgdGhpcy5pbml0QmFycygpOwogICAgfSwKICAgIGluaXRCYXJzOiBmdW5jdGlvbiBpbml0QmFycygpIHsKICAgICAgdGhpcy5hdWRpb0JhcnMoMjUsIDEyOCk7CiAgICB9LAogICAgYXVkaW9CYXJzOiBmdW5jdGlvbiBhdWRpb0JhcnMocmFkaXVzLCBjb3VudERhdGEpIHsKICAgICAgdmFyIGJhckdyb3VwID0gbmV3IFRIUkVFLkdyb3VwKCk7CiAgICAgIHZhciBSID0gcmFkaXVzOwogICAgICB2YXIgTiA9IGNvdW50RGF0YTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgTjsgaSsrKSB7CiAgICAgICAgdmFyIG1pbkdyb3VwID0gbmV3IFRIUkVFLkdyb3VwKCk7CiAgICAgICAgdmFyIGJveCA9IG5ldyBUSFJFRS5Cb3hHZW9tZXRyeSgxLCAxLCAxKTsKCiAgICAgICAgdmFyIF9tYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoUGhvbmdNYXRlcmlhbCh7CiAgICAgICAgICBjb2xvcjogMHgwMGZmZmYKICAgICAgICB9KTsgLy8g5p2Q6LSo5a+56LGhCgoKICAgICAgICB2YXIgbSA9IGk7CgogICAgICAgIHZhciBfbWVzaCA9IG5ldyBUSFJFRS5NZXNoKGJveCwgX21hdGVyaWFsKTsKCiAgICAgICAgX21lc2gucG9zaXRpb24ueSA9IDAuNTsKICAgICAgICBtaW5Hcm91cC5hZGQoX21lc2gpOwogICAgICAgIG1pbkdyb3VwLnBvc2l0aW9uLnNldChNYXRoLnNpbihtICogTWF0aC5QSSAvIE4gKiAyKSAqIFIsIE1hdGguY29zKG0gKiBNYXRoLlBJIC8gTiAqIDIpICogUiwgMCk7CiAgICAgICAgbWluR3JvdXAucm90YXRpb24ueiA9IC1tICogTWF0aC5QSSAvIE4gKiAyOwogICAgICAgIGJhckdyb3VwLmFkZChtaW5Hcm91cCk7CiAgICAgIH0KCiAgICAgIGJhckdyb3VwLm5hbWUgPSAi6Z+z6aKR6LCxIjsKICAgICAgYmFyR3JvdXAudHlwZSA9ICJCYXJHcm91cCI7CiAgICAgIHNjZW5lLmFkZChiYXJHcm91cCk7CiAgICAgIG9ianMucHVzaChiYXJHcm91cCk7CiAgICB9LAoKICAgIC8qIOi/memHjOacieS4quWOn+eQhu+8jOS4uuS7gOS5iOWvuemfs+mikee6v+WSjOmfs+mikee7hOi/m+ihjOenu+WKqOaXi+i9rOaTjeS9nOWQjiDkvp3nhLblj6/ku6XmoLnmja7liJ3lp4vljJbnmoTpn7PpopHmlbDmja7ov5vooYzph43nlLsKICAgIOaMieWOn+eQhuadpeivtOW6lOivpeimgemHjeaWsOiuoeeul+WQhOS4que6v+auteeahOWdkOagh+WAvOi/m+ihjOmHjee7mO+8jOS4uuS7gOS5iOi/memHjOWvvOWHuuaVsOaNruWQjuS+neeEtuWPr+S7peWIqeeUqOWIneWni+WMlueahAogICAgYmFyTm9kZXPov5vooYzkuIDkuKrnur/mrrXorqHnrpfph43lm57lkKfvvIzljp/lm6DmmK/lm6DkuLrvvIzlnKjnvJbovpHlmajkuK3lr7nkuIDkuKrnu4Tlr7nosaHov5vooYzmk43kvZzml7bvvIzlhbblkITlrZDlr7nosaEKICAgIOeahOWdkOagh+W5tuS4jeS8muWPmOWMlu+8jOWPquaUueWPmOi/meS4que7hOWvueixoeeahOS9jee9ruOAgeaXi+i9rOetieS/oeaBr++8jOWFtuWtkOWvueixoeeahOWdkOagh+S4gOebtOaYr+ebuOWvueS6juWFtueItuWvueixoeeahAogICAg5Z2Q5qCH5Y2z5pys5Zyw5Z2Q5qCH77yM6ICM6Z2e5LiW55WM5Z2Q5qCH77yM5Y+q5pyJ5b2T54i25a+56LGh5pivc2NlbmXlnLrmma/ml7bvvIzmnKzlnLDlnZDmoIfmiY3nrYnkuo7kuJbnlYzlnZDmoIcKICAgICAqLwogICAgaW5pdExpbmU6IGZ1bmN0aW9uIGluaXRMaW5lKCkgewogICAgICB0aGlzLmF1ZGlvTGluZXMoMjAsIDI1Nik7CiAgICB9LAogICAgcmVuZGVyR2VvbWV0cmllczogZnVuY3Rpb24gcmVuZGVyR2VvbWV0cmllcyh2ZXJ0aWNlcykgewogICAgICB2YXIgcmVzID0gW107CiAgICAgIHZlcnRpY2VzID0gdmVydGljZXMuY29uY2F0KHZlcnRpY2VzWzBdKTsgLy/lkIjlubbmlbDnu4TvvIzmiorph4zlpJbkvY3nva7lkYrnn6XopoHnlLvnmoTnur8KCiAgICAgIHZlcnRpY2VzLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgcmVzLnB1c2godmFsdWUueCwgdmFsdWUueSwgMCk7CiAgICAgIH0pOwogICAgICByZXR1cm4gbmV3IFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZShuZXcgRmxvYXQzMkFycmF5KHJlcyksIDMpOwogICAgfSwKICAgIGF1ZGlvTGluZXM6IGZ1bmN0aW9uIGF1ZGlvTGluZXMocmFkaXVzLCBjb3VudERhdGEpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB2YXIgYmFyTm9kZXMgPSByYW5nZSgwLCBjb3VudERhdGEpLm1hcChmdW5jdGlvbiAoaW5kZXgpIHsKICAgICAgICByZXR1cm4gbmV3IG5vZGUocmFkaXVzLCAoaW5kZXggLyBjb3VudERhdGEgKiAzNjAgKyA0NSkgJSAzNjAsIG5ldyBUSFJFRS5WZWN0b3IyKDAsIDApKTsKICAgICAgfSk7IC8v5b6X5Yiw5LiA5Liq6K6w5b2V5ZyG5LiKMjU25Liq54K555qE5L2N572u5L+h5oGv55qE5pWw57uECgogICAgICB2YXIgbGluZU1hdGVyaWFsID0gbmV3IFRIUkVFLkxpbmVCYXNpY01hdGVyaWFsKHsKICAgICAgICBjb2xvcjogMHgwMGZmZmYKICAgICAgfSk7CiAgICAgIHZhciBiYXJMaW5lID0gcmFuZ2UoMCwgY291bnREYXRhKS5tYXAoZnVuY3Rpb24gKGluZGV4KSB7CiAgICAgICAgcmV0dXJuIG5ldyBUSFJFRS5MaW5lKG5ldyBUSFJFRS5CdWZmZXJHZW9tZXRyeSgpLnNldEF0dHJpYnV0ZSgicG9zaXRpb24iLCBfdGhpczQucmVuZGVyR2VvbWV0cmllcyhbYmFyTm9kZXNbaW5kZXhdLnBvc2l0aW9uQSgpLCBiYXJOb2Rlc1tpbmRleF0ucG9zaXRpb25CKCldKSksIGxpbmVNYXRlcmlhbCk7CiAgICAgIH0pOwogICAgICB2YXIgb3V0TGluZSA9IG5ldyBUSFJFRS5MaW5lKG5ldyBUSFJFRS5CdWZmZXJHZW9tZXRyeSgpLnNldEF0dHJpYnV0ZSgicG9zaXRpb24iLCB0aGlzLnJlbmRlckdlb21ldHJpZXMoYmFyTm9kZXMubWFwKGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgcmV0dXJuIG5vZGUucG9zaXRpb25BKCk7CiAgICAgIH0pKSksIGxpbmVNYXRlcmlhbCk7CiAgICAgIHZhciBpbkxpbmUgPSBuZXcgVEhSRUUuTGluZShuZXcgVEhSRUUuQnVmZmVyR2VvbWV0cnkoKS5zZXRBdHRyaWJ1dGUoInBvc2l0aW9uIiwgdGhpcy5yZW5kZXJHZW9tZXRyaWVzKGJhck5vZGVzLm1hcChmdW5jdGlvbiAobm9kZSkgewogICAgICAgIHJldHVybiBub2RlLnBvc2l0aW9uQigpOwogICAgICB9KSkpLCBsaW5lTWF0ZXJpYWwpOwogICAgICB2YXIgbGluZXNHcm91cCA9IG5ldyBUSFJFRS5Hcm91cCgpOwogICAgICBsaW5lc0dyb3VwLmFkZChvdXRMaW5lKTsKICAgICAgbGluZXNHcm91cC5hZGQoaW5MaW5lKTsKICAgICAgYmFyTGluZS5mb3JFYWNoKGZ1bmN0aW9uIChsaW5lKSB7CiAgICAgICAgcmV0dXJuIGxpbmVzR3JvdXAuYWRkKGxpbmUpOwogICAgICB9KTsKICAgICAgbGluZXNHcm91cC5uYW1lID0gIumfs+mikee6vyI7CiAgICAgIGxpbmVzR3JvdXAudHlwZSA9ICJMaW5lR3JvdXAiOwogICAgICBzY2VuZS5hZGQobGluZXNHcm91cCk7CiAgICAgIG9ianMucHVzaChsaW5lc0dyb3VwKTsKICAgIH0sCiAgICB1cGRhdGU6IGZ1bmN0aW9uIHVwZGF0ZSgpIHsKICAgICAgc3RhdHMudXBkYXRlKCk7CiAgICB9LAogICAgUmVzZXQ6IGZ1bmN0aW9uIFJlc2V0KCkge30sCiAgICBSZXNldEFsbDogZnVuY3Rpb24gUmVzZXRBbGwoKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgdGhpcy4kYnVzLiRvbigncmVzZXQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXM1LlJlc2V0KCk7CiAgICAgIH0pOwogICAgfSwKICAgIEV4cG9ydDogZnVuY3Rpb24gRXhwb3J0KCkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAgIHZhciB0aGF0ID0gdGhpczsKICAgICAgdGhpcy4kYnVzLiRvbignZXhwb3J0JywgZnVuY3Rpb24gKCkgewogICAgICAgIC8vIGlmKHNjZW5lLmNoaWxkcmVuLmxlbmd0aD4wKXsKICAgICAgICAvLyAgICAgbGV0IG9iajsKICAgICAgICAvLyAgICAgLy/liKDpmaTmiYDmnIloZWxwZXLvvIzlj6rkv53nlZnlhYnmupDjgIHmnZDotKgKICAgICAgICAvLyAgICAgZm9yKHZhciBpPXNjZW5lLmNoaWxkcmVuLmxlbmd0aC0xO2k+PTA7aS0tKXsKICAgICAgICAvLwogICAgICAgIC8vICAgICAgICAgIG9iaj1zY2VuZS5jaGlsZHJlbltpXTsKICAgICAgICAvLyAgICAgICAgIGlmKG9iai50eXBlLmluZGV4T2YoJ0hlbHBlcicpIT0tMXx8b2JqLnR5cGUuaW5kZXhPZignQ29udHJvbCcpIT0tMSl7CiAgICAgICAgLy8gICAgICAgICAgICAgIHNjZW5lLnJlbW92ZShvYmopOwogICAgICAgIC8vICAgICAgICAgfQogICAgICAgIC8vICAgICB9CiAgICAgICAgLy8gfQogICAgICAgIHRoYXQuUmVtb3ZlSGVscGVyQW5kQ29udHJvbCgpOyAvL+WboOS4uuavj+asoei/reS7o+S4rS5jaGlsZHJlbiDkuIDml6ZyZW1vdmXlkI7ku47lpLTlvIDlp4vmiafooYwKICAgICAgICAvL+aVsOe7hOS8muaUueWPmO+8jOWboOatpOS9v+eUqOmBjeWOhueahGZvckVhY2jkuZ/lpb3vvIx0cmF2ZXJzZeS5n+WlveaVsOe7hOeahAogICAgICAgIC8v57Si5byV5YWo6YO95pS55Y+Y77yM5Y+q5Lya5Yig6Zmk5LiA5Liq5a+56LGhCiAgICAgICAgLy/kvYblpoLmnpzku47lkI7lvIDlp4vpgY3ljobliKDpmaTvvIzmr4/mrKFyZW1vdmXlkI7liY3pnaLnmoTntKLlvJXkuZ/ljbPmmK/mnKrpgY3ljobov4fnmoToioLngrnntKLlvJXkuI3kvJrlj5gKICAgICAgICAvL+S9v+eUqHN0YXRl5YC854S25ZCO6L+b6KGM5rex5bqm55uR5ZCs5L6d54S25LiN6KGM77yM5Zug5Li6d2F0Y2jmlrnms5Xmr4/mrKHlnKhtb3VudGVk5LmL5ZCOCiAgICAgICAgLy/ov5nlsLHlr7zoh7TkuoblpoLmnpxtb3VudGVk5Lit55qEZGF0YeWAvOWPmOWMlu+8jOaIkemcgOimgeWvvOWHuueahOaVsOaNrui/mOaYr+WOn+adpeaVsOaNru+8jHdhdGNo5Y+q5Lya5Zyo5LmL5ZCOCiAgICAgICAgLy/lj5HnlJ/kvZznlKjjgIIKCiAgICAgICAgdmFyIEpTT05TdHIgPSBKU09OLnN0cmluZ2lmeShzY2VuZS50b0pTT04oKSk7CgogICAgICAgIF90aGlzNi5kb3dubG9hZCgic2NlbmUuanNvbiIsIEpTT05TdHIpOwoKICAgICAgICB0aGF0LkFkZEhlbHBlckFuZENvbnRyb2woKTsKICAgICAgfSk7CiAgICB9LAogICAgZG93bmxvYWQ6IGZ1bmN0aW9uIGRvd25sb2FkKGZpbGVuYW1lLCB0ZXh0KSB7CiAgICAgIHZhciBwb20gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CiAgICAgIHBvbS5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCAnZGF0YTp0ZXh0L3BsYWluO2NoYXJzZXQ9dXRmLTgsJyArIGVuY29kZVVSSUNvbXBvbmVudCh0ZXh0KSk7CiAgICAgIHBvbS5zZXRBdHRyaWJ1dGUoJ2Rvd25sb2FkJywgZmlsZW5hbWUpOwoKICAgICAgaWYgKGRvY3VtZW50LmNyZWF0ZUV2ZW50KSB7CiAgICAgICAgdmFyIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ01vdXNlRXZlbnRzJyk7CiAgICAgICAgZXZlbnQuaW5pdE1vdXNlRXZlbnQoJ2NsaWNrJywgdHJ1ZSwgZmFsc2UsIHdpbmRvdywgMCwgMCwgMCwgMCwgMCwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIDAsIG51bGwpOwogICAgICAgIHBvbS5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBwb20uY2xpY2soKTsKICAgICAgfQogICAgfSwKICAgIC8v6L+Q6KGM5Yqo55S7CiAgICBhbmltYXRlOiBmdW5jdGlvbiBhbmltYXRlKCkgewogICAgICBpZCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLmFuaW1hdGUpOyAvL+W+queOr+iwg+eUqOWHveaVsAogICAgICAvLyBtZXNoLnJvdGF0aW9uLngrPTAuMDE7CiAgICAgIC8vIC8vIC8v5q+P5bin572R5qC85qih5Z6L5rK/eOi9tOaXi+i9rDAuMDHlvKfluqYKICAgICAgLy8gbWVzaC5yb3RhdGlvbi55Kz0wLjAyOwogICAgICAvLyAvL+avj+W4p+e9keagvOaooeWei+ayv3novbTml4vovawwLjAy5byn5bqmCiAgICAgIC8vIC8vc3RhdHMudXBkYXRlKCk7Ly/mm7TmlrDmgKfog73mo4DmtYvmoYYKCiAgICAgIHRoaXMudXBkYXRlKCk7CiAgICAgIHJlbmRlcmVyLnJlbmRlcihzY2VuZSwgY2FtZXJhKTsgLy/muLLmn5MKICAgIH0sCiAgICBzZW5kcmVzOiBmdW5jdGlvbiBzZW5kcmVzKCkgewogICAgICB0aGlzLiRidXMuJG9uKCdzZW5kcmVzJywgZnVuY3Rpb24gKHJlcykgewogICAgICAgIHZhciBsb2FkZXIgPSBuZXcgVEhSRUUuT2JqZWN0TG9hZGVyKCk7CiAgICAgICAgbG9hZGVyLnBhcnNlKHJlcywgZnVuY3Rpb24gKG9iaikgewogICAgICAgICAgc2NlbmUgPSBvYmo7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIHJlcXVlc3RzYXZlOiBmdW5jdGlvbiByZXF1ZXN0c2F2ZSgpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CgogICAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICAgIHRoaXMuJGJ1cy4kb24oJ3JlcXVlc3RzYXZlJywgZnVuY3Rpb24gKCkgewogICAgICAgIC8vIGlmKHNjZW5lLmNoaWxkcmVuLmxlbmd0aD4wKXsKICAgICAgICAvLyAgIGxldCBvYmo7CiAgICAgICAgLy8gICAvL+WIoOmZpOaJgOaciWhlbHBlcu+8jOWPquS/neeVmeWFiea6kOOAgeadkOi0qAogICAgICAgIC8vICAgZm9yKHZhciBpPXNjZW5lLmNoaWxkcmVuLmxlbmd0aC0xO2k+PTA7aS0tKXsKICAgICAgICAvLwogICAgICAgIC8vICAgICBvYmo9c2NlbmUuY2hpbGRyZW5baV07CiAgICAgICAgLy8gICAgIGlmKG9iai50eXBlLmluZGV4T2YoJ0hlbHBlcicpIT0tMXx8b2JqLnR5cGUuaW5kZXhPZignQ29udHJvbCcpIT0tMSl7CiAgICAgICAgLy8gICAgICAgc2NlbmUucmVtb3ZlKG9iaik7CiAgICAgICAgLy8gICAgIH0KICAgICAgICAvLyAgIH0KICAgICAgICAvLyB9CiAgICAgICAgdGhhdC5SZW1vdmVIZWxwZXJBbmRDb250cm9sKCk7CiAgICAgICAgdmFyIEpTT05TdHIgPSBKU09OLnN0cmluZ2lmeShzY2VuZS50b0pTT04oKSk7CiAgICAgICAgdmFyIGZpbGUgPSBuZXcgRmlsZShbSlNPTlN0cl0sICdzY2VuZS5qc29uJywgewogICAgICAgICAgdHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICAgbGFzdE1vZGlmaWVkOiBEYXRlLm5vdygpCiAgICAgICAgfSk7IC8v57uE5ZCI5oiQ5paH5Lu2CgogICAgICAgIHZhciBwYXJhbSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAgIHBhcmFtLmFwcGVuZCgnZmlsZScsIGZpbGUpOwogICAgICAgIHZhciBjb25maWcgPSB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBfdGhpczcucmVxdWVzdC5wb3N0KCJodHRwOi8vbG9jYWxob3N0OjkwOTAvdXBsb2FkIiwgcGFyYW0sIGNvbmZpZykudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgICAgdGhhdC4kYnVzLiRlbWl0KCdyZXNwb25zZXNhdmUnLCByZXMuZmlsZWlkKTsKICAgICAgICAgIGNvbnNvbGUubG9nKHJlcy5maWxlaWQpOwogICAgICAgICAgY29uc29sZS5sb2coc2NlbmUpOwogICAgICAgICAgdGhhdC5BZGRIZWxwZXJBbmRDb250cm9sKCk7CiAgICAgICAgfSk7IC8v5o+Q5Lqk6KGo5Y2V5paH5Lu26L+U5ZueaWQKCiAgICAgIH0pOwogICAgfSwKICAgIHNlbmRpZDogZnVuY3Rpb24gc2VuZGlkKCkgewogICAgICB2YXIgaWQgPSBudWxsOwogICAgICB0aGlzLiRidXMuJGVtaXQoJ3NlbmRmaWxlaWQnLCBpZCk7CiAgICB9LAogICAgc3RhcnRlZGl0OiBmdW5jdGlvbiBzdGFydGVkaXQoKSB7CiAgICAgIHZhciB0aGF0ID0gdGhpczsKICAgICAgdGhpcy4kYnVzLiRvbignZWlkdGZpbGUnLCBmdW5jdGlvbiAocmVzLCBpZCkgewogICAgICAgIC8vb2Jqcz1bXTsKICAgICAgICAvL+WboOS4uuavj+asoei3s+i9rOi3r+eUsemDveS8mumHjeaWsOWIneWni+WMluWFtuS7luW3peWFt++8jOi/memHjOWFiOWIoOmZpAogICAgICAgIC8v5oqKanNvbuaVsOaNruaJk+WMheaIkOaWh+S7tumAmui/h3VybOi/m+ihjOS8oOi+kwogICAgICAgIHZhciBKU09OU3RyID0gSlNPTi5zdHJpbmdpZnkocmVzKTsKICAgICAgICB2YXIgZmlsZSA9IG5ldyBGaWxlKFtKU09OU3RyXSwgJ3NjZW5lLmpzb24nLCB7CiAgICAgICAgICB0eXBlOiAnYXBwbGljYXRpb24vanNvbicsCiAgICAgICAgICBsYXN0TW9kaWZpZWQ6IERhdGUubm93KCkKICAgICAgICB9KTsgLy/nu4TlkIjmiJDmlofku7YKCiAgICAgICAgdmFyIHVybCA9IG51bGw7CgogICAgICAgIGlmICh3aW5kb3cuY3JlYXRlT2JqZWN0VVJMICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgLy8gYmFzaWMKICAgICAgICAgIHVybCA9IHdpbmRvdy5jcmVhdGVPYmplY3RVUkwoZmlsZSk7CiAgICAgICAgfSBlbHNlIGlmICh3aW5kb3cuVVJMICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgLy8gbW96aWxsYShmaXJlZm94KQogICAgICAgICAgdXJsID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSk7CiAgICAgICAgfSBlbHNlIGlmICh3aW5kb3cud2Via2l0VVJMICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgLy8gd2Via2l0IG9yIGNocm9tZQogICAgICAgICAgdXJsID0gd2luZG93LndlYmtpdFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSk7CiAgICAgICAgfSAvL3RoYXQuUmVtb3ZlSGVscGVyQW5kQ29udHJvbCgpOwoKCiAgICAgICAgdmFyIGxvYWRlciA9IG5ldyBUSFJFRS5PYmplY3RMb2FkZXIoKTsKICAgICAgICBsb2FkZXIubG9hZCh1cmwsIGZ1bmN0aW9uIChvYmopIHsKICAgICAgICAgIC8vbGV0IG5ld29ianM9W107CiAgICAgICAgICB0aGF0LlJlbW92ZUhlbHBlckFuZENvbnRyb2woKTsKICAgICAgICAgIHNjZW5lID0gb2JqOwogICAgICAgICAgdGhhdC5BZGRIZWxwZXJBbmRDb250cm9sKCk7IC8vIGlmKG9iai5jaGlsZHJlbi5sZW5ndGg+MCl7CiAgICAgICAgICAvLyAgIGxldCBjaGlsZG9iajsKICAgICAgICAgIC8vICAgZm9yKHZhciBpPW9iai5jaGlsZHJlbi5sZW5ndGgtMTtpPj0wO2ktLSl7CiAgICAgICAgICAvLyAgICAgY2hpbGRvYmo9b2JqLmNoaWxkcmVuW2ldOwogICAgICAgICAgLy8gICAgIGlmKGNoaWxkb2JqLnR5cGUuaW5kZXhPZignT2JqZWN0M0QnKSE9LTF8fGNoaWxkb2JqLnR5cGUuaW5kZXhPZignTWVzaCcpIT0tMSl7CiAgICAgICAgICAvLyAgICAgICBuZXdvYmpzLnB1c2goY2hpbGRvYmopOwogICAgICAgICAgLy8gICAgIH0KICAgICAgICAgIC8vICAgICBpZigoY2hpbGRvYmoudHlwZS5pbmRleE9mKCdMaWdodCcpIT0tMSYmY2hpbGRvYmoudHlwZS5pbmRleE9mKCdIZWxwZXInKT09LTEpKXsKICAgICAgICAgIC8vICAgICAgIG5ld29ianMucHVzaChjaGlsZG9iaik7CiAgICAgICAgICAvLyAgICAgfQogICAgICAgICAgLy8gICB9CiAgICAgICAgICAvLyB9CiAgICAgICAgICAvLyBvYmpzPW5ld29ianM7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhvYmpzKTsKICAgICAgICAgIC8vIGlmKHNjZW5lLmNoaWxkcmVuLmxlbmd0aD4wKXsKICAgICAgICAgIC8vICAgbGV0IGNoaWxkb2JqOwogICAgICAgICAgLy8gICAvL+WIoOmZpOaJgOacieWPr+aTjeS9nOWvueixoQogICAgICAgICAgLy8gICBmb3IodmFyIGk9c2NlbmUuY2hpbGRyZW4ubGVuZ3RoLTE7aT49MDtpLS0pewogICAgICAgICAgLy8gICAgIGNoaWxkb2JqPXNjZW5lLmNoaWxkcmVuW2ldOwogICAgICAgICAgLy8gICAgIGlmKChjaGlsZG9iai50eXBlLmluZGV4T2YoJ0xpZ2h0JykhPS0xJiZjaGlsZG9iai50eXBlLmluZGV4T2YoJ0hlbHBlcicpPT0tMSl8fGNoaWxkb2JqLnR5cGUuaW5kZXhPZignR3JvdXAnKSE9LTF8fGNoaWxkb2JqLnR5cGUuaW5kZXhPZignTWVzaCcpIT0tMSl7CiAgICAgICAgICAvLyAgICAgICBzY2VuZS5yZW1vdmUoY2hpbGRvYmopOwogICAgICAgICAgLy8KICAgICAgICAgIC8vICAgICB9CiAgICAgICAgICAvLwogICAgICAgICAgLy8gICB9IGNvbnNvbGUubG9nKHNjZW5lKTsKICAgICAgICAgIC8vY29uc29sZS5sb2cob2Jqcyk7CiAgICAgICAgICAvLyB9CiAgICAgICAgICAvL+WKoOi9veWujOaIkOWQjui/m+ihjAogICAgICAgICAgLy8gc2NlbmUuYmFja2dyb3VuZD1vYmouYmFja2dyb3VuZDsKICAgICAgICAgIC8vIGlmKG9iai5jaGlsZHJlbi5sZW5ndGg+MCkgewogICAgICAgICAgLy8gICBsZXQgY2hpbGRvYmo7CiAgICAgICAgICAvLyAgIGZvciAodmFyIGkgPSBvYmouY2hpbGRyZW4ubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICAgIC8vICAgICBjaGlsZG9iaiA9IG9iai5jaGlsZHJlbltpXTsKICAgICAgICAgIC8vICAgICBvYmoucmVtb3ZlKGNoaWxkb2JqKTsKICAgICAgICAgIC8vICAgICBjaGlsZG9iai5wYXJlbnQ9c2NlbmU7CiAgICAgICAgICAvLyAgICAgc2NlbmUuYWRkKGNoaWxkb2JqKTsKICAgICAgICAgIC8vICAgICBvYmpzLnB1c2goY2hpbGRvYmopOwogICAgICAgICAgLy8gICB9CiAgICAgICAgICAvLyB9CgogICAgICAgICAgZXZlbnRNYW5hZ2VyLlJlbW92ZUV2ZW50KCk7CiAgICAgICAgICB0aGF0LmluaXRFdmVudE1hbmFnZXIoKTsKICAgICAgICAgIHRoYXQuc2NlbmVDaGFuZ2VkRXZlbnQoKTsgLy9jb25zb2xlLmxvZyhvYmpzKTsKICAgICAgICB9LCAvLyBvblByb2dyZXNzIGNhbGxiYWNrCiAgICAgICAgZnVuY3Rpb24gKHhocikgewogICAgICAgICAgY29uc29sZS5sb2coeGhyLmxvYWRlZCAvIHhoci50b3RhbCAqIDEwMCArICclIGxvYWRlZCcpOwogICAgICAgIH0sIC8vIG9uRXJyb3IgY2FsbGJhY2sKICAgICAgICBmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCdBbiBlcnJvciBoYXBwZW5lZCcgKyBlcnIpOwogICAgICAgIH0pOyAvLyBsb2FkZXIucGFyc2UocmVzLGZ1bmN0aW9uIChvYmopewogICAgICAgIC8vCiAgICAgICAgLy8gIH0KICAgICAgICAvLyAgY29uc29sZS5sb2coc2NlbmUpOwogICAgICAgIC8vY29uc29sZS5sb2coc2NlbmUpOwogICAgICAgIC8vICB0aGF0LkFkZEhlbHBlckFuZENvbnRyb2woKTsKICAgICAgICAvLyAgLy/pnIDopoHliJ3lp4vljJbkuIDkuItvYmpzCiAgICAgICAgLy8gIGlmKHNjZW5lLmNoaWxkcmVuLmxlbmd0aD4wKXsKICAgICAgICAvLyAgICBsZXQgb2JqOwogICAgICAgIC8vICAgIC8v5Yig6Zmk5omA5pyJaGVscGVy77yM5Y+q5L+d55WZ5YWJ5rqQ44CB5p2Q6LSoCiAgICAgICAgLy8gICAgb2Jqcz1bXTsKICAgICAgICAvLyAgICAvL+WIneWni+WMluS4gOS4iwogICAgICAgIC8vICAgIGZvcih2YXIgaT1zY2VuZS5jaGlsZHJlbi5sZW5ndGgtMTtpPj0wO2ktLSl7CiAgICAgICAgLy8KICAgICAgICAvLyAgICAgIG9iaj1zY2VuZS5jaGlsZHJlbltpXTsKICAgICAgICAvLyAgICAgIGlmKG9iai50eXBlLmluZGV4T2YoJ01lc2gnKSE9LTEpewogICAgICAgIC8vICAgICAgICAvL+ivtOaYjuaYr+mcgOimgeaTjeS9nOeahOeJqeS9kwogICAgICAgIC8vICAgICAgICBvYmpzLnB1c2gob2JqKTsKICAgICAgICAvLyAgICAgIH0KICAgICAgICAvLyAgICAgIGlmKG9iai50eXBlLmluZGV4T2YoJ09iamVjdDNEJykhPS0xKXsKICAgICAgICAvLyAgICAgICAgb2Jqcy5wdXNoKG9iaik7CiAgICAgICAgLy8gICAgICB9CiAgICAgICAgLy8gICAgICAvLyBpZihvYmoudHlwZS5pbmRleE9mKCdMaWdodCcpIT0tMSYmb2JqLnR5cGUuaW5kZXhPZignSGVscGVyJyk9PS0xKXsKICAgICAgICAvLyAgICAgIC8vICAgb2Jqcy5wdXNoKG9iaik7CiAgICAgICAgLy8gICAgICAvLyB9CiAgICAgICAgLy8gICAgfQogICAgICAgIC8vICAgIGNvbnNvbGUubG9nKG9ianMpOwogICAgICAgIC8vICB9CiAgICAgICAgLy8gIHRyYW5zaW5nPWZhbHNlOwogICAgICAgIC8vCiAgICAgICAgLy8gLy8gdGhhdC5pbml0RXZlbnRNYW5hZ2VyKCk7CiAgICAgICAgLy8gICAgdGhhdC5zY2VuZUNoYW5nZWRFdmVudCgpOwogICAgICAgIC8vCiAgICAgICAgLy8gfSk7CgogICAgICAgIHRoYXQuJGJ1cy4kZW1pdCgnc2VuZGZpbGVpZCcsIGlkKTsKICAgICAgfSk7CiAgICB9LAogICAgYWRkbmV3OiBmdW5jdGlvbiBhZGRuZXcoKSB7CiAgICAgIHZhciB0aGF0ID0gdGhpczsKICAgICAgdGhpcy4kYnVzLiRvZmYoJ2FkZGZpbGUnKTsKICAgICAgdGhpcy4kYnVzLiRvbignYWRkZmlsZScsIGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgaWQgPSBudWxsOwogICAgICAgIHRoYXQuJGJ1cy4kZW1pdCgnc2VuZGZpbGVpZCcsIGlkKTsgLy/orr7nva7kuKrml7bpl7TpmLLmraIg5Yqg6L296Zeu6aKYCgogICAgICAgIHRoYXQuUmVtb3ZlSGVscGVyQW5kQ29udHJvbCgpOwogICAgICAgIHRoYXQuaW5pdFNjZW5lKCk7CiAgICAgICAgdGhhdC5pbml0TGlnaHQoKTsKICAgICAgICB0aGF0LmluaXRNZXNoKCk7CiAgICAgICAgdGhhdC5BZGRIZWxwZXJBbmRDb250cm9sKCk7CiAgICAgICAgZXZlbnRNYW5hZ2VyLlJlbW92ZUV2ZW50KCk7CiAgICAgICAgdGhhdC5pbml0RXZlbnRNYW5hZ2VyKCk7CiAgICAgICAgdGhhdC5zY2VuZUNoYW5nZWRFdmVudCgpOwogICAgICB9KTsKICAgIH0KICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB0aGlzLmluaXQoKTsKICAgIHRoaXMuQ2hlY2tGcm9tVHJlZSgpOwogICAgdGhpcy5maW5kY3VycmVudE9iaigpOwogICAgdGhpcy5BZGRNb2RlbCgpOwogICAgdGhpcy5SZXNldEFsbCgpOwogICAgdGhpcy5FeHBvcnQoKTsKICAgIHRoaXMuc2VuZHJlcygpOwogICAgdGhpcy5yZXF1ZXN0c2F2ZSgpOwogICAgdGhpcy5zdGFydGVkaXQoKTsKICAgIHRoaXMuYWRkbmV3KCk7CiAgfQp9Ow=="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kD,CACA;;AACA,mE,CACA;;AACA;AACAA,cADA;AAEAC,cAFA;AAGAC;AAHA;AAKA;AACA;AACA;AACA;AACA,O,CACA;AACA;;AACA;AACA;AACA;;AAEA;;AACA;AACA;AACA;AACA;AACAC,gBADA;AAEAC;AACAC,kBADA;AAEAC,wBAFA;AAGAC;AAHA,GAFA;AAOAC,MAPA,kBAOA;AACA;AACAC;AACAC,wBADA;AAEAC,wBAFA;AAGAC,yBAHA;AAIAC,0BAJA;AAKAC,wBALA;AAMAC;AANA,OADA;AASAC;AATA;AAWA,GAnBA;AAoBAC;AACA;AACA;AACAC,gBAFA;AAGAC,aAHA,mBAGAC,QAHA,EAGA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA;AATA,KADA;AAYA;AACA;AACAF,gBAFA;AAGAC,aAHA,mBAGAC,QAHA,EAGA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA;AATA,KAZA;AAuBA;AACA;AACAF,gBAFA;AAGAC,aAHA,mBAGAC,QAHA,EAGA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA;AATA,KAvBA;AAkCA;AACA;AACAF,gBAFA;AAGAC,aAHA,mBAGAC,QAHA,EAGA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA;AATA;AAlCA,GApBA;AAkEAC;AACAC,aADA,uBACA;AACA;AACAZ,wBADA;AAEAC,wBAFA;AAGAC,yBAHA;AAIAC,0BAJA;AAKAC,wBALA;AAMAC;AANA;AAQA,KAVA;AAWAQ,YAXA,sBAWA;AAAA;;AACA,mCADA,CAEA;;AACA;AACA;AACA;AACA,SAFA,MAGA;AACA;AACA;AACA,OAPA;AAQA,KAtBA;AAuBAC,kBAvBA,4BAuBA;AACA,sBADA,CAEA;;AACA;AACA;AACAC;AACA,OAHA;AAKA,KA/BA;AAgCAC,iBAhCA,2BAgCA;AAAA;;AACA;AACA;AACA;AACA;AACAC;AACAC;AACA,WAJA,MAKA;AACA;AACA;AACA;AAEAD;AACAC,6CALA,CAMA;;AACAA;AACA;AACA;AACA;;AACA;;AAEA;AAEAA;AACAD;AAGA,mBAVA,MAWA;AACAA;AACAC;AAGA;;AACA;AACA;AACA,eArBA;AAuBA,aA9BA,MA+BA;AACA;AACAA;AACA;AACA;AACA;AACA;AAEAA;AACAD;AAGA,mBAPA,MAQA;AACAA;AACAC;AAGA;;AACA;AACA;AACA,eAnBA;AAoBA;AACA;AACA;AACA,OAhEA;AAiEA,KAlGA;AAmGAC,cAnGA,wBAmGA;AACAD,+BADA,CAEA;AACA,KAtGA;AAuGAE,WAvGA,qBAuGA;AACAF;AACA,KAzGA;AA0GAG,cA1GA,wBA0GA;AACAH;AACA,KA5GA;AA6GAI,WA7GA,qBA6GA;AACAJ;AACA,KA/GA;AAgHAK,eAhHA,yBAgHA;AACAL;AACA,KAlHA;AAmHAM,YAnHA,sBAmHA;AACAN;AACA,KArHA;AAsHAO,iBAtHA,2BAsHA;AACAR;AACAC;AACA;AACA;AACA,KA3HA;AA4HAQ,cA5HA,wBA4HA;AACAR;AAEA,KA/HA;AAgIAS,uBAhIA,iCAgIA;AACA;AACA;AACA;AACA;AACA,KArIA;AAsIAC,0BAtIA,oCAsIA;AACA;AACA;AACA;AACA;AACA,KA3IA;AA4IAC,cA5IA,wBA4IA;AACA;AACAC;;AACAA;;AACAA;AACAZ;AACAa;;AACAA;;AACAA;AACAb,4BATA,CAUA;;AACAc,0EAXA,CAYA;;AACAA;AACAA;AACAd;AAKA,KAhKA;AAiKAe,qBAjKA,+BAiKA;AACAC;AACAA;AACAA;AACAC,kBADA;AAEAC,2BAFA;AAGAC,2BAHA,CAIA;AACA;AACA;AACA;;AAPA;AASA,KA7KA;AA8KAC,cA9KA,sBA8KAC,GA9KA,EA8KA;AACA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACAA;AACAC;AACA;;AACA;AACA;AACA;AACA,KA1LA;AA4LAC,oBA5LA,8BA4LA;AAAA;;AACAC;AACAA;AACA;AACA;AACA;;AAEA;AACA;AAEA;AACA,WAJA,MAKA;AACA;AACA;AAEAC,4DAJA,CAKA;AACA,WAdA,CAgBA;;;AACA;AACAC,oDADA,CAEA;;AAEAD;AACA;AACA,SAvBA,MAuBA;AACA;AACA;AACAA,4DADA,CAGA;AACA;;AACAA;AACA;AACA,OAlCA,EAFA,CAqCA;;AACAD;AAEA;AACAG;AACAL;AACA;AACA;;AACA;AACA;AACAA;;AACA;AACA;AACAvB;AACAC;AACA,WAJA,MAKA;AACA;AACA,8CACA;AACA;AACA;AACAA,0CAHA,CAKA;;AACAD;AACA,aAVA,CAYA;AACA;;;AACA;AACA;AAEA,SAzBA,MAyBA;AACA;AACAA;AACAC;AACA;;AACA;AACA;AACA,OAvCA;AAwCA,KA1QA;AA2QA;AAEA4B,aA7QA,uBA6QA;AACAC,8DADA,CACA;;AACAA,gDAFA,CAEA;;AACAA;AACA7B,kCAJA,CAIA;;AACA8B;AACAC;AACAA,gCAPA,CAQA;;AACA/B;AACA8B;AACA,KAxRA;AAyRA;AACA;AAEA;AACA;AACAE,aA9RA,uBA8RA;AACAP;AACA,KAhSA;AAiSAQ,eAjSA,yBAiSA;AACA;AACAlC;AACAA,iDAHA,CAIA;;AACAA;AACA;AACA4B;AACAL;AACA,OAJA,EALA,CAUA;;AACAY;AACA;AACA;AACAnC;AACA;AACA;;AACA;AACA;AACAA;AACA;AACA;;AACA;AACA;AACAA;AACA;AACA;AAEA,OAjBA;AAkBA,KA9TA;AA+TAoC,eA/TA,uBA+TAC,IA/TA,EA+TA;AAEApC,6DACAqC,gDADA,EAEAA,iDAFA,EAGAA,8CAHA,EAIAA,gDAJA,EAKAA,iDALA,EAMAA,gDANA;AASA,KA1UA;AA2UAC,cA3UA,sBA2UAF,IA3UA,EA2UA;AACA;AACA;AACA,OAFA,MAGA;AACA;AACA,OAFA,MAEA;AACA;AACA,OAFA,MAEA;AACA;AACA,OAFA,MAEA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA,OAHA,MAGA;AACA;AACA;AACA;AACA,KA9VA;AA+VAG,WA/VA,qBA+VA;AACA;AACAC;AACA;AACAC;AACAA;AACAzC;AACA8B;AACA;AACA,KAxWA;AAyWAY,YAzWA,sBAyWA;AACA;AACAF;AACA;AACAG;AACAA;AACA3C;AACA8B;AACA,+BARA,CASA;AAGA,KArXA;AAsXAc,gBAtXA,0BAsXA;AACA;AACAJ;AACA;AACAK;AACAA;AACA7C;AACA8B;AACA,+BARA,CASA;AAEA,KAjYA;AAkYAgB,cAlYA,wBAkYA;AACA;AACAN;AACA;AACAO;AACAA;AACA/C;AACA8B;AACA;AAIA,KA9YA;AA+YAkB,aA/YA,uBA+YA;AACA;AACAR;AACA;AACAS;AACAA;AACAjD;AACA8B;AACA,+BARA,CASA;AAGA,KA3ZA;AA4ZAoB,QA5ZA,kBA4ZA;AACA;AACA;AACA;AACA;AACA,sBALA,CAMA;;AACA;AACA;AACA;AACA;AACA,yBAXA,CAYA;;AACA;AACA;AACA,uBAfA,CAiBA;;AACA;AACA,qBAnBA,CAoBA;AAEA,KAlbA;AAmbAC,eAnbA,yBAmbA;AACA;AACA;AACA,KAtbA;AAubAC,qBAvbA,+BAubA;AACA;AACA;AACA;AACA,KA3bA;AA4bA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACAC,aAjhBA,uBAihBA;AACAC;AACAA,mDAFA,CAEA;;AACAA,0CAHA,CAGA;;AACAA;AACApB;AAEA,KAxhBA;AAyhBAqB,kBAzhBA,4BAyhBA;AACAC;AACA,KA3hBA;AA4hBA;AACAC,gBA7hBA,0BA6hBA;AAGAC;AAAAC;AAAA,SAHA,CAGA;AACA;;AACAD,0EALA,CAKA;;AACAxB,wEANA,CAMA;AACA,KApiBA;AAqiBA;AACA0B,aAtiBA,uBAsiBA;AAEA5D,gCAFA,CAEA;;AACA8B;AACA9B,6DACAqC,0CADA,EAEAA,2CAFA,EAGAA,wCAHA,EAIAA,0CAJA,EAKAA,2CALA,EAMAA,0CANA,GAJA,CAYA;AACA,KAnjBA;AAojBA;AACAwB,cArjBA,wBAqjBA;AACAC,iGADA,CAEA;;AACAA;AACA,KAzjBA;AA0jBA;AACAC,YA3jBA,sBA2jBA;AACA;AACA;AACA;AAEA;AACA;AAEA;AAGA;AACA;AACA;AACA;AAEA,KA3kBA;AA6kBAC,YA7kBA,sBA6kBA;AACA;AACA,KA/kBA;AAilBAC,aAjlBA,qBAilBAC,MAjlBA,EAilBAC,SAjlBA,EAilBA;AACA;AACA;AACA;;AACA;AACA;AACA;;AACA;AACAC;AADA,WAHA,CAKA;;;AACA;;AACA;;AAEAZ;AACAa;AACAA,8BACAC,iCADA,EAEAA,iCAFA,EAGA,CAHA;AAKAD;AACAE;AACA;;AACAA;AACAA;AACAvE;AACA8B;AACA,KA5mBA;;AA6mBA;AACA;AACA;AACA;AACA;AACA;AACA0C,YAnnBA,sBAmnBA;AACA;AACA,KArnBA;AAsnBAC,oBAtnBA,4BAsnBAC,QAtnBA,EAsnBA;AACA;AACAA,8CAFA,CAGA;;AACAA;AACAC;AACA,OAFA;AAGA;AACA,KA9nBA;AA+nBAC,cA/nBA,sBA+nBAV,MA/nBA,EA+nBAC,SA/nBA,EA+nBA;AAAA;;AACA;AACA,wBACAD,MADA,EAEA,oCAFA,EAGA,uBAHA;AAKA,OANA,EADA,CAQA;;AACA;AACAE;AADA;AAGA;AACA,8BACA,wCACA,UADA,EAEA,yBACAS,2BADA,EAEAA,2BAFA,EAFA,CADA,EAQAC,YARA;AAUA,OAXA;AAYA,mCACA,wCACA,UADA,EAEA;AAAA;AAAA,SAFA,CADA,EAKAA,YALA;AAQA,kCACA,wCACA,UADA,EAEA;AAAA;AAAA,SAFA,CADA,EAKAA,YALA;AAQA;AACAC;AACAA;AACAC;AAAA;AAAA;AACAD;AACAA;AACA/E;AACA8B;AACA,KA/qBA;AAmrBAmD,UAnrBA,oBAmrBA;AACA3B;AACA,KArrBA;AAsrBA4B,SAtrBA,mBAsrBA,CAEA,CAxrBA;AAyrBAC,YAzrBA,sBAyrBA;AAAA;;AACA;AACA;AACA,OAFA;AAGA,KA7rBA;AA8rBAC,UA9rBA,oBA8rBA;AAAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAvF,sCAZA,CAcA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AACAA;AACA,OA1BA;AA2BA,KA3tBA;AA4tBAwF,YA5tBA,oBA4tBAC,QA5tBA,EA4tBAC,IA5tBA,EA4tBA;AACA;AACAC,kEACAC,wBADA;AAEAD;;AACA;AACA;AACAE,mDACAC,MADA,EACA,CADA,EACA,CADA,EACA,CADA,EACA,CADA,EACA,CADA,EACA,KADA,EACA,KADA,EACA,KADA,EACA,KADA,EACA,CADA,EACA,IADA;AAEAH;AACA,OALA,MAKA;AACAA;AACA;AAEA,KA1uBA;AA2uBA;AACAI,WA5uBA,qBA4uBA;AACAC,+CADA,CACA;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACAnC,qCAVA,CAUA;AACA,KAvvBA;AAwvBAoC,WAxvBA,qBAwvBA;AACA;AACA;AACAC;AACA/F;AAEA,SAHA;AAIA,OANA;AAOA,KAhwBA;AAiwBAgG,eAjwBA,yBAiwBA;AAAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAnG;AACA;AACA;AACAuC,kCADA;AAEA6D;AAFA,WAdA,CAkBA;;AACA;AACAC;AACA;AAAAC;AAAA;AAAA;AAAA;;AACA,4DACAD,KADA,EACAE,MADA,EACAC,IADA,CACA;AACA;AACAxG;AACAyB;AACAA;AACAzB;AACA,SAPA,EAtBA,CA8BA;;AAGA,OAjCA;AAkCA,KAryBA;AAsyBAyG,UAtyBA,oBAsyBA;AACA;AACA;AACA,KAzyBA;AA0yBAC,aA1yBA,uBA0yBA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACAnE,kCADA;AAEA6D;AAFA,WALA,CASA;;AACA;;AACA;AAAA;AACAO;AACA,SAFA,MAEA;AAAA;AACAA;AACA,SAFA,MAEA;AAAA;AACAA;AACA,SAjBA,CAoBA;;;AACA;AACAT,yBACA;AACA;AACAlG;AACAG;AACAH,qCAJA,CAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA2B;AACA3B;AACAA,mCAhDA,CAiDA;AACA,SAnDA,EAoDA;AACA;AACAyB;AACA,SAvDA,EAyDA;AACA;AACAA;AACA,SA5DA,EAtBA,CAmFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAzB;AAEA,OAvHA;AAwHA,KAr6BA;AAs6BA4G,UAt6BA,oBAs6BA;AACA;AACA;AACA;AACA;AACA5G,0CAFA,CAGA;;AAEAA;AACAA;AACAA;AACAA;AACAA;AACA2B;AACA3B;AACAA;AACA,OAbA;AAcA;AAv7BA,GAlEA;AA4/BA6G,SA5/BA,qBA4/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvgCA","names":["positionX","positionY","positionZ","name","components","Widget","Attribute","Footer","data","state","GridHelper","AxesHelper","LightHelper","PlaneHelper","BoxHelper","Control","configuration","watch","deep","handler","newValue","methods","initstate","AddModel","findcurrentObj","that","CheckFromTree","transformControl","scene","RemoveGrid","AddGrid","RemoveAxes","AddAxes","RemoveLight","AddLight","RemoveControl","AddControl","AddHelperAndControl","RemoveHelperAndControl","initHelper","axesHelper","gridHelper","directLightHelper","initCameraControl","cameraControls","LEFT","MIDDLE","RIGHT","getParents","obj","console","initEventManager","eventManager","cacheobjects","object","transing","initLight","directionalLight","objs","ambientLight","initCache","initControl","document","LoadElement","type","require","AddElement","initBox","material","box","initCone","cone","initCylinder","cylinder","initSphere","sphere","initTorus","torus","init","watchHelper","sceneChangedEvent","initStats","stats","updatePosition","mesh","initRenderer","renderer","antialias","initScene","initCamera","camera","initMesh","initBars","audioBars","radius","countData","color","minGroup","Math","barGroup","initLine","renderGeometries","vertices","res","audioLines","barNodes","lineMaterial","linesGroup","barLine","update","Reset","ResetAll","Export","download","filename","text","pom","encodeURIComponent","event","window","animate","id","sendres","loader","requestsave","lastModified","param","headers","config","then","sendid","startedit","url","addnew","mounted"],"sourceRoot":"src/views/Editor","sources":["Edit.vue"],"sourcesContent":["<template>\n  <div class=\"app-container\">\n    <div>\n        <el-container>\n           <!-- <el-header>Header</el-header> -->\n           <el-container>\n                <el-aside width=\"260px\">\n                       <Widget/>\n                </el-aside>\n\n                <el-main >\n                    <el-scrollbar class=\"Scrollbar\">\n                        <div id=\"webgl\" style=\"position:relative\">\n                        </div>\n                    </el-scrollbar>\n                </el-main>\n                <el-aside width=\"260px\">\n                    <Attribute/>\n                </el-aside>\n            </el-container>\n            <el-footer>\n                <Footer/>\n            </el-footer>\n        </el-container>\n      <!-- <el-row :gutter=\"20\">\n        <el-col :span=\"3\" :xs=\"24\">\n          <el-card style=\"margin-bottom:20px;height: 500px;\">\n\n          </el-card>\n        </el-col>\n        <el-col :span=\"16\" :xs=\"24\">\n            <div id=\"webgl\" style=\"position:relative\">\n\n            </div>\n        </el-col>\n        <el-col :span=\"3\" :xs=\"24\">\n          <el-card style=\"margin-bottom:20px;height: 500px;\">\n\n          </el-card>\n        </el-col>\n      </el-row> -->\n    </div>\n\n\n  </div>\n</template>\n\n<script>\nimport * as THREE from 'three/build/three.module.js'\nimport Stats from '../../store/Stats/stats.min.js'\nimport Widget from '../Editor/Widget/Widget.vue'\nimport Attribute from '../Editor/Attribute/index.vue'\nimport Footer from '../Editor/Footer/index.vue'\nimport {TransformControls} from 'three/examples/jsm/controls/TransformControls'\nimport {DragControls} from 'three/examples/jsm/controls/DragControls'\nimport {TrackballControls} from 'three/examples/jsm/controls/TrackballControls'\nimport {OrbitControls} from 'three/examples/jsm/controls/OrbitControls'\nimport { Color, Group, Object3D} from '../../lib/three.module.js'\nimport {MOUSE} from 'three/src/constants'\nimport {AxesHelper} from 'three/src/helpers/AxesHelper'\nimport {GridHelper} from 'three/src/helpers/GridHelper.js'\nimport {EventManager} from '../../lib/EventManager'\nimport {DirectionalLightHelper} from 'three/src/helpers/DirectionalLightHelper'\nimport { range } from \"../../components/mode/range\";\nimport { node } from \"../../components/mode/node\";\n//初始数据\nlet renderer,camera,scene,geometry,material,mesh,stats,objs;\n//  let container=document.getElementById('webgl');\n   var controls={\n            positionX:0,\n            positionY:0,\n            positionZ:0\n        }\nlet cameraControls;\nlet transformControl;\nlet eventManager;\nlet directionalLight,ambientLight;\nlet id;\n// let mouse;\n// let raycaster;\n/*这里记录一个小bug\n当拖拽物体略过其他物体上时会造成物体全黑\n应该是材质问题使用了法线变换颜色材质，换成正常颜色应该是没有问题\n\n*/\nlet transing=false;\nlet axesHelper,gridHelper,directLightHelper;\nlet cacheobjects;\nexport default {\n    name:'Editor',\n    components:{\n        Widget,\n        Attribute,\n        Footer\n    },\n    data() {\n        return {\n             state:{\n                GridHelper:true,\n                AxesHelper:true,\n                LightHelper:true,\n                PlaneHelper:false,\n                BoxHelper:false,\n                Control:true\n            },\n            configuration:{},\n        }\n    },\n    watch:{\n        'state.GridHelper':{\n            // immediate:true,\n            deep:true,\n            handler(newValue){\n                if(newValue){\n                    this.AddGrid();\n                }else{\n                    this.RemoveGrid();\n                }\n            }\n        },\n         'state.AxesHelper':{\n            // immediate:true,\n            deep:true,\n            handler(newValue){\n                if(newValue){\n                    this.AddAxes();\n                }else{\n                    this.RemoveAxes();\n                }\n            }\n        },\n        'state.LightHelper':{\n            // immediate:true,\n            deep:true,\n            handler(newValue){\n                if(newValue){\n                    this.AddLight();\n                }else{\n                    this.RemoveLight();\n                }\n            }\n        },\n        'state.Control':{\n            // immediate:true,\n            deep:true,\n            handler(newValue){\n                if(newValue){\n                    this.AddControl();\n                }else{\n                    this.RemoveControl();\n                }\n            }\n        }\n    },\n    methods: {\n        initstate(){\n            this.state={\n                GridHelper:true,\n                AxesHelper:true,\n                LightHelper:true,\n                PlaneHelper:false,\n                BoxHelper:false,\n                Control:true\n            };\n        },\n        AddModel(){\n          this.$bus.$off('AddObjects');\n          //防止多次触发bus总线\n            this.$bus.$on('AddObjects',(em,item)=>{\n                if(item.name=='基础几何模型'||item.name=='3D音乐模型'){\n              this.AddElement(em.type);\n          }\n          else{\n              this.LoadElement(em.type);\n          }\n            })\n        },\n        findcurrentObj(){\n            let that=this;\n            //重定向this,好利用总线\n            this.$bus.$on('requestObj',(target)=>{\n                let object=scene.getObjectByProperty('uuid',target.uuid);\n                that.$bus.$emit('responseObj',object);\n            });\n\n        },\n        CheckFromTree(){\n            this.$bus.$on('checkEvent',(target)=>{\n                if(this.state.Control==true){\n                if(!target){\n                    //处理对于传过来是空目标的情况，直接移除控件\n                     transformControl.detach();\n                    scene.remove(transformControl);\n                }\n                else {\n                    if(transformControl.object&&target.uuid!=transformControl.object.uuid){\n                    //如果从场景结构树中得到的物体与目前的不同才进行事件处理\n                    //即更换射线拾取\n\n                    transformControl.detach();\n                    scene.remove(transformControl);\n                    //先删除当前控件对象\n                    scene.traverse(function(obj){\n                        if(obj.uuid==target.uuid){\n                            if(obj.type.indexOf('Helper')==-1){\n                                //如果不是helper\n                               /* 能否直接传uuid进来查然后传出去？\n\n                               需要重构\n                               */\n                                scene.add(transformControl);\n                                transformControl.attach(obj);\n\n\n                            }\n                              else{\n                                  transformControl.detach();\n                                 scene.remove(transformControl);\n\n\n                              }\n                             return;\n                    }\n                    });\n\n                }\n                else if(!transformControl.object){\n                    //如果控件本身不存在那么直接加\n                    scene.traverse(function(obj){\n                        if(obj.uuid==target.uuid){\n                            //同样需要判断是否是helper\n                        if(obj.type.indexOf('Helper')==-1){\n                                //如果不是helper\n\n                                scene.add(transformControl);\n                                transformControl.attach(obj);\n\n\n                            }\n                              else{\n                                  transformControl.detach();\n                                 scene.remove(transformControl);\n\n\n                              }\n                        return;\n                    }\n                    });\n                }\n                }\n                }\n            });\n        },\n        RemoveGrid(){\n            scene.remove(gridHelper);\n            //console.log(scene);\n        },\n        AddGrid(){\n            scene.add(gridHelper);\n        },\n        RemoveAxes(){\n            scene.remove(axesHelper);\n        },\n        AddAxes(){\n            scene.add(axesHelper);\n        },\n        RemoveLight(){\n            scene.remove(directLightHelper);\n        },\n        AddLight(){\n            scene.add(directLightHelper);\n        },\n        RemoveControl(){\n            transformControl.detach();\n            scene.remove(transformControl);\n            let object=null;\n            this.$bus.$emit('getEvent',object);\n        },\n        AddControl(){\n            scene.add(transformControl);\n\n        },\n      AddHelperAndControl(){\n        this.AddAxes();\n        this.AddControl();\n        this.AddGrid();\n        this.AddLight();\n      },\n      RemoveHelperAndControl(){\n        this.RemoveGrid();\n        this.RemoveAxes();\n        this.RemoveLight();\n        this.RemoveControl();\n      },\n        initHelper(){\n            //加坐标轴辅助工具\n            axesHelper=new AxesHelper(500);\n            axesHelper.raycast=()=>{};\n            axesHelper.name=\"坐标轴\";\n            scene.add(axesHelper);\n            gridHelper=new GridHelper(500,40,'rgb(200,200,200)','rgb(100,100,100)');\n            gridHelper.raycast=()=>{};\n            gridHelper.name=\"网格板\";\n            scene.add(gridHelper);\n            //将两个辅助工具raycast射线方法置空使得其禁用变换控件\n            directLightHelper=new DirectionalLightHelper(directionalLight,7);\n            //directLightHelper.raycast=()=>{};\n            directLightHelper.name=\"定向光助手\";\n            directLightHelper.type=\"DirtectionalLightHelper\";\n            scene.add(directLightHelper);\n\n\n\n\n        },\n        initCameraControl(){\n            cameraControls=new OrbitControls(camera,renderer.domElement);\n            cameraControls.enableDamping=true;\n            cameraControls.mouseButtons={\n                LEFT:null,\n                MIDDLE:MOUSE.DOLLY,\n                RIGHT:MOUSE.ROTATE\n                //左键不控制相机\n                //右键控制旋转\n                //中间键控制缩放\n                //ctrl+右键控制相机平移\n            }\n        },\n        getParents(obj){\n          if(obj.parent){\n            if(obj.parent.type==\"Scene\"){\n              return obj;\n            }else{\n              while(obj.parent.type!=\"Scene\"){\n                obj=obj.parent;\n                console.log(obj);\n              }\n              return obj;\n            }\n          }\n        },\n\n        initEventManager(){\n            eventManager=new EventManager(renderer.domElement,scene,camera,objs);\n            eventManager.addEventListener('mousemove',(event)=>{\n                //全局canvas触发拿到物体指针队列\n                if(event.intersection.length){\n                    const object=event.intersection[0].object;\n\n                    if(object==cacheobjects){\n                        //如果当下鼠标还在同一个物体下不触发任何操作\n\n                        return;\n                    }\n                    else if(object!=cacheobjects&&cacheobjects){\n                        //如果当下鼠标从一个物体移动到另一个物体时\n                        //先触发颜色恢复再触发变色\n\n                        cacheobjects.material.color.multiplyScalar(0.5);\n                        //返回原来颜色\n                    }\n\n                    //如果有材质\n                    if(object.material){\n                        object.material.color.multiplyScalar(2);\n                        //变亮\n\n                        cacheobjects=object;\n                    }\n                }else{\n                    //如果鼠标移动到场景空白处恢复\n                    if(cacheobjects){\n                        cacheobjects.material.color.multiplyScalar(0.5);\n\n                        //返回原来颜色\n                    }\n                    cacheobjects=null;\n                }\n            });\n             // //物体拾取事件处理\n            eventManager.addEventListener('click',(event)=>{\n\n                if(transing){\n                    transing=false;\n                    console.log(transing);\n                    return false;\n                }\n                if(event.intersection.length){\n                    const object=event.intersection[0].object;\n                    console.log(event.intersection);\n                    if(object.type==\"TransformControlsPlane\"){\n                        //如果选取到控制器本身直接跳过\n                        transformControl.detach();\n                        scene.remove(transformControl);\n                    }\n                    else{\n                        //选取到物体\n                          if(this.state.Control==true)\n                          {\n                              //只有当Control属性开启时才启用transformControl\n                              //但不影响显示Tree当前点亮\n                            scene.add(transformControl);\n\n                            //transformControl.attach(object.parent instanceof THREE.Group ? object.parent : object);\n                            transformControl.attach(this.getParents(object));\n                        }\n\n                        //let uuid=object.uuid;\n                        // console.log(uuid);\n                        this.$bus.$emit('getEvent',this.getParents(object));\n                    }\n\n                }else{\n                    //当点击到场景空白处时禁用可控件\n                   transformControl.detach();\n                    scene.remove(transformControl);\n                    let object=null;\n                    this.$bus.$emit('getEvent',object);\n                }\n            });\n        },\n        //射线拾取器\n\n     initLight() {\n        directionalLight = new THREE.DirectionalLight(0xffffff); //添加了一个白色的平行光\n        directionalLight.position.set(20, 50, 50); //设置光的方向\n        directionalLight.name=\"平行光\";\n        scene.add(directionalLight); //添加到场景\n        objs.push(directionalLight);\n        ambientLight=new THREE.AmbientLight(0x222222);\n        ambientLight.name=\"全局光\";\n        //添加一个全局环境光\n        scene.add(ambientLight);\n         objs.push(ambientLight);\n    },\n        // initRaycaster(){\n        //     // raycaster=new THREE.Raycaster();\n\n        // },\n        //对象缓存初始化\n        initCache(){\n            cacheobjects=null;\n        },\n        initControl(){\n  //可视化变换控件对象\n        transformControl = new TransformControls( camera,renderer.domElement );\n        transformControl.type=\"TransformControl\";\n        // scene.add( transformControl );//控件对象添加到场景对象\n        transformControl.addEventListener('mouseDown',(event)=>{\n            //加一个参数控制防止点击事件和拖拽事件冲突\n            transing=true;\n            console.log(transing);\n        });\n        //键盘控制可视化变换控件功能\n        document.addEventListener('keyup',(event)=>{\n            if(event.key=='e'){\n                //E键缩放\n                transformControl.mode=\"scale\";\n                return false;\n            }\n            if(event.key=='r'){\n                //R键旋转\n                transformControl.mode=\"rotate\";\n                return false;\n            }\n            if(event.key=='t'){\n                //T键平移\n                transformControl.mode=\"translate\";\n                return false;\n            }\n\n        });\n        },\n        LoadElement(type){\n\n          scene.background = new THREE.CubeTextureLoader().load([\n          require('@/assets/skybox/'+type+'/Left.png'),\n          require('@/assets/skybox/'+type+'/Right.png'),\n          require('@/assets/skybox/'+type+'/Up.png'),\n          require('@/assets/skybox/'+type+'/Down.png'),\n          require('@/assets/skybox/'+type+'/Front.png'),\n          require('@/assets/skybox/'+type+'/Back.png')\n        ]);\n\n        },\n        AddElement(type){\n            if(type=='lonelyPlanet'){\n                this.initBox();\n            }\n            else if(type=='bezierCurve'){\n                this.initCone();\n            }else if(type=='ethereaTone'){\n                this.initCylinder();\n            }else if(type=='electronicMusic'){\n                this.initSphere();\n            }else if(type=='blastSubwoofer'){\n                this.initTorus();\n            }else if(type=='BarModel'){\n                this.initBars();\n                this.sceneChangedEvent();\n            }else if(type=='LineModel'){\n                this.initLine();\n                this.sceneChangedEvent();\n            }\n        },\n        initBox(){\n            var material=new THREE.MeshStandardMaterial();\n            material.color=new Color(0.8,0.2,0.2);\n            var box=new THREE.Mesh(new THREE.BoxGeometry(5,5,5),material);\n            box.position.set(-50, 20, 0);\n            box.name=\"盒子\";\n            scene.add(box);\n            objs.push(box);\n            this.sceneChangedEvent();\n        },\n       initCone(){\n        var material=new THREE.MeshStandardMaterial();\n        material.color=new Color(0.7,0.6,0.6);\n         var cone=new THREE.Mesh(new THREE.ConeGeometry(5,20,32),material);\n          cone.position.set(20, 20, 0);\n          cone.name=\"圆锥\";\n           scene.add(cone);\n           objs.push(cone);\n          this.sceneChangedEvent();\n           //renderer.render(scene,camera);//渲染\n\n\n       },\n       initCylinder(){\n            var material=new THREE.MeshStandardMaterial();\n            material.color=new Color(0.8,0.7,0.2);\n           var cylinder=new THREE.Mesh(new THREE.CylinderGeometry(5, 5, 20, 32),material);\n           cylinder.position.set(50,20,0);\n           cylinder.name=\"圆柱\";\n           scene.add(cylinder);\n           objs.push(cylinder);\n           this.sceneChangedEvent();\n           //renderer.render(scene,camera);//渲染\n\n       },\n       initSphere(){\n           var material=new THREE.MeshStandardMaterial();\n            material.color=new Color(0.2,0.7,0.2);\n          var  sphere=new THREE.Mesh(new THREE.SphereGeometry(5, 32, 32),material);\n           sphere.position.set(-20, -20, 0);\n           sphere.name=\"球\";\n            scene.add(sphere);\n            objs.push(sphere);\n            this.sceneChangedEvent();\n\n\n\n       },\n       initTorus(){\n           var material=new THREE.MeshStandardMaterial();\n            material.color=new Color(0.3,0.1,0.9);\n           var torus =new THREE.Mesh(new THREE.TorusGeometry(10, 3, 16, 100),material);\n            torus.position.set(50, -20, 0);\n            torus.name=\"圆环\";\n            scene.add(torus);\n            objs.push(torus);\n            this.sceneChangedEvent();\n            //renderer.render(scene,camera);//渲染\n\n\n       },\n        init(){\n            this.initRenderer();\n            this.initScene();\n            this.initCamera();\n            this.initLight();\n            this.initMesh();\n            // this.initRaycaster();\n            this.initCache();\n            this.initCameraControl();\n            this.initControl();\n            this.initHelper();\n            this.watchHelper();\n            // this.initMouseEvent();\n            this.initEventManager();\n            this.sendid();\n            this.initStats();\n\n            // initDatGUI();\n            this.sceneChangedEvent();\n            this.animate();\n           // console.log(scene);\n\n        },\n        watchHelper(){\n            let state=this.state;\n             this.$bus.$emit('stateControl',state);\n        },\n        sceneChangedEvent(){\n            //requestAnimationFrame(this.sceneChangedEvent());\n            let scenelist=scene.children;\n            this.$bus.$emit('sceneChanged',scenelist);\n        },\n        //鼠标事务处理（包括点击事件、移动事件）\n        // initMouseEvent(){\n            //给canvas对象进行鼠标坐标转换\n            // mouse=new Vector2();\n            // let domX=0;\n            // let domY=0;\n            // let width=0;\n            // let height=0;\n            // renderer.domElement.addEventListener('mousemove',(event)=>{\n            //     //console.log(event.offsetX,event.offsetY);\n            //     domX=event.offsetX;\n            //     domY=event.offsetY;\n            //     width=renderer.domElement.offsetWidth;\n            //     height=renderer.domElement.offsetHeight;\n            //     mouse.x=domX/width*2-1;\n            //     mouse.y=-domY*2/height+1;\n            //     // console.log(mouse.x,mouse.y);\n            //     raycaster.setFromCamera(mouse,camera);\n            //     //防止控制器被选中\n            //     scene.remove(transformControl);\n            //     const intersection=raycaster.intersectObjects(scene.children,false);\n            //     //把所有有children的屏蔽掉，可以防止对helper进行控制\n            //     scene.add(transformControl);\n            //     if(intersection.length){\n            //         //如果拾取到材质物体\n            //         const object=intersection[0].object;\n            //         //如果当下物体不是上次缓存物体，说明是从不同物体上移到当前物体上触发mouseenter事件\n            //         if(object!=cacheobjects){\n            //             if(cacheobjects){\n            //                 //当鼠标从一个物体移动到另一个物体时，先触发之前缓存物体的mouseleave方法\n            //                 //再触发当前物体的mouseenter方法\n            //                 cacheobjects.dispatchEvent({\n            //             type:'mouseleave'\n            //         });\n            //             }\n            //               object.dispatchEvent({\n            //             type:'mouseenter'\n            //         });\n            //         }//如果相等触发mousemove方法得到物体坐标(鼠标一直在物体上移动)\n            //         else if(object==cacheobjects){\n            //             object.dispatchEvent({\n            //             type:'mousemove'\n            //         });\n            //         }\n            //         cacheobjects=object;\n            //     }else{\n            //         //当鼠标从一个物体移动到射线拾取器拾取不到物体时也会触发之前的物体的mouseleave方法\n            //          if(cacheobjects){\n            //                 //当鼠标从一个物体移动到另一个物体时，先触发之前缓存物体的mouseleave方法\n            //                 //再触发当前物体的mouseenter方法\n            //                 cacheobjects.dispatchEvent({\n            //             type:'mouseleave'\n            //         });\n            //     }\n            //         cacheobjects=null;\n\n\n            //     }\n\n\n            // });\n            // // //物体拾取事件处理\n            // renderer.domElement.addEventListener('click',(event)=>{\n            //     if(transing){\n            //         transing=false;\n            //         return false;\n            //     }\n            //     // raycaster.setFromCamera(mouse,camera);\n            //     // //防止控制器被选中\n            //     // scene.remove(transformControl);\n            //     // const intersection=raycaster.intersectObjects(scene.children,false);\n            //     // //把所有有children的屏蔽掉，可以防止对helper进行控制\n            //     // scene.add(transformControl);\n            //     // if(intersection.length){\n\n\n            //     //     const object=intersection[0].object;\n            //     //     transformControl.attach(object);\n            //     // }else{\n            //     //     //当点击到场景空白处时禁用可控件\n            //     //    transformControl.detach();\n            //     // }\n            // });\n\n        // },\n        initStats(){\n            stats = new Stats();\n             stats.domElement.style.position = 'absolute'; //绝对坐标\n                stats.domElement.style.left = '0px';// (0,0)px,左上角\n                stats.domElement.style.top = '0px';\n            document.getElementById('webgl').appendChild(stats.domElement);\n\n        },\n        updatePosition(){\n            mesh.position.set(controls.positionX,controls.positionY,controls.positionZ);\n        },\n        //初始化渲染器\n        initRenderer(){\n\n\n            renderer=new THREE.WebGLRenderer({antialias:true});//实例化渲染器\n            //抗锯齿开启\n            renderer.setSize(window.innerWidth*0.7,window.innerHeight*0.7);//设置宽高\n            document.getElementById('webgl').appendChild(renderer.domElement);//添加到dom\n        },\n        //初始化场景\n        initScene(){\n\n            scene=new THREE.Scene();//实例化场景\n            objs=[];\n             scene.background = new THREE.CubeTextureLoader().load([\n          require('@/assets/skybox/Galaxy/Left.png'),\n          require('@/assets/skybox/Galaxy/Right.png'),\n          require('@/assets/skybox/Galaxy/Up.png'),\n          require('@/assets/skybox/Galaxy/Down.png'),\n          require('@/assets/skybox/Galaxy/Front.png'),\n          require('@/assets/skybox/Galaxy/Back.png')\n        ]);\n            // this.$bus.$emit('sceneChanged',scene);\n        },\n        //初始化相机\n        initCamera(){\n            camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,0.1,200)\n            //实例化相机】\n            camera.position.set(0,0,150);\n        },\n        //创建模型\n        initMesh(){\n            // geometry = new THREE.BoxGeometry(5, 5, 5 ); //创建几何体\n            // var material=new THREE.MeshStandardMaterial();\n            // material.color=new Color(0.7,0.2,0.2); //创建材质\n\n            // mesh = new THREE.Mesh( geometry, material ); //创建网格\n            // mesh.name=\"盒子\";\n\n            // scene.add( mesh ); //将网格添加到场景\n\n\n            // this.initCone();\n            // this.initBox();\n            this.initLine();\n            this.initBars();\n\n        },\n\n        initBars(){\n            this.audioBars(25,128);\n        },\n\n        audioBars(radius, countData) {\n      let barGroup = new THREE.Group();\n      let R = radius;\n      let N = countData;\n      for (let i = 0; i < N; i++) {\n        let minGroup = new THREE.Group();\n        let box = new THREE.BoxGeometry(1, 1, 1);\n        let material = new THREE.MeshPhongMaterial({\n          color: 0x00ffff\n        }); // 材质对象\n        let m = i;\n        let mesh = new THREE.Mesh(box, material);\n\n        mesh.position.y = 0.5;\n        minGroup.add(mesh);\n        minGroup.position.set(\n          Math.sin(((m * Math.PI) / N) * 2) * R,\n          Math.cos(((m * Math.PI) / N) * 2) * R,\n          0\n        );\n       minGroup.rotation.z = ((-m * Math.PI) / N) * 2;\n        barGroup.add(minGroup);\n      }\n      barGroup.name=\"音频谱\";\n      barGroup.type=\"BarGroup\";\n      scene.add(barGroup);\n      objs.push(barGroup);\n    },\n/* 这里有个原理，为什么对音频线和音频组进行移动旋转操作后 依然可以根据初始化的音频数据进行重画\n按原理来说应该要重新计算各个线段的坐标值进行重绘，为什么这里导出数据后依然可以利用初始化的\nbarNodes进行一个线段计算重回吧，原因是因为，在编辑器中对一个组对象进行操作时，其各子对象\n的坐标并不会变化，只改变这个组对象的位置、旋转等信息，其子对象的坐标一直是相对于其父对象的\n坐标即本地坐标，而非世界坐标，只有当父对象是scene场景时，本地坐标才等于世界坐标\n */\n        initLine(){\n            this.audioLines(20,256);\n        },\n        renderGeometries(vertices) {\n            const res = [];\n            vertices = vertices.concat(vertices[0]);\n            //合并数组，把里外位置告知要画的线\n            vertices.forEach(value => {\n            res.push(value.x, value.y, 0);\n      });\n            return new THREE.BufferAttribute(new Float32Array(res), 3);\n    },\n        audioLines(radius, countData) {\n            var barNodes = range(0, countData).map(index => {\n                return new node(\n                radius,\n                ((index / countData) * 360 + 45) % 360,\n                new THREE.Vector2(0, 0)\n                );\n            });\n            //得到一个记录圆上256个点的位置信息的数组\n            const lineMaterial = new THREE.LineBasicMaterial({\n                color: 0x00ffff\n            });\n            var barLine = range(0, countData).map(index => {\n            return new THREE.Line(\n                new THREE.BufferGeometry().setAttribute(\n                    \"position\",\n                this.renderGeometries([\n                    barNodes[index].positionA(),\n                     barNodes[index].positionB()\n            ])\n          ),\n            lineMaterial\n            );\n        });\n        var outLine = new THREE.Line(\n        new THREE.BufferGeometry().setAttribute(\n          \"position\",\n          this.renderGeometries(barNodes.map(node => node.positionA()))\n        ),\n        lineMaterial\n      );\n\n      var inLine = new THREE.Line(\n        new THREE.BufferGeometry().setAttribute(\n          \"position\",\n          this.renderGeometries(barNodes.map(node => node.positionB()))\n        ),\n        lineMaterial\n      );\n\n      var linesGroup = new THREE.Group();\n      linesGroup.add(outLine);\n      linesGroup.add(inLine);\n      barLine.forEach(line => linesGroup.add(line));\n      linesGroup.name=\"音频线\";\n      linesGroup.type=\"LineGroup\";\n      scene.add(linesGroup);\n      objs.push(linesGroup);\n    },\n\n\n\n        update(){\n            stats.update();\n        },\n        Reset(){\n\n        },\n        ResetAll(){\n            this.$bus.$on('reset',()=>{\n                this.Reset();\n            });\n        },\n        Export(){\n            let that=this;\n            this.$bus.$on('export',()=>{\n            // if(scene.children.length>0){\n            //     let obj;\n            //     //删除所有helper，只保留光源、材质\n            //     for(var i=scene.children.length-1;i>=0;i--){\n            //\n            //          obj=scene.children[i];\n            //         if(obj.type.indexOf('Helper')!=-1||obj.type.indexOf('Control')!=-1){\n            //              scene.remove(obj);\n            //         }\n            //     }\n            // }\n              that.RemoveHelperAndControl();\n\n                //因为每次迭代中.children 一旦remove后从头开始执行\n                //数组会改变，因此使用遍历的forEach也好，traverse也好数组的\n                //索引全都改变，只会删除一个对象\n                //但如果从后开始遍历删除，每次remove后前面的索引也即是未遍历过的节点索引不会变\n                //使用state值然后进行深度监听依然不行，因为watch方法每次在mounted之后\n                //这就导致了如果mounted中的data值变化，我需要导出的数据还是原来数据，watch只会在之后\n                //发生作用。\n\n            var JSONStr=JSON.stringify(scene.toJSON());\n\n            this.download(\"scene.json\",JSONStr);\n            that.AddHelperAndControl();\n            });\n        },\n        download(filename,text){\n            var pom=document.createElement('a');\n            pom.setAttribute('href','data:text/plain;charset=utf-8,'\n            +encodeURIComponent(text));\n            pom.setAttribute('download',filename);\n            if(document.createEvent){\n                var event=document.createEvent('MouseEvents');\n                event.initMouseEvent('click',true, false,\n                window,0,0,0,0,0,false,false,false,false,0,null);\n                pom.dispatchEvent(event);\n            }else{\n                pom.click();\n            }\n\n        },\n        //运行动画\n        animate(){\n            id=requestAnimationFrame(this.animate);//循环调用函数\n\n            // mesh.rotation.x+=0.01;\n            // // //每帧网格模型沿x轴旋转0.01弧度\n            // mesh.rotation.y+=0.02;\n            // //每帧网格模型沿y轴旋转0.02弧度\n            // //stats.update();//更新性能检测框\n\n            this.update();\n            renderer.render(scene,camera);//渲染\n        },\n      sendres(){\n          this.$bus.$on('sendres',(res)=>{\n           var loader=new THREE.ObjectLoader();\n           loader.parse(res,function (obj){\n             scene=obj;\n\n           })\n          })\n      },\n      requestsave(){\n          let that=this;\n        this.$bus.$on('requestsave',()=>{\n          // if(scene.children.length>0){\n          //   let obj;\n          //   //删除所有helper，只保留光源、材质\n          //   for(var i=scene.children.length-1;i>=0;i--){\n          //\n          //     obj=scene.children[i];\n          //     if(obj.type.indexOf('Helper')!=-1||obj.type.indexOf('Control')!=-1){\n          //       scene.remove(obj);\n          //     }\n          //   }\n          // }\n          that.RemoveHelperAndControl();\n          var JSONStr=JSON.stringify(scene.toJSON());\n          let file=new File([JSONStr],'scene.json',{\n            type: 'application/json',\n            lastModified: Date.now()\n          });\n          //组合成文件\n          let param=new FormData();\n          param.append('file',file);\n          let config={headers:{'Content-Type':'multipart/form-data'}}\n          this.request.post(\"http://localhost:9090/upload\",\n            param,config).then(res=>{\n            // console.log(res);\n            that.$bus.$emit('responsesave',res.fileid);\n            console.log(res.fileid);\n            console.log(scene);\n            that.AddHelperAndControl();\n          });\n          //提交表单文件返回id\n\n\n        });\n      },\n      sendid(){\n        let id=null;\n        this.$bus.$emit('sendfileid',id);\n      },\n      startedit(){\n\n          let that=this;\n        this.$bus.$on('eidtfile',(res,id)=>{\n          //objs=[];\n          //因为每次跳转路由都会重新初始化其他工具，这里先删除\n          //把json数据打包成文件通过url进行传输\n          var JSONStr=JSON.stringify(res);\n          let file=new File([JSONStr],'scene.json',{\n            type: 'application/json',\n            lastModified: Date.now()\n          });\n          //组合成文件\n          let url = null ;\n          if (window.createObjectURL!=undefined) { // basic\n            url = window.createObjectURL(file) ;\n          } else if (window.URL!=undefined) { // mozilla(firefox)\n            url = window.URL.createObjectURL(file) ;\n          } else if (window.webkitURL!=undefined) { // webkit or chrome\n            url = window.webkitURL.createObjectURL(file) ;\n          }\n\n\n          //that.RemoveHelperAndControl();\n          var loader=new THREE.ObjectLoader();\n          loader.load(url,\n            function(obj){\n             //let newobjs=[];\n            that.RemoveHelperAndControl();\n            scene=obj;\n            that.AddHelperAndControl();\n              // if(obj.children.length>0){\n              //   let childobj;\n              //   for(var i=obj.children.length-1;i>=0;i--){\n              //     childobj=obj.children[i];\n              //     if(childobj.type.indexOf('Object3D')!=-1||childobj.type.indexOf('Mesh')!=-1){\n              //       newobjs.push(childobj);\n              //     }\n              //     if((childobj.type.indexOf('Light')!=-1&&childobj.type.indexOf('Helper')==-1)){\n              //       newobjs.push(childobj);\n              //     }\n              //   }\n              // }\n              // objs=newobjs;\n              // console.log(objs);\n\n\n              // if(scene.children.length>0){\n              //   let childobj;\n              //   //删除所有可操作对象\n              //   for(var i=scene.children.length-1;i>=0;i--){\n              //     childobj=scene.children[i];\n              //     if((childobj.type.indexOf('Light')!=-1&&childobj.type.indexOf('Helper')==-1)||childobj.type.indexOf('Group')!=-1||childobj.type.indexOf('Mesh')!=-1){\n              //       scene.remove(childobj);\n              //\n              //     }\n              //\n              //   } console.log(scene);\n                //console.log(objs);\n              // }\n              //加载完成后进行\n              // scene.background=obj.background;\n              // if(obj.children.length>0) {\n              //   let childobj;\n              //   for (var i = obj.children.length - 1; i >= 0; i--) {\n              //     childobj = obj.children[i];\n              //     obj.remove(childobj);\n              //     childobj.parent=scene;\n              //     scene.add(childobj);\n              //     objs.push(childobj);\n              //   }\n              // }\n              eventManager.RemoveEvent();\n             that.initEventManager();\n              that.sceneChangedEvent();\n              //console.log(objs);\n            },\n            // onProgress callback\n            function ( xhr ) {\n              console.log( (xhr.loaded / xhr.total * 100) + '% loaded' );\n            },\n\n            // onError callback\n            function ( err ) {\n              console.error( 'An error happened'+err );\n            });\n          // loader.parse(res,function (obj){\n          //\n          //  }\n          //  console.log(scene);\n            //console.log(scene);\n           //  that.AddHelperAndControl();\n           //  //需要初始化一下objs\n           //  if(scene.children.length>0){\n           //    let obj;\n           //    //删除所有helper，只保留光源、材质\n           //    objs=[];\n           //    //初始化一下\n           //    for(var i=scene.children.length-1;i>=0;i--){\n           //\n           //      obj=scene.children[i];\n           //      if(obj.type.indexOf('Mesh')!=-1){\n           //        //说明是需要操作的物体\n           //        objs.push(obj);\n           //      }\n           //      if(obj.type.indexOf('Object3D')!=-1){\n           //        objs.push(obj);\n           //      }\n           //      // if(obj.type.indexOf('Light')!=-1&&obj.type.indexOf('Helper')==-1){\n           //      //   objs.push(obj);\n           //      // }\n           //    }\n           //    console.log(objs);\n           //  }\n           //  transing=false;\n           //\n           // // that.initEventManager();\n          //    that.sceneChangedEvent();\n          //\n          // });\n          that.$bus.$emit('sendfileid',id);\n\n        });\n      },\n      addnew(){\n          let that=this;\n          this.$bus.$off('addfile');\n        this.$bus.$on('addfile',()=>{\n          let id=null;\n          that.$bus.$emit('sendfileid',id);\n          //设置个时间防止 加载问题\n\n          that.RemoveHelperAndControl();\n          that.initScene();\n          that.initLight();\n          that.initMesh();\n          that.AddHelperAndControl();\n          eventManager.RemoveEvent();\n          that.initEventManager();\n          that.sceneChangedEvent();\n        });\n      }\n    },\n\n  mounted() {\n        this.init();\n        this.CheckFromTree();\n        this.findcurrentObj();\n        this.AddModel();\n        this.ResetAll();\n        this.Export();\n        this.sendres();\n        this.requestsave();\n        this.startedit();\n        this.addnew();\n    },\n}\n</script>\n<style>\n #webgl {\n    height: 500px;\n  }\n.app-container{\n    background-color: #432d43;\n}\n</style>\n"]}]}